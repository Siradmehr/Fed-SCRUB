model initiated
Using freshly initialized model (no checkpoint loaded)
{'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'SAVING_DIR': './checkpoints/1/nf_resnet18/cifar10/1_17', 'LOADED_MODEL': NFResNet(
  (conv1): ScaledStdConv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)}
server configured
Round 1: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429333)[0m Client 9 / 10
[36m(ClientAppActor pid=429333)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m Client 5 / 10[32m [repeated 9x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd0991fbcb0>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m gpu in client
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14985 MiB, 66065 MiB
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429336)[0m Available devices  1
[36m(ClientAppActor pid=429336)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429336)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=429336)[0m before loading model statdict
[36m(ClientAppActor pid=429336)[0m after loading model statdict
[36m(ClientAppActor pid=429336)[0m training started
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a38bd07d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 22593 MiB, 58457 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=429342)[0m gpu in client
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 31318 MiB, 49732 MiB
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429342)[0m Available devices  1
[36m(ClientAppActor pid=429342)[0m Current cuda device  0
[36m(ClientAppActor pid=429342)[0m [Client 8] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429342)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429342)[0m before loading model statdict
[36m(ClientAppActor pid=429342)[0m after loading model statdict
[36m(ClientAppActor pid=429342)[0m training started
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_1.pth
[36m(ClientAppActor pid=429337)[0m Client 8 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb40d78d40>, len val=500, len test=500
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m gpu in client
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 1 ACC is =  0.1372
round 1 loss is =  6.512519598007202
Current best ACC is =  0.1372
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 2: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a445eb2c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m [Client 5] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd098c14290>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 6] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 2 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_2.pth
[36m(ClientAppActor pid=429337)[0m Client 1 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429337)[0m client loading model
[36m(ClientAppActor pid=429337)[0m loading data
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429336)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m partition loaded
[36m(ClientAppActor pid=429334)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b601076e0>, len val=500, len test=500
[36m(ClientAppActor pid=429334)[0m gpu in client
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 2 ACC is =  0.1426
round 2 loss is =  4.926889181137085
Current best ACC is =  0.1426
Saving round 2 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 3: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709aea7b8ce0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54b05340>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 8] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 3 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_3.pth
[36m(ClientAppActor pid=429335)[0m Client 6 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429342)[0m client loading model
[36m(ClientAppActor pid=429342)[0m loading data
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429342)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328d96510>, len val=500, len test=500
[36m(ClientAppActor pid=429336)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m gpu in client
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 3 ACC is =  0.1634
round 3 loss is =  2.4297942399978636
Current best ACC is =  0.1634
Saving round 3 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 4: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a440e5ee0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m training started
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd144d7c110>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_4.pth
[36m(ClientAppActor pid=429334)[0m Client 1 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429336)[0m client loading model
[36m(ClientAppActor pid=429336)[0m loading data
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429342)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m partition loaded
[36m(ClientAppActor pid=429342)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680447acf80>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429337)[0m Available devices  1
[36m(ClientAppActor pid=429337)[0m Current cuda device  0
[36m(ClientAppActor pid=429337)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429337)[0m before loading model statdict
[36m(ClientAppActor pid=429337)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 4 ACC is =  0.2058
round 4 loss is =  2.3401094913482665
Current best ACC is =  0.2058
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 5: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b601c4ad0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b41f1280>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_5.pth
[36m(ClientAppActor pid=429341)[0m Client 5 / 10
[36m(ClientAppActor pid=429341)[0m client calling
[36m(ClientAppActor pid=429341)[0m client loading model
[36m(ClientAppActor pid=429341)[0m loading data
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429338)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680289773b0>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 5 ACC is =  0.2458
round 5 loss is =  2.1288752794265746
Current best ACC is =  0.2458
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 6: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429338)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fbb2cd4c680>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328e95550>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_6.pth
[36m(ClientAppActor pid=429340)[0m Client 3 / 10
[36m(ClientAppActor pid=429340)[0m client calling
[36m(ClientAppActor pid=429333)[0m client loading model
[36m(ClientAppActor pid=429333)[0m loading data
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=429335)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429334)[0m partition loaded
[36m(ClientAppActor pid=429334)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x768044781fa0>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429342)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 6 ACC is =  0.2618
round 6 loss is =  2.076154112815857
Current best ACC is =  0.2618
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 7: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a4418f5f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7febf332ed50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_7.pth
[36m(ClientAppActor pid=429335)[0m Client 8 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=429334)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m partition loaded
[36m(ClientAppActor pid=429337)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246c0921580>, len val=500, len test=500
[36m(ClientAppActor pid=429337)[0m gpu in client
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429337)[0m before loading model statdict
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 7 ACC is =  0.2694
round 7 loss is =  2.044195055961609
Current best ACC is =  0.2694
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 8: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a441a8d70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a38be0e60>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_8.pth
[36m(ClientAppActor pid=429335)[0m Client 4 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429340)[0m client loading model
[36m(ClientAppActor pid=429340)[0m loading data
[36m(ClientAppActor pid=429340)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429340)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b41f1040>, len val=500, len test=500
[36m(ClientAppActor pid=429337)[0m gpu in client
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=429337)[0m before loading model statdict
[36m(ClientAppActor pid=429337)[0m after loading model statdict
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 8 ACC is =  0.2724
round 8 loss is =  2.022285270690918
Current best ACC is =  0.2724
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 9: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb40c98ce0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 8] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429337)[0m training started
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f7d10e00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_9.pth
[36m(ClientAppActor pid=429342)[0m Client 4 / 10
[36m(ClientAppActor pid=429342)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429338)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m 
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328ee6000>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429339)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 9 ACC is =  0.2932
round 9 loss is =  1.9915030360221864
Current best ACC is =  0.2932
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 10: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a2ff67da0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54ba6390>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 10 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_10.pth
[36m(ClientAppActor pid=429335)[0m Client 7 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429337)[0m client loading model
[36m(ClientAppActor pid=429337)[0m loading data
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=429342)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m partition loaded
[36m(ClientAppActor pid=429337)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b4968410>, len val=500, len test=500
[36m(ClientAppActor pid=429337)[0m gpu in client
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429337)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=429337)[0m before loading model statdict
[36m(ClientAppActor pid=429337)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 10 ACC is =  0.3026
round 10 loss is =  1.974197471141815
Current best ACC is =  0.3026
Saving round 10 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 11: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328ee5760>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m  
[36m(ClientAppActor pid=429338)[0m 2
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b603f5460>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_11.pth
[36m(ClientAppActor pid=429335)[0m Client 5 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429338)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a0168620>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=429339)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 11 ACC is =  0.306
round 11 loss is =  1.9576380372047424
Current best ACC is =  0.306
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 12: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8ee75b050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m training started
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a441a8d70>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_12.pth
[36m(ClientAppActor pid=429342)[0m Client 0 / 10
[36m(ClientAppActor pid=429342)[0m client calling
[36m(ClientAppActor pid=429342)[0m client loading model
[36m(ClientAppActor pid=429342)[0m loading data
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429342)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680442e0da0>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 12 ACC is =  0.315
round 12 loss is =  1.9362675666809082
Current best ACC is =  0.315
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 13: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb401d7440>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 8] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb40191640>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429340)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f7909a90>, len val=500, len test=500
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 1] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 13 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_13.pth
[36m(ClientAppActor pid=429335)[0m Client 2 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429338)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m client loading model
[36m(ClientAppActor pid=429333)[0m loading data
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=429337)[0m partition loaded
[36m(ClientAppActor pid=429337)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b41f0470>, len val=500, len test=500
[36m(ClientAppActor pid=429337)[0m gpu in client
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429337)[0m Available devices  1
[36m(ClientAppActor pid=429337)[0m Current cuda device  0
[36m(ClientAppActor pid=429337)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=429337)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 13 ACC is =  0.3016
round 13 loss is =  1.941974413394928
Round 14: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a02a3500>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 5] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a381dad20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 14 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_14.pth
[36m(ClientAppActor pid=429336)[0m Client 3 / 10
[36m(ClientAppActor pid=429336)[0m client calling
[36m(ClientAppActor pid=429336)[0m client loading model
[36m(ClientAppActor pid=429336)[0m loading data
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=429342)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m partition loaded
[36m(ClientAppActor pid=429337)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b49f6f90>, len val=500, len test=500
[36m(ClientAppActor pid=429337)[0m gpu in client
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429337)[0m Available devices  1
[36m(ClientAppActor pid=429337)[0m Current cuda device  0
[36m(ClientAppActor pid=429337)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=429337)[0m before loading model statdict
[36m(ClientAppActor pid=429337)[0m after loading model statdict
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 14 ACC is =  0.319
round 14 loss is =  1.9094731569290162
Current best ACC is =  0.319
Saving round 14 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 15: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f7816ed0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a445c1550>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 15 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_15.pth
[36m(ClientAppActor pid=429342)[0m Client 0 / 10
[36m(ClientAppActor pid=429342)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=429342)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m partition loaded
[36m(ClientAppActor pid=429337)[0m len partition= 5000
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a026be90>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429337)[0m Available devices  1
[36m(ClientAppActor pid=429337)[0m Current cuda device  0
[36m(ClientAppActor pid=429337)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429337)[0m before loading model statdict
[36m(ClientAppActor pid=429337)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 15 ACC is =  0.3192
round 15 loss is =  1.8898186922073363
Current best ACC is =  0.3192
Saving round 15 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 16: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb401d7020>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=429338)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb40d5a810>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 16 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_16.pth
[36m(ClientAppActor pid=429334)[0m Client 0 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429342)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m partition loaded
[36m(ClientAppActor pid=429337)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b4ab90a0>, len val=500, len test=500
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m gpu in client
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429336)[0m Available devices  1
[36m(ClientAppActor pid=429336)[0m Current cuda device  0
[36m(ClientAppActor pid=429336)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m before loading model statdict
[36m(ClientAppActor pid=429337)[0m after loading model statdict
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 16 ACC is =  0.3434
round 16 loss is =  1.8525341153144836
Current best ACC is =  0.3434
Saving round 16 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 17: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f7815340>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a2ff640e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 2] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 17 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_17.pth
[36m(ClientAppActor pid=429341)[0m Client 5 / 10
[36m(ClientAppActor pid=429341)[0m client calling
[36m(ClientAppActor pid=429342)[0m client loading model
[36m(ClientAppActor pid=429342)[0m loading data
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429342)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x768044399010>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 17 ACC is =  0.353
round 17 loss is =  1.8266924738883972
Current best ACC is =  0.353
Saving round 17 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 18: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de3c4773050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680442e16d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_18.pth
[36m(ClientAppActor pid=429334)[0m Client 1 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429333)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680447127b0>, len val=500, len test=500
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m gpu in client
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429338)[0m Available devices  1
[36m(ClientAppActor pid=429338)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 18 ACC is =  0.362
round 18 loss is =  1.8056200981140136
Current best ACC is =  0.362
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 19: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8ee79bb90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 8] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x724760d7a9f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 2] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 19 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_19.pth
[36m(ClientAppActor pid=429337)[0m Client 2 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=429342)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429341)[0m partition loaded
[36m(ClientAppActor pid=429341)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328e94bf0>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 19 ACC is =  0.3588
round 19 loss is =  1.7908883452415467
Round 20: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54b05700>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b41f5dc0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 20 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_20.pth
[36m(ClientAppActor pid=429337)[0m Client 0 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429338)[0m client loading model
[36m(ClientAppActor pid=429338)[0m loading data
[36m(ClientAppActor pid=429338)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=429342)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76804428bd40>, len val=500, len test=500
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 20 ACC is =  0.3662
round 20 loss is =  1.7728230714797975
Current best ACC is =  0.3662
Saving round 20 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 21: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54ba5bb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 8] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246c00cc1d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 21 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_21.pth
[36m(ClientAppActor pid=429334)[0m Client 0 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429341)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54b04c20>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 21 ACC is =  0.3578
round 21 loss is =  1.771593487262726
Round 22: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429341)[0m Client 4 / 10
[36m(ClientAppActor pid=429341)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 8[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a38be4b30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb401d6ab0>, len val=500, len test=500
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba84d98fe0>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 6] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m training started
[36m(ClientAppActor pid=429338)[0m number of epochs in this 2
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680449a3830>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 22 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_22.pth
[36m(ClientAppActor pid=429337)[0m Client 5 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=429342)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de3289976e0>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 22 ACC is =  0.3728
round 22 loss is =  1.7432457208633423
Current best ACC is =  0.3728
Saving round 22 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 23: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba852f4d10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m [Client 5] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m training started
[36m(ClientAppActor pid=429338)[0m number of epochs in this 2
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a44094860>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 6] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 23 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_23.pth
[36m(ClientAppActor pid=429334)[0m Client 2 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429342)[0m client loading model
[36m(ClientAppActor pid=429342)[0m loading data
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429342)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f79e4230>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429337)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 23 ACC is =  0.3746
round 23 loss is =  1.7229245185852051
Current best ACC is =  0.3746
Saving round 23 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 24: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709ae9d5aa80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m [Client 2] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429336)[0m training started
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a44094b00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 24 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_24.pth
[36m(ClientAppActor pid=429342)[0m Client 1 / 10
[36m(ClientAppActor pid=429342)[0m client calling
[36m(ClientAppActor pid=429342)[0m client loading model
[36m(ClientAppActor pid=429342)[0m loading data
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429342)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680f4309220>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 24 ACC is =  0.3876
round 24 loss is =  1.712329053878784
Current best ACC is =  0.3876
Saving round 24 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 25: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.001
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a01f1970>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b41a13d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 25 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_25.pth
[36m(ClientAppActor pid=429338)[0m Client 1 / 10
[36m(ClientAppActor pid=429338)[0m client calling
[36m(ClientAppActor pid=429338)[0m client loading model
[36m(ClientAppActor pid=429338)[0m loading data
[36m(ClientAppActor pid=429338)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429338)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de32896bf50>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=429339)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 25 ACC is =  0.3904
round 25 loss is =  1.6897348165512085
Current best ACC is =  0.3904
Saving round 25 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 26: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9bf3f800e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m training started
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a0099700>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 26 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_26.pth
[36m(ClientAppActor pid=429335)[0m Client 8 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429333)[0m client loading model
[36m(ClientAppActor pid=429333)[0m loading data
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=429342)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x768044398c50>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 26 ACC is =  0.3954
round 26 loss is =  1.6806065797805787
Current best ACC is =  0.3954
Saving round 26 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 27: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd0981e0350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9bf3f80050>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 27 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_27.pth
[36m(ClientAppActor pid=429335)[0m Client 5 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429334)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x768044398c80>, len val=500, len test=500
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 27 ACC is =  0.3964
round 27 loss is =  1.671611475944519
Current best ACC is =  0.3964
Saving round 27 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 28: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54b05880>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54b057f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 28 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_28.pth
[36m(ClientAppActor pid=429334)[0m Client 9 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=429342)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m partition loaded
[36m(ClientAppActor pid=429334)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680f436c680>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 28 ACC is =  0.4044
round 28 loss is =  1.660741126537323
Current best ACC is =  0.4044
Saving round 28 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 29: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de3c47730b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m training started
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b600d86e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 29 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_29.pth
[36m(ClientAppActor pid=429335)[0m Client 1 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429334)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x768044783e60>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 29 ACC is =  0.401
round 29 loss is =  1.6448841452598573
Round 30: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a4403e3c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9bfa11c680>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 30 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_30.pth
[36m(ClientAppActor pid=429337)[0m Client 5 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429337)[0m client loading model
[36m(ClientAppActor pid=429337)[0m loading data
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429334)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m partition loaded
[36m(ClientAppActor pid=429337)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b41e1430>, len val=500, len test=500
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m gpu in client
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429337)[0m Available devices  1
[36m(ClientAppActor pid=429337)[0m Current cuda device  0
[36m(ClientAppActor pid=429337)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=429337)[0m before loading model statdict
[36m(ClientAppActor pid=429337)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 30 ACC is =  0.4056
round 30 loss is =  1.634285533428192
Current best ACC is =  0.4056
Saving round 30 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 31: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a441a8590>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54ba5c70>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 31 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_31.pth
[36m(ClientAppActor pid=429337)[0m Client 6 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429337)[0m client loading model
[36m(ClientAppActor pid=429337)[0m loading data
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=429336)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de3cfae5b50>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 31 ACC is =  0.4138
round 31 loss is =  1.617613172531128
Current best ACC is =  0.4138
Saving round 31 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 32: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429338)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb401928a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b409ecc0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 32 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_32.pth
[36m(ClientAppActor pid=429337)[0m Client 3 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680447acf80>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 32 ACC is =  0.4174
round 32 loss is =  1.6100351929664611
Current best ACC is =  0.4174
Saving round 32 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 33: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f78fbd70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m training started
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a441a8d70>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 33 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_33.pth
[36m(ClientAppActor pid=429342)[0m Client 0 / 10
[36m(ClientAppActor pid=429342)[0m client calling
[36m(ClientAppActor pid=429333)[0m client loading model
[36m(ClientAppActor pid=429333)[0m loading data
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429342)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328d94da0>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=429339)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 33 ACC is =  0.4224
round 33 loss is =  1.599331784248352
Current best ACC is =  0.4224
Saving round 33 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 34: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x724771351d60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b43f80590>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 34 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_34.pth
[36m(ClientAppActor pid=429335)[0m Client 5 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429334)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de3c4773350>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 34 ACC is =  0.4248
round 34 loss is =  1.5893707633018495
Current best ACC is =  0.4248
Saving round 34 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 35: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b603f5460>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f7816d50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 35 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_35.pth
[36m(ClientAppActor pid=429337)[0m Client 7 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429342)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328de0b90>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429337)[0m Available devices  1
[36m(ClientAppActor pid=429337)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 35 ACC is =  0.4286
round 35 loss is =  1.5792212247848512
Current best ACC is =  0.4286
Saving round 35 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 36: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fbb23f731d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd098ca0b60>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 36 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_36.pth
[36m(ClientAppActor pid=429341)[0m Client 6 / 10
[36m(ClientAppActor pid=429341)[0m client calling
[36m(ClientAppActor pid=429341)[0m client loading model
[36m(ClientAppActor pid=429341)[0m loading data
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=429342)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328fa4560>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 36 ACC is =  0.428
round 36 loss is =  1.567499613761902
Round 37: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429338)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a38bd3f80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b41a1e20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 37 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_37.pth
[36m(ClientAppActor pid=429335)[0m Client 0 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429339)[0m client loading model
[36m(ClientAppActor pid=429339)[0m loading data
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=429336)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd09804f470>, len val=500, len test=500
[36m(ClientAppActor pid=429336)[0m gpu in client
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429336)[0m Available devices  1
[36m(ClientAppActor pid=429336)[0m Current cuda device  0
[36m(ClientAppActor pid=429336)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=429336)[0m before loading model statdict
[36m(ClientAppActor pid=429336)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 37 ACC is =  0.4398
round 37 loss is =  1.5572511196136474
Current best ACC is =  0.4398
Saving round 37 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 38: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b43fe6ab0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a38be14f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 38 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_38.pth
[36m(ClientAppActor pid=429341)[0m Client 7 / 10
[36m(ClientAppActor pid=429341)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429342)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a01f1550>, len val=500, len test=500
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=429339)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 38 ACC is =  0.4354
round 38 loss is =  1.557136857509613
Round 39: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a38be09e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a38be0410>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 39 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_39.pth
[36m(ClientAppActor pid=429334)[0m Client 3 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=429342)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328e95040>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=429339)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 39 ACC is =  0.4384
round 39 loss is =  1.5444923400878907
Round 40: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd0981e0e90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429341)[0m training started
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a440582f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 40 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_40.pth
[36m(ClientAppActor pid=429335)[0m Client 6 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=429342)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7febdf5c0650>, len val=500, len test=500
[36m(ClientAppActor pid=429338)[0m gpu in client
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429338)[0m Available devices  1
[36m(ClientAppActor pid=429338)[0m Current cuda device  0
[36m(ClientAppActor pid=429336)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429338)[0m after loading model statdict
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 40 ACC is =  0.445
round 40 loss is =  1.5349164009094238
Current best ACC is =  0.445
Saving round 40 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 41: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd13bf82f30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m training started
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a381db8f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 41 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_41.pth
[36m(ClientAppActor pid=429341)[0m Client 4 / 10
[36m(ClientAppActor pid=429341)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429342)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7febdf56f5f0>, len val=500, len test=500
[36m(ClientAppActor pid=429338)[0m gpu in client
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429338)[0m Available devices  1
[36m(ClientAppActor pid=429338)[0m Current cuda device  0
[36m(ClientAppActor pid=429338)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=429338)[0m before loading model statdict
[36m(ClientAppActor pid=429338)[0m after loading model statdict
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709ae9d59be0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 41 ACC is =  0.4432
round 41 loss is =  1.5285014390945435
Round 42: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m Client 8 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429340)[0m client loading model
[36m(ClientAppActor pid=429340)[0m loading data
[36m(ClientAppActor pid=429340)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a9b4bfd940>, len val=500, len test=500
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429340)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8ee79baa0>, len val=500, len test=500
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429340)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m training started
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba84c99010>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=429341)[0m before loading model statdict
[36m(ClientAppActor pid=429341)[0m after loading model statdict
[36m(ClientAppActor pid=429341)[0m training started
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 42 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_42.pth
[36m(ClientAppActor pid=429334)[0m Client 1 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429341)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de32896bf50>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b41f04a0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 42 ACC is =  0.4476
round 42 loss is =  1.5262418270111084
Current best ACC is =  0.4476
Saving round 42 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 43: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429337)[0m Client 1 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429337)[0m client loading model
[36m(ClientAppActor pid=429337)[0m loading data
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429341)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680f40aec00>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a01cc170>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=429339)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a38b92630>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 43 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_43.pth
[36m(ClientAppActor pid=429340)[0m Client 6 / 10
[36m(ClientAppActor pid=429340)[0m client calling
[36m(ClientAppActor pid=429340)[0m client loading model
[36m(ClientAppActor pid=429340)[0m loading data
[36m(ClientAppActor pid=429340)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=429342)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m 
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd098027050>, len val=500, len test=500
[36m(ClientAppActor pid=429336)[0m gpu in client
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429336)[0m Available devices  1
[36m(ClientAppActor pid=429336)[0m Current cuda device  0
[36m(ClientAppActor pid=429336)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=429336)[0m before loading model statdict
[36m(ClientAppActor pid=429336)[0m after loading model statdict
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 43 ACC is =  0.4524
round 43 loss is =  1.5157184839248656
Current best ACC is =  0.4524
Saving round 43 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 44: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429338)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a01a55b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429338)[0m training started
[36m(ClientAppActor pid=429338)[0m number of epochs in this 2
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de3c47c43b0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429335)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a01f0e00>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=429339)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680447814c0>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429333)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429333)[0m training started[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 44 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_44.pth
[36m(ClientAppActor pid=429341)[0m Client 6 / 10
[36m(ClientAppActor pid=429341)[0m client calling
[36m(ClientAppActor pid=429333)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f79bce90>, len val=500, len test=500
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429340)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 44 ACC is =  0.4516
round 44 loss is =  1.5105411052703857
Round 45: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd0981e9a60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m training started
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a02f0170>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 45 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_45.pth
[36m(ClientAppActor pid=429336)[0m Client 6 / 10
[36m(ClientAppActor pid=429336)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429335)[0m  
[36m(ClientAppActor pid=429339)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition=
[36m(ClientAppActor pid=429335)[0m 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de32b030740>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 45 ACC is =  0.4524
round 45 loss is =  1.5027733206748963
Round 46: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b60177110>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b60177110>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 46 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_46.pth
[36m(ClientAppActor pid=429334)[0m Client 1 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429338)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328dd7e60>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 46 ACC is =  0.4564
round 46 loss is =  1.4963464498519898
Current best ACC is =  0.4564
Saving round 46 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 47: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429338)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54ba7410>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54bf8170>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 47 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_47.pth
[36m(ClientAppActor pid=429335)[0m Client 2 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429334)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba78772d80>, len val=500, len test=500
[36m(ClientAppActor pid=429341)[0m gpu in client
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429341)[0m Available devices  1
[36m(ClientAppActor pid=429341)[0m Current cuda device  0
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=429341)[0m before loading model statdict
[36m(ClientAppActor pid=429341)[0m after loading model statdict
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 47 ACC is =  0.4624
round 47 loss is =  1.4929064512252808
Current best ACC is =  0.4624
Saving round 47 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 48: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54bb5400>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54ba7d10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 48 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_48.pth
[36m(ClientAppActor pid=429342)[0m Client 2 / 10
[36m(ClientAppActor pid=429342)[0m client calling
[36m(ClientAppActor pid=429342)[0m client loading model
[36m(ClientAppActor pid=429342)[0m loading data
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a01a5340>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 48 ACC is =  0.4618
round 48 loss is =  1.48267982006073
Round 49: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429338)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb40c5ca10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429338)[0m training started
[36m(ClientAppActor pid=429338)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b4ab97c0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m partition loaded
[36m(ClientAppActor pid=429337)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 49 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_49.pth
[36m(ClientAppActor pid=429335)[0m Client 7 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de3c4773fe0>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 49 ACC is =  0.4684
round 49 loss is =  1.4754974246025085
Current best ACC is =  0.4684
Saving round 49 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 50: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429338)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb40096990>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429338)[0m training started
[36m(ClientAppActor pid=429338)[0m number of epochs in this 2
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54ba7620>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 50 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_50.pth
[36m(ClientAppActor pid=429335)[0m Client 0 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429337)[0m client loading model
[36m(ClientAppActor pid=429337)[0m loading data
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429334)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m partition loaded
[36m(ClientAppActor pid=429341)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m partition loaded
[36m(ClientAppActor pid=429342)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba84c995e0>, len val=500, len test=500
[36m(ClientAppActor pid=429341)[0m gpu in client
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429341)[0m Available devices  1
[36m(ClientAppActor pid=429341)[0m Current cuda device  0
[36m(ClientAppActor pid=429341)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=429341)[0m before loading model statdict
[36m(ClientAppActor pid=429341)[0m after loading model statdict
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 50 ACC is =  0.4614
round 50 loss is =  1.4722183465957641
Round 51: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f7816d50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a9a9792810>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 51 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_51.pth
[36m(ClientAppActor pid=429342)[0m Client 4 / 10
[36m(ClientAppActor pid=429342)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=429334)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m partition loaded
[36m(ClientAppActor pid=429342)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f78b4950>, len val=500, len test=500
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 51 ACC is =  0.467
round 51 loss is =  1.4645099878311156
Round 52: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb401d4680>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429336)[0m training started
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680f6169010>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429333)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a2ff67fe0>, len val=500, len test=500
[36m(ClientAppActor pid=429342)[0m gpu in client
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429342)[0m Available devices  1
[36m(ClientAppActor pid=429342)[0m Current cuda device  0
[36m(ClientAppActor pid=429342)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=429342)[0m before loading model statdict
[36m(ClientAppActor pid=429342)[0m after loading model statdict
[36m(ClientAppActor pid=429342)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429342)[0m training started
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 52 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_52.pth
[36m(ClientAppActor pid=429335)[0m Client 8 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429340)[0m client loading model
[36m(ClientAppActor pid=429340)[0m loading data
[36m(ClientAppActor pid=429340)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8ee79bb00>, len val=500, len test=500
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 52 ACC is =  0.471
round 52 loss is =  1.45614333152771
Current best ACC is =  0.471
Saving round 52 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 53: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9bf3f800e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba84ce97f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m partition loaded
[36m(ClientAppActor pid=429341)[0m len partition= 5000
[36m(ClientAppActor pid=429341)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 53 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_53.pth
[36m(ClientAppActor pid=429338)[0m Client 6 / 10
[36m(ClientAppActor pid=429338)[0m client calling
[36m(ClientAppActor pid=429342)[0m client loading model
[36m(ClientAppActor pid=429342)[0m loading data
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429341)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328ee5760>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 53 ACC is =  0.477
round 53 loss is =  1.4512381434440613
Current best ACC is =  0.477
Saving round 53 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 54: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b60045640>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb40192fc0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 54 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_54.pth
[36m(ClientAppActor pid=429335)[0m Client 1 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429336)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba84cd8290>, len val=500, len test=500
[36m(ClientAppActor pid=429341)[0m gpu in client
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429341)[0m Available devices  1
[36m(ClientAppActor pid=429341)[0m Current cuda device  0
[36m(ClientAppActor pid=429341)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=429341)[0m before loading model statdict
[36m(ClientAppActor pid=429341)[0m after loading model statdict
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 54 ACC is =  0.4736
round 54 loss is =  1.446915364265442
Round 55: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429338)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd0981f18b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a471da7e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 55 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_55.pth
[36m(ClientAppActor pid=429337)[0m Client 6 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=429342)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328de1cd0>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 55 ACC is =  0.48
round 55 loss is =  1.440237808227539
Current best ACC is =  0.48
Saving round 55 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 56: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429338)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54bbcb00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m training started
[36m(ClientAppActor pid=429338)[0m number of epochs in this 2
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b54bf8530>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 56 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_56.pth
[36m(ClientAppActor pid=429334)[0m Client 0 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429333)[0m client loading model
[36m(ClientAppActor pid=429333)[0m loading data
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=429342)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328fa5f10>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 56 ACC is =  0.4786
round 56 loss is =  1.4332441329956054
Round 57: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a009be00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a440582f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 57 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_57.pth
[36m(ClientAppActor pid=429333)[0m Client 4 / 10
[36m(ClientAppActor pid=429333)[0m client calling
[36m(ClientAppActor pid=429342)[0m client loading model
[36m(ClientAppActor pid=429342)[0m loading data
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429342)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m partition loaded
[36m(ClientAppActor pid=429342)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba84cf39b0>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429341)[0m Available devices  1
[36m(ClientAppActor pid=429341)[0m Current cuda device  0
[36m(ClientAppActor pid=429341)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=429341)[0m before loading model statdict
[36m(ClientAppActor pid=429341)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 57 ACC is =  0.4872
round 57 loss is =  1.4221287369728088
Current best ACC is =  0.4872
Saving round 57 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 58: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680443ed340>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429341)[0m training started
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a381d84d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 58 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_58.pth
[36m(ClientAppActor pid=429334)[0m Client 1 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429338)[0m client loading model
[36m(ClientAppActor pid=429338)[0m loading data
[36m(ClientAppActor pid=429338)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429342)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m partition loaded
[36m(ClientAppActor pid=429342)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m 5000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x728394b8c530>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429339)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fbb23f725d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 58 ACC is =  0.4858
round 58 loss is =  1.4175153017044066
Round 59: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m Client 3 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429338)[0m client loading model
[36m(ClientAppActor pid=429338)[0m loading data
[36m(ClientAppActor pid=429338)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict
[36m(ClientAppActor pid=429341)[0m after loading model statdict
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328fa5f10>, len val=500, len test=500
[36m(ClientAppActor pid=429342)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680a2b2a330>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 59 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_59.pth
[36m(ClientAppActor pid=429335)[0m Client 8 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=429338)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de3289c0b00>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a01a5310>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 59 ACC is =  0.485
round 59 loss is =  1.4148385643959045
Round 60: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m Client 9 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429339)[0m client loading model
[36m(ClientAppActor pid=429339)[0m loading data
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a01f1820>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429339)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680289a24e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 60 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_60.pth
[36m(ClientAppActor pid=429340)[0m Client 1 / 10
[36m(ClientAppActor pid=429340)[0m client calling
[36m(ClientAppActor pid=429340)[0m client loading model
[36m(ClientAppActor pid=429340)[0m loading data
[36m(ClientAppActor pid=429340)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429340)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de31fe55280>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 60 ACC is =  0.4898
round 60 loss is =  1.404389464855194
Current best ACC is =  0.4898
Saving round 60 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 61: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9bf3f80050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a9a9793020>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 61 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_61.pth
[36m(ClientAppActor pid=429335)[0m Client 9 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429333)[0m client loading model
[36m(ClientAppActor pid=429333)[0m loading data
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429339)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429336)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7284335737a0>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 61 ACC is =  0.4922
round 61 loss is =  1.4008294463157653
Current best ACC is =  0.4922
Saving round 61 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 62: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb40068170>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680289a0560>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 1] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429342)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a38b9db20>, len val=500, len test=500
[36m(ClientAppActor pid=429342)[0m gpu in client
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 5] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 62 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_62.pth
[36m(ClientAppActor pid=429340)[0m Client 2 / 10
[36m(ClientAppActor pid=429340)[0m client calling
[36m(ClientAppActor pid=429340)[0m client loading model
[36m(ClientAppActor pid=429340)[0m loading data
[36m(ClientAppActor pid=429340)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a9a9793050>, len val=500, len test=500
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 62 ACC is =  0.4956
round 62 loss is =  1.3947456002235412
Current best ACC is =  0.4956
Saving round 62 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 63: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76804428b650>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429336)[0m training started
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7284335732c0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 63 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_63.pth
[36m(ClientAppActor pid=429335)[0m Client 0 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429339)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7284335728d0>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=429339)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429342)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 63 ACC is =  0.4992
round 63 loss is =  1.3915048122406006
Current best ACC is =  0.4992
Saving round 63 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 64: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb401e1610>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429336)[0m training started
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x768028b04e00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 64 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_64.pth
[36m(ClientAppActor pid=429335)[0m Client 1 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429333)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 
[36m(ClientAppActor pid=429335)[0m 5000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b4077e30>, len val=500, len test=500
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 64 ACC is =  0.4974
round 64 loss is =  1.3888387203216552
Round 65: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba84d98a70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m training started
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd098077f80>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 65 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_65.pth
[36m(ClientAppActor pid=429338)[0m Client 6 / 10
[36m(ClientAppActor pid=429338)[0m client calling
[36m(ClientAppActor pid=429338)[0m client loading model
[36m(ClientAppActor pid=429338)[0m loading data
[36m(ClientAppActor pid=429338)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=429336)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328fe5970>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429342)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 65 ACC is =  0.5004
round 65 loss is =  1.3828416824340821
Current best ACC is =  0.5004
Saving round 65 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 66: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd098ca0b90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429341)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba84d996a0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 66 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_66.pth
[36m(ClientAppActor pid=429333)[0m Client 2 / 10
[36m(ClientAppActor pid=429333)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=429342)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328ee6150>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 66 ACC is =  0.5024
round 66 loss is =  1.3736819267272948
Current best ACC is =  0.5024
Saving round 66 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 67: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b603f5070>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b49a5070>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 67 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_67.pth
[36m(ClientAppActor pid=429335)[0m Client 6 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429339)[0m client loading model
[36m(ClientAppActor pid=429339)[0m loading data
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429339)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b494d3d0>, len val=500, len test=500
[36m(ClientAppActor pid=429342)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429336)[0m Available devices  1
[36m(ClientAppActor pid=429336)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=429337)[0m before loading model statdict
[36m(ClientAppActor pid=429337)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 67 ACC is =  0.4988
round 67 loss is =  1.3701143264770508
Round 68: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a009b920>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x728394ba8770>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 68 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_68.pth
[36m(ClientAppActor pid=429338)[0m Client 2 / 10
[36m(ClientAppActor pid=429338)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=429342)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283941257f0>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=429339)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 68 ACC is =  0.5082
round 68 loss is =  1.3704823493957519
Current best ACC is =  0.5082
Saving round 68 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 69: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b43fb53d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=429341)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba84c9ba70>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 69 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_69.pth
[36m(ClientAppActor pid=429335)[0m Client 0 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429342)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba84ce84a0>, len val=500, len test=500
[36m(ClientAppActor pid=429341)[0m gpu in client
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429341)[0m Available devices  1
[36m(ClientAppActor pid=429341)[0m Current cuda device  0
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429341)[0m before loading model statdict
[36m(ClientAppActor pid=429341)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 69 ACC is =  0.5082
round 69 loss is =  1.3597631812095643
Round 70: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680442e07a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Client 2 / 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client calling[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client loading model[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd098c64470>, len val=500, len test=500
[36m(ClientAppActor pid=429336)[0m gpu in client
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 6[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680289bf980>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429336)[0m Available devices  1
[36m(ClientAppActor pid=429336)[0m Current cuda device  0
[36m(ClientAppActor pid=429336)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429336)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=429336)[0m before loading model statdict
[36m(ClientAppActor pid=429336)[0m after loading model statdict
[36m(ClientAppActor pid=429336)[0m training started
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=429341)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb401d7830>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 70 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_70.pth
[36m(ClientAppActor pid=429340)[0m Client 1 / 10
[36m(ClientAppActor pid=429340)[0m client calling
[36m(ClientAppActor pid=429340)[0m client loading model
[36m(ClientAppActor pid=429340)[0m loading data
[36m(ClientAppActor pid=429340)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429341)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76802898f650>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 70 ACC is =  0.5042
round 70 loss is =  1.3649319052696227
Round 71: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a38be15b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76810134d850>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 71 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_71.pth
[36m(ClientAppActor pid=429335)[0m Client 4 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=429341)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m partition loaded
[36m(ClientAppActor pid=429334)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m partition loaded
[36m(ClientAppActor pid=429337)[0m len partition= 5000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b60045640>, len val=500, len test=500
[36m(ClientAppActor pid=429341)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429337)[0m Available devices  1
[36m(ClientAppActor pid=429337)[0m Current cuda device  0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429334)[0m before loading model statdict
[36m(ClientAppActor pid=429334)[0m after loading model statdict
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 71 ACC is =  0.5088
round 71 loss is =  1.3526687264442443
Current best ACC is =  0.5088
Saving round 71 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 72: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680f40aefc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7284335a4170>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 72 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_72.pth
[36m(ClientAppActor pid=429334)[0m Client 5 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429339)[0m client loading model
[36m(ClientAppActor pid=429339)[0m loading data
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429339)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429334)[0m partition loaded
[36m(ClientAppActor pid=429334)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f78fb5c0>, len val=500, len test=500
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429340)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 72 ACC is =  0.5104
round 72 loss is =  1.3456308245658875
Current best ACC is =  0.5104
Saving round 72 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 73: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m Client 1 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680f436c680>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Client 4 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429337)[0m client loading model
[36m(ClientAppActor pid=429337)[0m loading data
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m partition loaded
[36m(ClientAppActor pid=429337)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f78f8c50>, len val=500, len test=500
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429337)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=429337)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m training started
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709ad756f050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 73 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_73.pth
[36m(ClientAppActor pid=429335)[0m Client 5 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429342)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f78b73e0>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429340)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 73 ACC is =  0.5142
round 73 loss is =  1.339102602005005
Current best ACC is =  0.5142
Saving round 73 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 74: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429338)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328de16a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429338)[0m training started
[36m(ClientAppActor pid=429338)[0m number of epochs in this 2
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a2ff67fb0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 74 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_74.pth
[36m(ClientAppActor pid=429335)[0m Client 2 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429342)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a009b230>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=429339)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 74 ACC is =  0.5158
round 74 loss is =  1.3370479941368103
Current best ACC is =  0.5158
Saving round 74 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 75: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.0001
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a38be61b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 6] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a38b9f650>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 0] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 75 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_75.pth
[36m(ClientAppActor pid=429337)[0m Client 5 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429337)[0m client loading model
[36m(ClientAppActor pid=429337)[0m loading data
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429342)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m partition loaded
[36m(ClientAppActor pid=429334)[0m len partition= 5000
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76804429f7d0>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m gpu in client
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 75 ACC is =  0.5172
round 75 loss is =  1.3293878316879273
Current best ACC is =  0.5172
Saving round 75 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 76: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7feb40dae090>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m [Client 2] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429341)[0m training started
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680443edb20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 9] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 76 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_76.pth
[36m(ClientAppActor pid=429342)[0m Client 3 / 10
[36m(ClientAppActor pid=429342)[0m client calling
[36m(ClientAppActor pid=429342)[0m client loading model
[36m(ClientAppActor pid=429342)[0m loading data
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=429337)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m partition loaded
[36m(ClientAppActor pid=429342)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x728394ba48c0>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429341)[0m Available devices  1
[36m(ClientAppActor pid=429341)[0m Current cuda device  0
[36m(ClientAppActor pid=429341)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=429341)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 76 ACC is =  0.52
round 76 loss is =  1.3303175806999206
Current best ACC is =  0.52
Saving round 76 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 77: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f7ee91f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 3] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m training started
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9b6032ee10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 1] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 77 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_77.pth
[36m(ClientAppActor pid=429335)[0m Client 2 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429341)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f78fbec0>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246c00cc1d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 3] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 77 ACC is =  0.5238
round 77 loss is =  1.315942895412445
Current best ACC is =  0.5238
Saving round 77 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 78: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429338)[0m Client 1 / 10
[36m(ClientAppActor pid=429338)[0m client calling
[36m(ClientAppActor pid=429338)[0m client loading model
[36m(ClientAppActor pid=429338)[0m loading data
[36m(ClientAppActor pid=429338)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429337)[0m gpu in client
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429337)[0m Available devices  1
[36m(ClientAppActor pid=429337)[0m Current cuda device  0
[36m(ClientAppActor pid=429337)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429337)[0m before loading model statdict
[36m(ClientAppActor pid=429337)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f79bd130>, len val=500, len test=500
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429340)[0m [Client 9] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429340)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429342)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m training started
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246c0082000>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 0] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 78 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_78.pth
[36m(ClientAppActor pid=429335)[0m Client 4 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429333)[0m client loading model
[36m(ClientAppActor pid=429333)[0m loading data
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=429339)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m partition loaded
[36m(ClientAppActor pid=429336)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a0381a30>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=429339)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a445e9eb0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 78 ACC is =  0.522
round 78 loss is =  1.3159098863601684
Round 79: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429337)[0m Client 4 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429337)[0m client loading model
[36m(ClientAppActor pid=429337)[0m loading data
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328fe5970>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328dd56d0>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 0] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd08c734770>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 4] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 79 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_79.pth
[36m(ClientAppActor pid=429335)[0m Client 9 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429333)[0m client loading model
[36m(ClientAppActor pid=429333)[0m loading data
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429336)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429334)[0m partition loaded
[36m(ClientAppActor pid=429334)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x768044398ce0>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a00ed640>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 79 ACC is =  0.5276
round 79 loss is =  1.3074595212936402
Current best ACC is =  0.5276
Saving round 79 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 80: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m Client 5 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x728394b6c6e0>, len val=500, len test=500
[36m(ClientAppActor pid=429339)[0m gpu in client
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429339)[0m Available devices  1
[36m(ClientAppActor pid=429339)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m [Client 0] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429339)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8ee929100>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 8] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 80 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_80.pth
[36m(ClientAppActor pid=429340)[0m Client 0 / 10
[36m(ClientAppActor pid=429340)[0m client calling
[36m(ClientAppActor pid=429340)[0m client loading model
[36m(ClientAppActor pid=429340)[0m loading data
[36m(ClientAppActor pid=429340)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429340)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328dd77a0>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 80 ACC is =  0.5264
round 80 loss is =  1.307875919342041
Round 81: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429334)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client loading model[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 7[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429334)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a9bf3f80050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m [Client 6] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429336)[0m training started
[36m(ClientAppActor pid=429336)[0m number of epochs in this 2
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba7bfa4aa0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=429341)[0m [Client 3] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 3] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 81 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_81.pth
[36m(ClientAppActor pid=429335)[0m Client 4 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429339)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429341)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328f0ee40>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=429338)[0m before loading model statdict
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m after loading model statdict
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 81 ACC is =  0.5256
round 81 loss is =  1.30872722864151
Round 82: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429336)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Client 4 / 10
[36m(ClientAppActor pid=429333)[0m client calling
[36m(ClientAppActor pid=429334)[0m Client 5 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=429336)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7dd0981b5340>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 7] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m training started
[36m(ClientAppActor pid=429338)[0m number of epochs in this 2
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680f436c680>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=429333)[0m [Client 4] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 82 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_82.pth
[36m(ClientAppActor pid=429334)[0m Client 6 / 10
[36m(ClientAppActor pid=429334)[0m client calling
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=429333)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de32896bc20>, len val=500, len test=500
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m gpu in client
[36m(ClientAppActor pid=429334)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429334)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429334)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429334)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429334)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429334)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429334)[0m Available devices  1
[36m(ClientAppActor pid=429334)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 82 ACC is =  0.5274
round 82 loss is =  1.3016186475753784
Round 83: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429335)[0m Client 7 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b40a9370>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=429337)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429341)[0m partition loaded
[36m(ClientAppActor pid=429341)[0m len partition= 5000
[36m(ClientAppActor pid=429341)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de3289948f0>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429341)[0m Available devices  1
[36m(ClientAppActor pid=429341)[0m Current cuda device  0
[36m(ClientAppActor pid=429341)[0m [Client 1] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429341)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=429341)[0m before loading model statdict
[36m(ClientAppActor pid=429341)[0m after loading model statdict
[36m(ClientAppActor pid=429341)[0m training started
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=429338)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7febdf56f7d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 5] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 83 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_83.pth
[36m(ClientAppActor pid=429337)[0m Client 3 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429338)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m client loading model
[36m(ClientAppActor pid=429340)[0m loading data
[36m(ClientAppActor pid=429340)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de32896b800>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429336)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429336)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429336)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429336)[0m Available devices  1
[36m(ClientAppActor pid=429336)[0m Current cuda device  0
[36m(ClientAppActor pid=429336)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 83 ACC is =  0.5256
round 83 loss is =  1.300715684890747
Round 84: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429341)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Client 8 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429337)[0m Client 2 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba7be25940>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m [Client 8] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a9b82ed790>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429340)[0m [Client 3] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 84 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_84.pth
[36m(ClientAppActor pid=429335)[0m Client 8 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429333)[0m client loading model
[36m(ClientAppActor pid=429333)[0m loading data
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=429334)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328997aa0>, len val=500, len test=500
[36m(ClientAppActor pid=429342)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429340)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m after loading model statdict
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 84 ACC is =  0.5242
round 84 loss is =  1.305064046382904
Round 85: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680443ed340>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429333)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429334)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 6] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b41f7a10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429337)[0m [Client 1] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 85 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_85.pth
[36m(ClientAppActor pid=429335)[0m Client 8 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429334)[0m client loading model
[36m(ClientAppActor pid=429334)[0m loading data
[36m(ClientAppActor pid=429334)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429337)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f78fa810>, len val=500, len test=500
[36m(ClientAppActor pid=429340)[0m gpu in client
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429340)[0m Available devices  1
[36m(ClientAppActor pid=429340)[0m Current cuda device  0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 85 ACC is =  0.5274
round 85 loss is =  1.3033394813537598
Round 86: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Client 5 / 10[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client calling[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429333)[0m client loading model
[36m(ClientAppActor pid=429333)[0m loading data
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7680289bec90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m Client 8 / 10[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 0] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429333)[0m training started
[36m(ClientAppActor pid=429333)[0m number of epochs in this 2
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283a01f1820>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 8] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 86 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_86.pth
[36m(ClientAppActor pid=429335)[0m Client 5 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429338)[0m client loading model
[36m(ClientAppActor pid=429338)[0m loading data
[36m(ClientAppActor pid=429338)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=429339)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de3d2551790>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 86 ACC is =  0.5298
round 86 loss is =  1.2870696663856507
Current best ACC is =  0.5298
Saving round 86 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 87: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m Client 1 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429335)[0m Client 9 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a2ff91130>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 1] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429337)[0m training started
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709a44094530>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429342)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 8] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 87 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_87.pth
[36m(ClientAppActor pid=429335)[0m Client 4 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429333)[0m client loading model
[36m(ClientAppActor pid=429333)[0m loading data
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429339)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429340)[0m partition loaded
[36m(ClientAppActor pid=429340)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7febdf56f860>, len val=500, len test=500
[36m(ClientAppActor pid=429338)[0m gpu in client
[36m(ClientAppActor pid=429338)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429338)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429338)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429338)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429338)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429338)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429338)[0m Available devices  1
[36m(ClientAppActor pid=429338)[0m Current cuda device  0
[36m(ClientAppActor pid=429338)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m before loading model statdict
[36m(ClientAppActor pid=429340)[0m after loading model statdict
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 87 ACC is =  0.54
round 87 loss is =  1.2760456681251526
Current best ACC is =  0.54
Saving round 87 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_best.pth
Round 88: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429341)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Client 5 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429337)[0m Client 1 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429341)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7fba84dc8980>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 5] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429335)[0m training started
[36m(ClientAppActor pid=429335)[0m number of epochs in this 2
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=429342)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709ad756f290>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429342)[0m partition loaded
[36m(ClientAppActor pid=429342)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m [Client 4] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 88 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_88.pth
[36m(ClientAppActor pid=429335)[0m Client 9 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429336)[0m client loading model
[36m(ClientAppActor pid=429336)[0m loading data
[36m(ClientAppActor pid=429336)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=429342)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m partition loaded
[36m(ClientAppActor pid=429333)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76804428a870>, len val=500, len test=500
[36m(ClientAppActor pid=429333)[0m gpu in client
[36m(ClientAppActor pid=429333)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429333)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429333)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429333)[0m Available devices  1
[36m(ClientAppActor pid=429333)[0m Current cuda device  0
[36m(ClientAppActor pid=429333)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=429333)[0m before loading model statdict
[36m(ClientAppActor pid=429333)[0m after loading model statdict
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 88 ACC is =  0.5364
round 88 loss is =  1.2826138377189635
Round 89: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429340)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m Client 6 / 10[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client calling[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429337)[0m client loading model
[36m(ClientAppActor pid=429337)[0m loading data
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=429333)[0m client loading model
[36m(ClientAppActor pid=429333)[0m loading data
[36m(ClientAppActor pid=429333)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8f79bcbf0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429340)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429335)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429342)[0m Client 4 / 10[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 6[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 1] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429337)[0m training started
[36m(ClientAppActor pid=429337)[0m number of epochs in this 2
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=429339)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7283940b5fd0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429339)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429339)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=429339)[0m [Client 7] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 89 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_89.pth
[36m(ClientAppActor pid=429337)[0m Client 9 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429337)[0m client loading model
[36m(ClientAppActor pid=429337)[0m loading data
[36m(ClientAppActor pid=429337)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=429339)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429342)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de328de1a60>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=429335)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=429335)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=429335)[0m Available devices  1
[36m(ClientAppActor pid=429335)[0m Current cuda device  0
[36m(ClientAppActor pid=429335)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=429335)[0m before loading model statdict
[36m(ClientAppActor pid=429335)[0m after loading model statdict
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 89 ACC is =  0.5332
round 89 loss is =  1.27657550573349
Round 90: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=429337)[0m Client 0 / 10
[36m(ClientAppActor pid=429337)[0m client calling
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=429337)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7246b40ecdd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429337)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m partition loaded
[36m(ClientAppActor pid=429338)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m partition loaded
[36m(ClientAppActor pid=429339)[0m len partition= 5000
[36m(ClientAppActor pid=429339)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429338)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429338)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429339)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429339)[0m cuda:0
[36m(ClientAppActor pid=429339)[0m [Client 7] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=429339)[0m training started
[36m(ClientAppActor pid=429339)[0m number of epochs in this 2
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429337)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429337)[0m cuda:0
[36m(ClientAppActor pid=429334)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429334)[0m cuda:0
[36m(ClientAppActor pid=429336)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429336)[0m cuda:0
[36m(ClientAppActor pid=429341)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429341)[0m cuda:0
[36m(ClientAppActor pid=429342)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429342)[0m cuda:0
[36m(ClientAppActor pid=429333)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429333)[0m cuda:0
[36m(ClientAppActor pid=429340)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429340)[0m cuda:0
[36m(ClientAppActor pid=429338)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=429340)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71a8ee92ad20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429340)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=429341)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=429341)[0m [Client 2] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429341)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 90 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_90.pth
[36m(ClientAppActor pid=429335)[0m Client 3 / 10
[36m(ClientAppActor pid=429335)[0m client calling
[36m(ClientAppActor pid=429342)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m client loading model
[36m(ClientAppActor pid=429335)[0m loading data
[36m(ClientAppActor pid=429335)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=429335)[0m partition loaded
[36m(ClientAppActor pid=429335)[0m len partition= 5000
[36m(ClientAppActor pid=429333)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429333)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429342)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=429335)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=429335)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de32896be00>, len val=500, len test=500
[36m(ClientAppActor pid=429335)[0m gpu in client
[36m(ClientAppActor pid=429335)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=429335)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=429335)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=429335)[0m cuda:0
[36m(ClientAppActor pid=429335)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=429335)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
