{'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
Training on cuda:0
Flower 1.16.0 / PyTorch 2.6.0+cu124
{'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
{'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
{'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
cuda:0
server configured
Round 1: Phase = LEARN
10 clients selected for training
0
1
2
3
4
5
6
7
8
9
[36m(ClientAppActor pid=1153139)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153139)[0m Training on cuda:0
[36m(ClientAppActor pid=1153139)[0m Flower 1.16.0 / PyTorch 2.6.0+cu124
[36m(ClientAppActor pid=1153139)[0m client
[36m(ClientAppActor pid=1153139)[0m Client 7 / 10
[36m(ClientAppActor pid=1153139)[0m client calling
[36m(ClientAppActor pid=1153139)[0m Using freshly initialized model (no checkpoint loaded)
[36m(ClientAppActor pid=1153139)[0m client loading model
[36m(ClientAppActor pid=1153139)[0m loading data
[36m(ClientAppActor pid=1153139)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1153143)[0m partition loaded
[36m(ClientAppActor pid=1153143)[0m len partition= 5000
[36m(ClientAppActor pid=1153142)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=1153142)[0m Training on cuda:0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153142)[0m Flower 1.16.0 / PyTorch 2.6.0+cu124[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153142)[0m client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153142)[0m Client 6 / 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153142)[0m client calling[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153142)[0m Using freshly initialized model (no checkpoint loaded)[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153142)[0m client loading model[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153142)[0m loading data[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153142)[0m loading data completed, start partitioning for 6[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153143)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709ab21ab230>, len val=500, len test=500
[36m(ClientAppActor pid=1153145)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153143)[0m gpu in client
[36m(ClientAppActor pid=1153143)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1153143)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1153143)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153143)[0m cuda:0
[36m(ClientAppActor pid=1153143)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1153143)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 469 MiB, 23747 MiB
[36m(ClientAppActor pid=1153143)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 69936 MiB, 11114 MiB
[36m(ClientAppActor pid=1153143)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1153143)[0m Available devices  1
[36m(ClientAppActor pid=1153143)[0m Current cuda device  0
[36m(ClientAppActor pid=1153143)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 10}
[36m(ClientAppActor pid=1153143)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1153143)[0m before loading model statdict
[36m(ClientAppActor pid=1153143)[0m after loading model statdict
[36m(ClientAppActor pid=1153143)[0m 
[36m(ClientAppActor pid=1153143)[0m training started
[36m(ClientAppActor pid=1153143)[0m number of epochs in this 10
[36m(ClientAppActor pid=1153143)[0m epoch 0
[36m(ClientAppActor pid=1153145)[0m cuda:0
[36m(ClientAppActor pid=1153145)[0m 
[36m(ClientAppActor pid=1153146)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153146)[0m cuda:0
[36m(ClientAppActor pid=1153146)[0m 
[36m(ClientAppActor pid=1153149)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153146)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153148)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153147)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153139)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153149)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153139)[0m cuda:0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153148)[0m cuda:0
[36m(ClientAppActor pid=1153147)[0m cuda:0
[36m(ClientAppActor pid=1153139)[0m 
[36m(ClientAppActor pid=1153148)[0m 
[36m(ClientAppActor pid=1153147)[0m 
[36m(ClientAppActor pid=1153149)[0m cuda:0
[36m(ClientAppActor pid=1153149)[0m 
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153149)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7bb0fd966a20>, len val=500, len test=500[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153142)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153149)[0m gpu in client[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m __CUDNN VERSION: 90100[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m __Number CUDA Devices: 1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3309 MiB, 20908 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 71387 MiB, 9663 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153149)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 10}[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m [Client 0] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m before loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m after loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m training started[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m number of epochs in this 10[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m epoch 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1153142)[0m cuda:0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153142)[0m 
[36m(ClientAppActor pid=1153142)[0m partition loaded
[36m(ClientAppActor pid=1153142)[0m len partition= 5000
[36m(ClientAppActor pid=1153142)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153142)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7966f6bae090>, len val=500, len test=500
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153142)[0m gpu in client
[36m(ClientAppActor pid=1153142)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1153142)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1153142)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153142)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1153142)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 4260 MiB, 19956 MiB
[36m(ClientAppActor pid=1153142)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 73503 MiB, 7547 MiB
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153142)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1153142)[0m Available devices  1
[36m(ClientAppActor pid=1153142)[0m Current cuda device  0
[36m(ClientAppActor pid=1153142)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 10}
[36m(ClientAppActor pid=1153142)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1153142)[0m before loading model statdict
[36m(ClientAppActor pid=1153142)[0m after loading model statdict
[36m(ClientAppActor pid=1153142)[0m training started
[36m(ClientAppActor pid=1153142)[0m number of epochs in this 10
[36m(ClientAppActor pid=1153142)[0m epoch 1[32m [repeated 14x across cluster][0m
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153139)[0m epoch 4[32m [repeated 13x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153139)[0m epoch 6[32m [repeated 16x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153143)[0m epoch 9[32m [repeated 15x across cluster][0m
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153143)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153143)[0m client
[36m(ClientAppActor pid=1153143)[0m Client 8 / 10
[36m(ClientAppActor pid=1153143)[0m client calling
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153143)[0m Using freshly initialized model (no checkpoint loaded)
[36m(ClientAppActor pid=1153143)[0m client loading model
[36m(ClientAppActor pid=1153143)[0m loading data
[36m(ClientAppActor pid=1153143)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153149)[0m epoch 9[32m [repeated 11x across cluster][0m
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153147)[0m [Client 2] get_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m client
[36m(ClientAppActor pid=1153145)[0m Client 9 / 10
[36m(ClientAppActor pid=1153145)[0m client calling
[36m(ClientAppActor pid=1153145)[0m Using freshly initialized model (no checkpoint loaded)
[36m(ClientAppActor pid=1153145)[0m client loading model
[36m(ClientAppActor pid=1153145)[0m loading data
[36m(ClientAppActor pid=1153145)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1153143)[0m partition loaded
[36m(ClientAppActor pid=1153143)[0m len partition= 5000
[36m(ClientAppActor pid=1153142)[0m epoch 9[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153143)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709abc05fd70>, len val=500, len test=500
[36m(ClientAppActor pid=1153143)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153142)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1153143)[0m gpu in client
[36m(ClientAppActor pid=1153143)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1153143)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1153143)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153143)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153143)[0m cuda:0
[36m(ClientAppActor pid=1153143)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1153143)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 4760 MiB, 19456 MiB
[36m(ClientAppActor pid=1153143)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 73795 MiB, 7255 MiB
[36m(ClientAppActor pid=1153143)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1153143)[0m Available devices  1
[36m(ClientAppActor pid=1153143)[0m Current cuda device  0
[36m(ClientAppActor pid=1153143)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 10}
[36m(ClientAppActor pid=1153143)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1153143)[0m before loading model statdict
[36m(ClientAppActor pid=1153143)[0m after loading model statdict
[36m(ClientAppActor pid=1153143)[0m 
[36m(ClientAppActor pid=1153143)[0m training started
[36m(ClientAppActor pid=1153143)[0m number of epochs in this 10
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153145)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153145)[0m cuda:0
[36m(ClientAppActor pid=1153145)[0m 
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153145)[0m partition loaded
[36m(ClientAppActor pid=1153145)[0m len partition= 5000
[36m(ClientAppActor pid=1153143)[0m epoch 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153145)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x763a441a32c0>, len val=500, len test=500
[36m(ClientAppActor pid=1153145)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m gpu in client
[36m(ClientAppActor pid=1153145)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1153145)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1153145)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153145)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1153145)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 4760 MiB, 19456 MiB
[36m(ClientAppActor pid=1153145)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 73795 MiB, 7255 MiB
[36m(ClientAppActor pid=1153145)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1153145)[0m Available devices  1
[36m(ClientAppActor pid=1153145)[0m Current cuda device  0
[36m(ClientAppActor pid=1153145)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 10}
[36m(ClientAppActor pid=1153145)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1153145)[0m before loading model statdict
[36m(ClientAppActor pid=1153145)[0m after loading model statdict
[36m(ClientAppActor pid=1153145)[0m training started
[36m(ClientAppActor pid=1153145)[0m number of epochs in this 10
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153143)[0m epoch 3[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153143)[0m epoch 5[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153143)[0m epoch 7[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153143)[0m epoch 9[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153143)[0m [Client 8] get_parameters
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
[36m(ClientAppActor pid=1153139)[0m client
[36m(ClientAppActor pid=1153139)[0m Client 7 / 10
[36m(ClientAppActor pid=1153139)[0m client calling
[36m(ClientAppActor pid=1153145)[0m epoch 9
[36m(ClientAppActor pid=1153139)[0m Using freshly initialized model (no checkpoint loaded)
[36m(ClientAppActor pid=1153139)[0m client loading model
[36m(ClientAppActor pid=1153139)[0m loading data
[36m(ClientAppActor pid=1153139)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1153143)[0m partition loaded
[36m(ClientAppActor pid=1153143)[0m len partition= 5000
[36m(ClientAppActor pid=1153145)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1153149)[0m client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m Client 5 / 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m client calling[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m Using freshly initialized model (no checkpoint loaded)[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m client loading model[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m loading data[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m loading data completed, start partitioning for 5[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153143)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709b91661d00>, len val=500, len test=500
[36m(ClientAppActor pid=1153143)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153143)[0m gpu in client
[36m(ClientAppActor pid=1153143)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1153143)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1153143)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153143)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153143)[0m cuda:0
[36m(ClientAppActor pid=1153143)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1153143)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 4760 MiB, 19456 MiB
[36m(ClientAppActor pid=1153143)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 73795 MiB, 7255 MiB
[36m(ClientAppActor pid=1153143)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1153143)[0m Available devices  1
[36m(ClientAppActor pid=1153143)[0m Current cuda device  0
[36m(ClientAppActor pid=1153145)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153145)[0m cuda:0
[36m(ClientAppActor pid=1153147)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153147)[0m cuda:0
[36m(ClientAppActor pid=1153142)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153146)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153142)[0m cuda:0
[36m(ClientAppActor pid=1153139)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153139)[0m cuda:0
[36m(ClientAppActor pid=1153149)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m Client 3 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m Using freshly initialized model (no checkpoint loaded)[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m client loading model[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m loading data[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m loading data completed, start partitioning for 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153146)[0m cuda:0
[36m(ClientAppActor pid=1153148)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153148)[0m cuda:0
[36m(ClientAppActor pid=1153149)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153149)[0m cuda:0
[36m(ClientAppActor pid=1153149)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7bb0fe11a600>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}[32m [repeated 14x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 4760 MiB, 19456 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 73795 MiB, 7255 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m 
[36m(ClientAppActor pid=1153145)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153145)[0m cuda:0
[36m(ClientAppActor pid=1153143)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153143)[0m cuda:0
Aggregating aggregate_evaluate updates from 0 clients, 10 failures
[(<flwr.server.compat.driver_client_proxy.DriverClientProxy object at 0x78431d427410>, EvaluateRes(status=Status(code=<Code.EVALUATE_NOT_IMPLEMENTED: 4>, message='Client does not implement `evaluate`'), loss=0.0, num_examples=0, metrics={})), (<flwr.server.compat.driver_client_proxy.DriverClientProxy object at 0x78431d4276e0>, EvaluateRes(status=Status(code=<Code.EVALUATE_NOT_IMPLEMENTED: 4>, message='Client does not implement `evaluate`'), loss=0.0, num_examples=0, metrics={})), (<flwr.server.compat.driver_client_proxy.DriverClientProxy object at 0x78431d5ef9e0>, EvaluateRes(status=Status(code=<Code.EVALUATE_NOT_IMPLEMENTED: 4>, message='Client does not implement `evaluate`'), loss=0.0, num_examples=0, metrics={})), (<flwr.server.compat.driver_client_proxy.DriverClientProxy object at 0x78431d4250a0>, EvaluateRes(status=Status(code=<Code.EVALUATE_NOT_IMPLEMENTED: 4>, message='Client does not implement `evaluate`'), loss=0.0, num_examples=0, metrics={})), (<flwr.server.compat.driver_client_proxy.DriverClientProxy object at 0x78431d425640>, EvaluateRes(status=Status(code=<Code.EVALUATE_NOT_IMPLEMENTED: 4>, message='Client does not implement `evaluate`'), loss=0.0, num_examples=0, metrics={})), (<flwr.server.compat.driver_client_proxy.DriverClientProxy object at 0x78431d427020>, EvaluateRes(status=Status(code=<Code.EVALUATE_NOT_IMPLEMENTED: 4>, message='Client does not implement `evaluate`'), loss=0.0, num_examples=0, metrics={})), (<flwr.server.compat.driver_client_proxy.DriverClientProxy object at 0x78431d7eba70>, EvaluateRes(status=Status(code=<Code.EVALUATE_NOT_IMPLEMENTED: 4>, message='Client does not implement `evaluate`'), loss=0.0, num_examples=0, metrics={})), (<flwr.server.compat.driver_client_proxy.DriverClientProxy object at 0x78431d425790>, EvaluateRes(status=Status(code=<Code.EVALUATE_NOT_IMPLEMENTED: 4>, message='Client does not implement `evaluate`'), loss=0.0, num_examples=0, metrics={})), (<flwr.server.compat.driver_client_proxy.DriverClientProxy object at 0x78431d425a90>, EvaluateRes(status=Status(code=<Code.EVALUATE_NOT_IMPLEMENTED: 4>, message='Client does not implement `evaluate`'), loss=0.0, num_examples=0, metrics={})), (<flwr.server.compat.driver_client_proxy.DriverClientProxy object at 0x78431d424d10>, EvaluateRes(status=Status(code=<Code.EVALUATE_NOT_IMPLEMENTED: 4>, message='Client does not implement `evaluate`'), loss=0.0, num_examples=0, metrics={}))]
Round 2: Phase = LEARN
10 clients selected for training
0
1
2
3
4
5
6
7
8
9
[36m(ClientAppActor pid=1153139)[0m client
[36m(ClientAppActor pid=1153139)[0m Client 3 / 10
[36m(ClientAppActor pid=1153139)[0m client calling
[36m(ClientAppActor pid=1153139)[0m Using freshly initialized model (no checkpoint loaded)
[36m(ClientAppActor pid=1153139)[0m client loading model
[36m(ClientAppActor pid=1153139)[0m loading data
[36m(ClientAppActor pid=1153139)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1153143)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x709ab2b989e0>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 4760 MiB, 19456 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 73795 MiB, 7255 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153143)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m partition loaded
[36m(ClientAppActor pid=1153145)[0m len partition= 5000
[36m(ClientAppActor pid=1153149)[0m client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m Client 2 / 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m client calling[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m Using freshly initialized model (no checkpoint loaded)[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m client loading model[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m loading data[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m loading data completed, start partitioning for 2[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153147)[0m partition loaded
[36m(ClientAppActor pid=1153147)[0m len partition= 5000
[36m(ClientAppActor pid=1153145)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153145)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x763a44fe8fe0>, len val=500, len test=500
[36m(ClientAppActor pid=1153145)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153145)[0m gpu in client
[36m(ClientAppActor pid=1153145)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1153145)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1153145)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153145)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}
[36m(ClientAppActor pid=1153145)[0m cuda:0
[36m(ClientAppActor pid=1153145)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1153145)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 4760 MiB, 19456 MiB
[36m(ClientAppActor pid=1153145)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 73795 MiB, 7255 MiB
[36m(ClientAppActor pid=1153145)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1153145)[0m Available devices  1
[36m(ClientAppActor pid=1153145)[0m Current cuda device  0
[36m(ClientAppActor pid=1153145)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 10}
[36m(ClientAppActor pid=1153145)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1153145)[0m before loading model statdict
[36m(ClientAppActor pid=1153145)[0m after loading model statdict
[36m(ClientAppActor pid=1153145)[0m 
[36m(ClientAppActor pid=1153145)[0m training started
[36m(ClientAppActor pid=1153145)[0m number of epochs in this 10
[36m(ClientAppActor pid=1153145)[0m epoch 0
[36m(ClientAppActor pid=1153143)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153143)[0m cuda:0
[36m(ClientAppActor pid=1153142)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153147)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153147)[0m cuda:0
[36m(ClientAppActor pid=1153142)[0m cuda:0
[36m(ClientAppActor pid=1153143)[0m 
[36m(ClientAppActor pid=1153146)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153142)[0m 
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153139)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153139)[0m cuda:0
[36m(ClientAppActor pid=1153146)[0m cuda:0
[36m(ClientAppActor pid=1153148)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153148)[0m cuda:0
[36m(ClientAppActor pid=1153147)[0m 
[36m(ClientAppActor pid=1153139)[0m 
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153146)[0m 
[36m(ClientAppActor pid=1153148)[0m 
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153149)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1153149)[0m cuda:0
[36m(ClientAppActor pid=1153149)[0m 
[36m(ClientAppActor pid=1153149)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153149)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7bb0fe15b920>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': '{}', 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}[32m [repeated 14x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m {'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'resnet', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '0', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.0005', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LOCAL_EPOCHS': '10'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 4760 MiB, 19456 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 73795 MiB, 7255 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 10}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m [Client 2] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m number of epochs in this 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m epoch 1[32m [repeated 15x across cluster][0m
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153139)[0m epoch 4[32m [repeated 16x across cluster][0m
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153145)[0m epoch 6[32m [repeated 16x across cluster][0m
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153139)[0m epoch 8[32m [repeated 15x across cluster][0m
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153145)[0m 0
[36m(ClientAppActor pid=1153139)[0m 0
[36m(ClientAppActor pid=1153143)[0m 0
[36m(ClientAppActor pid=1153149)[0m 0
[36m(ClientAppActor pid=1153142)[0m 0
[36m(ClientAppActor pid=1153148)[0m 0
[36m(ClientAppActor pid=1153146)[0m 0
[36m(ClientAppActor pid=1153145)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1153147)[0m epoch 9[32m [repeated 15x across cluster][0m
[36m(ClientAppActor pid=1153147)[0m 0
[36m(ClientAppActor pid=1153145)[0m client
