model initiated
Using freshly initialized model (no checkpoint loaded)
{'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'SAVING_DIR': './checkpoints/1/SmallAllCNN/cifar10/2_17', 'LOADED_MODEL': SmallAllCNN(
  (features): Sequential(
    (0): Conv(
      (0): Conv2d(3, 38, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (1): BatchNorm2d(38, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
    (1): Conv(
      (0): Conv2d(38, 76, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (1): BatchNorm2d(76, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
    (2): Conv(
      (0): Conv2d(76, 76, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (1): BatchNorm2d(76, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
    (3): AvgPool2d(kernel_size=16, stride=16, padding=0)
    (4): Flatten()
  )
  (classifier): Sequential(
    (0): Linear(in_features=76, out_features=10, bias=True)
  )
)}
server configured
Round 1: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m Client 6 / 10
[36m(ClientAppActor pid=1331908)[0m client calling
[36m(ClientAppActor pid=1331908)[0m client loading model
[36m(ClientAppActor pid=1331908)[0m loading data
[36m(ClientAppActor pid=1331908)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331934)[0m partition loaded
[36m(ClientAppActor pid=1331934)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m Client 8 / 10[32m [repeated 9x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=1331910)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038c47fe0>, len val=500, len test=500
[36m(ClientAppActor pid=1331934)[0m gpu in client
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14878 MiB, 66172 MiB
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331934)[0m Available devices  1
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0
[36m(ClientAppActor pid=1331934)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331934)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331934)[0m before loading model statdict
[36m(ClientAppActor pid=1331934)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m training started
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9d7d63f0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 23223 MiB, 57827 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_1.pth
[36m(ClientAppActor pid=1331910)[0m [Client 8] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331910)[0m partition loaded
[36m(ClientAppActor pid=1331910)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5d43770>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 29053 MiB, 51997 MiB
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331910)[0m Available devices  1
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0
[36m(ClientAppActor pid=1331910)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331910)[0m before loading model statdict
[36m(ClientAppActor pid=1331910)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 1 ACC is =  0.2286
round 1 loss is =  2.2657790184020996
Current best ACC is =  0.2286
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 2: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d4819fb60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 29474 MiB, 51576 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331934)[0m training started
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809c1d1ee0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 29814 MiB, 51236 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 4] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 2 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_2.pth
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f893ff82d20>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 29814 MiB, 51236 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 8] set_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331764)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa4d70>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd092a8950>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 2 ACC is =  0.1716
round 2 loss is =  2.2046992063522337
Round 3: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809c0b1dc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331934)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9d18fb00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 3 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_3.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914154980>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 3 ACC is =  0.2118
round 3 loss is =  2.102134108543396
Round 4: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140db950>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5bf7e30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_4.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391410b2f0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0a98c20>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccdbc13cbc0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 8] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 4 ACC is =  0.2468
round 4 loss is =  2.00633841753006
Current best ACC is =  0.2468
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 5: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfdac30>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534aef4cb90>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_5.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331907)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093ee6db0>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b17c04d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 5 ACC is =  0.2782
round 5 loss is =  1.911119294166565
Current best ACC is =  0.2782
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 6: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89300f8c50>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be55af0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_6.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m [Client 7] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093e9bbf0>, len val=500, len test=500
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 4 clients, 6 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 6 ACC is =  0.308
round 6 loss is =  1.8275118172168732
Current best ACC is =  0.308
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 7: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b356ca70>, len val=500, len test=500[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_7.pth
[36m(ClientAppActor pid=1331913)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b4044050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bf8bf50>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd092dda00>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 7 ACC is =  0.3456
round 7 loss is =  1.7730125546455384
Current best ACC is =  0.3456
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 8: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c406e420>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b41e1790>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_8.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914a9a9c0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 8 ACC is =  0.3714
round 8 loss is =  1.7379342317581177
Current best ACC is =  0.3714
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 9: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f02ff87080>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd092a98e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_9.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739145e72c0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09154380>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 9 ACC is =  0.3766
round 9 loss is =  1.698430097103119
Current best ACC is =  0.3766
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 10: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c10ac00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0aeee1e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 10 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_10.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be6ad80>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09293ad0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 10 ACC is =  0.357
round 10 loss is =  1.7338488459587098
Round 11: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0aeed370>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac016db0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_11.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331907)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093f9d670>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 11 ACC is =  0.394
round 11 loss is =  1.6591517395443387
Current best ACC is =  0.394
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 12: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927e654f0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331909)[0m training started
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a09ec3e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_12.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be6acf0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 12 ACC is =  0.4014
round 12 loss is =  1.6407892107963562
Current best ACC is =  0.4014
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 13: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c08b590>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d1da8620>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 13 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_13.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c08b530>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809c0eda30>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 13 ACC is =  0.3728
round 13 loss is =  1.6816129684448242
Round 14: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be4a570>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331764)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d1baf800>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 14 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_14.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093eb6b10>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927eec7a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 14 ACC is =  0.4236
round 14 loss is =  1.590369164943695
Current best ACC is =  0.4236
Saving round 14 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 15: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b65b804b90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd091dbb30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 15 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_15.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b1773380>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c10ac60>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 15 ACC is =  0.4046
round 15 loss is =  1.6089207530021667
Round 16: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391419fe30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331907)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d1c23aa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 16 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_16.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331907)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093e99b50>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 16 ACC is =  0.4093333333333333
round 16 loss is =  1.5954424407747057
Round 17: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391410b2f0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331913)[0m training started
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038cc8050>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 17 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_17.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1f6180>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 17 ACC is =  0.4204
round 17 loss is =  1.5902068614959717
Round 18: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09293f80>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89301b5a30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_18.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140909e0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1f46b0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 18 ACC is =  0.4392
round 18 loss is =  1.549329149723053
Current best ACC is =  0.4392
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 19: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0919ea20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331909)[0m training started
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8930a27a40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 19 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_19.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b17730e0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09291fd0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 19 ACC is =  0.4054
round 19 loss is =  1.6162558555603028
Round 20: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9ccdbc20>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c40b3230>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 20 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_20.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140db3b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 20 ACC is =  0.439
round 20 loss is =  1.5328658819198608
Round 21: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914006660>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5bf40e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 21 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_21.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331909)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093f9d280>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 21 ACC is =  0.4096
round 21 loss is =  1.6234466195106507
Round 22: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd093d9c40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac016e40>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded
[36m(ClientAppActor pid=1331907)[0m len partition= 5000
[36m(ClientAppActor pid=1331907)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 22 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_22.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739c8f4d850>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784039191550>, len val=500, len test=500
[36m(ClientAppActor pid=1331934)[0m gpu in client
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 22 ACC is =  0.484
round 22 loss is =  1.467282223701477
Current best ACC is =  0.484
Saving round 22 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 23: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081c61b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038c617f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 23 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_23.pth
[36m(ClientAppActor pid=1331911)[0m Client 8 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a09f0650>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x78403915a930>, len val=500, len test=500
[36m(ClientAppActor pid=1331934)[0m gpu in client
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331934)[0m Available devices  1
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331934)[0m before loading model statdict
[36m(ClientAppActor pid=1331934)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140db950>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 3] set_parameters[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 23 ACC is =  0.4144
round 23 loss is =  1.5844058871269227
Round 24: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809cda61b0>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 4] set_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331764)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6b8731850>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 24 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_24.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cdc0b30>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093e99370>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 24 ACC is =  0.4948
round 24 loss is =  1.4439173936843872
Current best ACC is =  0.4948
Saving round 24 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 25: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081c6d20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038c47fe0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 25 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_25.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331934)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081c7e30>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 25 ACC is =  0.4452
round 25 loss is =  1.5141191482543945
Round 26: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4a9d850>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840392e4380>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 26 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_26.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331907)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m partition loaded
[36m(ClientAppActor pid=1331910)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914091550>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 26 ACC is =  0.4652
round 26 loss is =  1.466101086139679
Round 27: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093fe61e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89300a7860>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 27 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_27.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cca8c80>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093f9cd10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 27 ACC is =  0.4662
round 27 loss is =  1.4640440821647644
Round 28: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bec7950>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 28 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_28.pth
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4ba1640>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914157320>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0ae760c0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 28 ACC is =  0.4946
round 28 loss is =  1.4172807455062866
Round 29: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd091cfb90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331909)[0m training started
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927e7ba10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 29 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_29.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331934)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bf8bb30>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0971a60>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 29 ACC is =  0.4882
round 29 loss is =  1.4251196265220643
Round 30: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093f35490>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9d18ce30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 30 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_30.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1332116)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m partition loaded
[36m(ClientAppActor pid=1331910)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5b62870>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331910)[0m Available devices  1
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 30 ACC is =  0.4812
round 30 loss is =  1.4438913345336915
Round 31: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4ba1640>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f02ff87050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 31 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_31.pth
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0a98c80>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331907)[0m training started
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739141784a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 31 ACC is =  0.507
round 31 loss is =  1.4009278893470765
Current best ACC is =  0.507
Saving round 31 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 32: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
