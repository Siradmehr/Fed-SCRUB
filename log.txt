model initiated
Using freshly initialized model (no checkpoint loaded)
{'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'SAVING_DIR': './checkpoints/1/SmallAllCNN/cifar10/2_17', 'LOADED_MODEL': SmallAllCNN(
  (features): Sequential(
    (0): Conv(
      (0): Conv2d(3, 38, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (1): BatchNorm2d(38, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
    (1): Conv(
      (0): Conv2d(38, 76, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (1): BatchNorm2d(76, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
    (2): Conv(
      (0): Conv2d(76, 76, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (1): BatchNorm2d(76, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
    (3): AvgPool2d(kernel_size=16, stride=16, padding=0)
    (4): Flatten()
  )
  (classifier): Sequential(
    (0): Linear(in_features=76, out_features=10, bias=True)
  )
)}
server configured
Round 1: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m Client 6 / 10
[36m(ClientAppActor pid=1331908)[0m client calling
[36m(ClientAppActor pid=1331908)[0m client loading model
[36m(ClientAppActor pid=1331908)[0m loading data
[36m(ClientAppActor pid=1331908)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331934)[0m partition loaded
[36m(ClientAppActor pid=1331934)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m Client 8 / 10[32m [repeated 9x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=1331910)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038c47fe0>, len val=500, len test=500
[36m(ClientAppActor pid=1331934)[0m gpu in client
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14878 MiB, 66172 MiB
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331934)[0m Available devices  1
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0
[36m(ClientAppActor pid=1331934)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331934)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331934)[0m before loading model statdict
[36m(ClientAppActor pid=1331934)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m training started
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9d7d63f0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 23223 MiB, 57827 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_1.pth
[36m(ClientAppActor pid=1331910)[0m [Client 8] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331910)[0m partition loaded
[36m(ClientAppActor pid=1331910)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5d43770>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 29053 MiB, 51997 MiB
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331910)[0m Available devices  1
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0
[36m(ClientAppActor pid=1331910)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331910)[0m before loading model statdict
[36m(ClientAppActor pid=1331910)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 1 ACC is =  0.2286
round 1 loss is =  2.2657790184020996
Current best ACC is =  0.2286
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 2: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d4819fb60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 29474 MiB, 51576 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331934)[0m training started
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809c1d1ee0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 29814 MiB, 51236 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 4] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 2 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_2.pth
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f893ff82d20>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 29814 MiB, 51236 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 8] set_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331764)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa4d70>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd092a8950>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 2 ACC is =  0.1716
round 2 loss is =  2.2046992063522337
Round 3: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809c0b1dc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331934)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9d18fb00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 3 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_3.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914154980>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 3 ACC is =  0.2118
round 3 loss is =  2.102134108543396
Round 4: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140db950>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5bf7e30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_4.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391410b2f0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0a98c20>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccdbc13cbc0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 8] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 4 ACC is =  0.2468
round 4 loss is =  2.00633841753006
Current best ACC is =  0.2468
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 5: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfdac30>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534aef4cb90>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30686 MiB, 50364 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_5.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331907)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093ee6db0>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b17c04d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 5 ACC is =  0.2782
round 5 loss is =  1.911119294166565
Current best ACC is =  0.2782
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 6: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89300f8c50>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be55af0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_6.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m [Client 7] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093e9bbf0>, len val=500, len test=500
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 4 clients, 6 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 6 ACC is =  0.308
round 6 loss is =  1.8275118172168732
Current best ACC is =  0.308
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 7: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b356ca70>, len val=500, len test=500[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_7.pth
[36m(ClientAppActor pid=1331913)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b4044050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bf8bf50>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd092dda00>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 7 ACC is =  0.3456
round 7 loss is =  1.7730125546455384
Current best ACC is =  0.3456
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 8: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c406e420>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b41e1790>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_8.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914a9a9c0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 8 ACC is =  0.3714
round 8 loss is =  1.7379342317581177
Current best ACC is =  0.3714
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 9: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f02ff87080>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd092a98e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_9.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739145e72c0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09154380>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 9 ACC is =  0.3766
round 9 loss is =  1.698430097103119
Current best ACC is =  0.3766
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 10: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c10ac00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0aeee1e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30688 MiB, 50362 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 10 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_10.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be6ad80>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09293ad0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 10 ACC is =  0.357
round 10 loss is =  1.7338488459587098
Round 11: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0aeed370>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac016db0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_11.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331907)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093f9d670>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 11 ACC is =  0.394
round 11 loss is =  1.6591517395443387
Current best ACC is =  0.394
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 12: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927e654f0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331909)[0m training started
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a09ec3e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_12.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be6acf0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 12 ACC is =  0.4014
round 12 loss is =  1.6407892107963562
Current best ACC is =  0.4014
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 13: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c08b590>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d1da8620>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30692 MiB, 50358 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 13 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_13.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c08b530>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809c0eda30>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 13 ACC is =  0.3728
round 13 loss is =  1.6816129684448242
Round 14: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be4a570>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331764)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d1baf800>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 14 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_14.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093eb6b10>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927eec7a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 14 ACC is =  0.4236
round 14 loss is =  1.590369164943695
Current best ACC is =  0.4236
Saving round 14 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 15: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b65b804b90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd091dbb30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 15 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_15.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b1773380>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c10ac60>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 15 ACC is =  0.4046
round 15 loss is =  1.6089207530021667
Round 16: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391419fe30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331907)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d1c23aa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 16 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_16.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331907)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093e99b50>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 16 ACC is =  0.4093333333333333
round 16 loss is =  1.5954424407747057
Round 17: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391410b2f0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331913)[0m training started
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038cc8050>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 17 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_17.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1f6180>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 17 ACC is =  0.4204
round 17 loss is =  1.5902068614959717
Round 18: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09293f80>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89301b5a30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_18.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140909e0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1f46b0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 18 ACC is =  0.4392
round 18 loss is =  1.549329149723053
Current best ACC is =  0.4392
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 19: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0919ea20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331909)[0m training started
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8930a27a40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 19 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_19.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b17730e0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09291fd0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 19 ACC is =  0.4054
round 19 loss is =  1.6162558555603028
Round 20: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9ccdbc20>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c40b3230>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 20 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_20.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140db3b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 20 ACC is =  0.439
round 20 loss is =  1.5328658819198608
Round 21: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914006660>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5bf40e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 21 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_21.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331909)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093f9d280>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 21 ACC is =  0.4096
round 21 loss is =  1.6234466195106507
Round 22: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd093d9c40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac016e40>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded
[36m(ClientAppActor pid=1331907)[0m len partition= 5000
[36m(ClientAppActor pid=1331907)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 22 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_22.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739c8f4d850>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784039191550>, len val=500, len test=500
[36m(ClientAppActor pid=1331934)[0m gpu in client
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 22 ACC is =  0.484
round 22 loss is =  1.467282223701477
Current best ACC is =  0.484
Saving round 22 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 23: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081c61b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038c617f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 23 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_23.pth
[36m(ClientAppActor pid=1331911)[0m Client 8 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a09f0650>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x78403915a930>, len val=500, len test=500
[36m(ClientAppActor pid=1331934)[0m gpu in client
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331934)[0m Available devices  1
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331934)[0m before loading model statdict
[36m(ClientAppActor pid=1331934)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140db950>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 3] set_parameters[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 23 ACC is =  0.4144
round 23 loss is =  1.5844058871269227
Round 24: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809cda61b0>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 4] set_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331764)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6b8731850>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 24 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_24.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cdc0b30>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093e99370>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 24 ACC is =  0.4948
round 24 loss is =  1.4439173936843872
Current best ACC is =  0.4948
Saving round 24 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 25: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081c6d20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038c47fe0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30694 MiB, 50356 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 25 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_25.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331934)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081c7e30>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 25 ACC is =  0.4452
round 25 loss is =  1.5141191482543945
Round 26: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4a9d850>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840392e4380>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 26 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_26.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331907)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m partition loaded
[36m(ClientAppActor pid=1331910)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914091550>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 26 ACC is =  0.4652
round 26 loss is =  1.466101086139679
Round 27: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093fe61e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89300a7860>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 27 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_27.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cca8c80>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093f9cd10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 27 ACC is =  0.4662
round 27 loss is =  1.4640440821647644
Round 28: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bec7950>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 28 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_28.pth
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4ba1640>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914157320>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0ae760c0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 28 ACC is =  0.4946
round 28 loss is =  1.4172807455062866
Round 29: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd091cfb90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331909)[0m training started
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927e7ba10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 29 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_29.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331934)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bf8bb30>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0971a60>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 29 ACC is =  0.4882
round 29 loss is =  1.4251196265220643
Round 30: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093f35490>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9d18ce30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 30 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_30.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1332116)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m partition loaded
[36m(ClientAppActor pid=1331910)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5b62870>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331910)[0m Available devices  1
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 30 ACC is =  0.4812
round 30 loss is =  1.4438913345336915
Round 31: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4ba1640>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f02ff87050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 31 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_31.pth
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0a98c80>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331907)[0m training started
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739141784a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 31 ACC is =  0.507
round 31 loss is =  1.4009278893470765
Current best ACC is =  0.507
Saving round 31 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 32: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be69af0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b4061850>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 32 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_32.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331910)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739c8ffbf20>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cd951f0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 32 ACC is =  0.4956
round 32 loss is =  1.3999338746070862
Round 33: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77392002efc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038c275f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 33 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_33.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331934)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390800a7b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 33 ACC is =  0.5152
round 33 loss is =  1.364802598953247
Current best ACC is =  0.5152
Saving round 33 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 34: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b40d3770>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6df5aa2a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 34 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_34.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b1773440>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093eb6b10>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 34 ACC is =  0.5172
round 34 loss is =  1.3641613602638245
Current best ACC is =  0.5172
Saving round 34 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 35: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b40ef830>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0a98230>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 35 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_35.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331764)[0m partition loaded
[36m(ClientAppActor pid=1331764)[0m len partition= 5000
[36m(ClientAppActor pid=1331907)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d4a2a9df0>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331764)[0m Available devices  1
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331764)[0m before loading model statdict
[36m(ClientAppActor pid=1331764)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b17733e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 35 ACC is =  0.5082
round 35 loss is =  1.3634061932563781
Round 36: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331910)[0m partition loaded
[36m(ClientAppActor pid=1331910)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093ee63c0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89300f9280>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 36 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_36.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331910)[0m [Client 4] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09293f80>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 36 ACC is =  0.533
round 36 loss is =  1.3351410150527954
Current best ACC is =  0.533
Saving round 36 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 37: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd17f7eed0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6b87330b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 37 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_37.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b653f0fdd0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09399220>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331934)[0m before loading model statdict
[36m(ClientAppActor pid=1331934)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 37 ACC is =  0.5302
round 37 loss is =  1.3369274377822875
Round 38: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081c4050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f81441fec60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 38 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_38.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331909)[0m partition loaded
[36m(ClientAppActor pid=1331909)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b4061850>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c0ea630>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 38 ACC is =  0.5366
round 38 loss is =  1.3164738416671753
Current best ACC is =  0.5366
Saving round 38 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 39: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c074c50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d0181e20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 39 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_39.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809c0eff80>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b65017a810>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331910)[0m Available devices  1
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0
[36m(ClientAppActor pid=1331910)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331910)[0m before loading model statdict
[36m(ClientAppActor pid=1331910)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded
[36m(ClientAppActor pid=1331764)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a763f72ff0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 39 ACC is =  0.5196
round 39 loss is =  1.3452812910079956
Round 40: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331899)[0m client loading model
[36m(ClientAppActor pid=1331899)[0m loading data
[36m(ClientAppActor pid=1331899)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1c49e0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d4807e720>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331911)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b4076ed0>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 40 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_40.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m [Client 6] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bf8baa0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 40 ACC is =  0.5335555555555556
round 40 loss is =  1.313506179385715
Round 41: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331907)[0m training started
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac0168a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331907)[0m partition loaded
[36m(ClientAppActor pid=1331907)[0m len partition= 5000
Aggregating aggregate_fit updates from 2 clients, 8 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331909, ip=172.30.1.99, actor_id=636fcb173551027501320da401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7a6def70dbb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331909, ip=172.30.1.99, actor_id=636fcb173551027501320da401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7a6def70dbb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331909, ip=172.30.1.99, actor_id=636fcb173551027501320da401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7a6def70dbb0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1332116, ip=172.30.1.99, actor_id=d0f5abba6c7e0f44c3bee1df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71f043001bb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1332116, ip=172.30.1.99, actor_id=d0f5abba6c7e0f44c3bee1df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71f043001bb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1332116, ip=172.30.1.99, actor_id=d0f5abba6c7e0f44c3bee1df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71f043001bb0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 41 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_41.pth
[36m(ClientAppActor pid=1331913)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331913)[0m training started
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89300f9640>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m Client 8 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f03b50f650>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 41 ACC is =  0.4798
round 41 loss is =  1.427376127243042
Round 42: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c036750>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a76eb38da0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 42 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_42.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f038d5d3d0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49ba0e30>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331910)[0m before loading model statdict
[36m(ClientAppActor pid=1331910)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 42 ACC is =  0.5296
round 42 loss is =  1.320375180244446
Round 43: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c10a8d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b653f0fdd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 43 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_43.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809077a810>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840391c0860>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 43 ACC is =  0.5196
round 43 loss is =  1.349024736881256
Round 44: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b1773620>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x78409b52a150>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 44 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_44.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331934)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f03b50f650>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927f99580>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 44 ACC is =  0.5292
round 44 loss is =  1.2966004490852356
Round 45: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfd8860>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331907)[0m training started
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b65017b050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 45 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_45.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331910)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5b9c560>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 45 ACC is =  0.525
round 45 loss is =  1.3438488960266113
Round 46: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a77752cbc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b4197da0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331910)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 46 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_46.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927fb0380>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5b0c170>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 46 ACC is =  0.5616
round 46 loss is =  1.2499751448631287
Current best ACC is =  0.5616
Saving round 46 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 47: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Client 2 / 10
[36m(ClientAppActor pid=1331899)[0m client calling
[36m(ClientAppActor pid=1331899)[0m client loading model
[36m(ClientAppActor pid=1331899)[0m loading data
[36m(ClientAppActor pid=1331899)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331910)[0m training started
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b40f1370>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd080b8fe0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 2] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331764)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739145e7da0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 47 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_47.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391403d610>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89e570d970>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 47 ACC is =  0.5504
round 47 loss is =  1.2772771835327148
Round 48: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b17730e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927fb25a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 48 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_48.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331934)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cdfe5a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773921d11460>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 48 ACC is =  0.5562
round 48 loss is =  1.2498268365859986
Round 49: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391410b2f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4b4e660>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 49 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_49.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b356c9b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccdb0d775f0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 49 ACC is =  0.5506
round 49 loss is =  1.2725152611732482
Round 50: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.010000000000000002
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f892404f530>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f80907e1fa0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 50 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_50.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331908)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b356c9b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 50 ACC is =  0.5752
round 50 loss is =  1.2241106033325195
Current best ACC is =  0.5752
Saving round 50 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 51: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9d18fb00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd091559a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 51 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_51.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6de4182ff0>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89300f9910>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m partition loaded
[36m(ClientAppActor pid=1331907)[0m len partition= 5000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0ab20c0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 51 ACC is =  0.5718
round 51 loss is =  1.2299290418624877
Round 52: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331907)[0m partition loaded
[36m(ClientAppActor pid=1331907)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cdc0b30>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac0aa090>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331907)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m training started
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a763f730e0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 52 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_52.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331899)[0m Client 3 / 10
[36m(ClientAppActor pid=1331899)[0m client calling
[36m(ClientAppActor pid=1331899)[0m client loading model
[36m(ClientAppActor pid=1331899)[0m loading data
[36m(ClientAppActor pid=1331899)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c10a720>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f80907df1d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 52 ACC is =  0.579
round 52 loss is =  1.211735475063324
Current best ACC is =  0.579
Saving round 52 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 53: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1c5370>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331913)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840392a8e00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 53 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_53.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c0b26f0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49b4d6d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331910)[0m Available devices  1
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0
[36m(ClientAppActor pid=1331910)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331910)[0m before loading model statdict
[36m(ClientAppActor pid=1331910)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 53 ACC is =  0.5778
round 53 loss is =  1.212749981880188
Round 54: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89d2182ff0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 1] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331913)[0m training started
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d480e3dd0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30702 MiB, 50348 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 54 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_54.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331909)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71efa809e0c0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 54 ACC is =  0.581
round 54 loss is =  1.2058354258537292
Current best ACC is =  0.581
Saving round 54 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 55: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a77abfff20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0916d9a0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 10x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 55 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_55.pth
[36m(ClientAppActor pid=1331899)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0919da90>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cd951f0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 55 ACC is =  0.584
round 55 loss is =  1.2054028630256652
Current best ACC is =  0.584
Saving round 55 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 56: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1afaa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331907)[0m training started
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bf8b980>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 56 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_56.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0932db50>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809c0b3bc0>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 56 ACC is =  0.5818
round 56 loss is =  1.2028555393218994
Round 57: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa4290>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331764)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75354a1366c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 57 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_57.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cd26d20>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac0a9f70>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 57 ACC is =  0.5804
round 57 loss is =  1.202485203742981
Round 58: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0919e660>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 8] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331910)[0m training started
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c41f5f40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 58 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_58.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1af5c0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d3c9992b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 58 ACC is =  0.5834
round 58 loss is =  1.20120849609375
Round 59: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd092a9a00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 4] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331907)[0m training started
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d480de0f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 59 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_59.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331764)[0m partition loaded
[36m(ClientAppActor pid=1331764)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914154980>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 59 ACC is =  0.5834
round 59 loss is =  1.1989839315414428
Round 60: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4050650>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6de4183380>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30704 MiB, 50346 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331909)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 60 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_60.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331909)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739c55399a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 60 ACC is =  0.5844
round 60 loss is =  1.1977028012275697
Current best ACC is =  0.5844
Saving round 60 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 61: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331907)[0m training started
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac016e40>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b4076f00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 61 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_61.pth
[36m(ClientAppActor pid=1332116)[0m Client 3 / 10
[36m(ClientAppActor pid=1332116)[0m client calling
[36m(ClientAppActor pid=1332116)[0m client loading model
[36m(ClientAppActor pid=1332116)[0m loading data
[36m(ClientAppActor pid=1332116)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bec7350>, len val=500, len test=500
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c036ae0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 61 ACC is =  0.584
round 61 loss is =  1.1972830414772033
Round 62: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09399610>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4b37aa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 62 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_62.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c034680>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 62 ACC is =  0.5848
round 62 loss is =  1.1959212183952332
Current best ACC is =  0.5848
Saving round 62 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 63: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391410a930>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0bfa660>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 63 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_63.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9d7d63f0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5b9cd40>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331910)[0m Available devices  1
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0
[36m(ClientAppActor pid=1331910)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331910)[0m before loading model statdict
[36m(ClientAppActor pid=1331910)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 63 ACC is =  0.5838
round 63 loss is =  1.1955448508262634
Round 64: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331934)[0m training started
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840ded1b980>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331764)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d0010350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 64 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_64.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927fb1910>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 64 ACC is =  0.5854
round 64 loss is =  1.1929553270339965
Current best ACC is =  0.5854
Saving round 64 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 65: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038d8ab40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784039294e00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 65 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_65.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331934)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa7f80>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 65 ACC is =  0.5836
round 65 loss is =  1.1937459230422973
Round 66: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b40ee1b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038d8a510>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 66 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_66.pth
[36m(ClientAppActor pid=1331911)[0m Client 8 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=1331934)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cca87a0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 66 ACC is =  0.586
round 66 loss is =  1.1915050745010376
Current best ACC is =  0.586
Saving round 66 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 67: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093e984d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5bf6de0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 67 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_67.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331910)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac0a87a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 67 ACC is =  0.5856
round 67 loss is =  1.1913702607154846
Round 68: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cca8dd0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0bfa6c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 68 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_68.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa41d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd091559d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 68 ACC is =  0.5882
round 68 loss is =  1.1904658913612365
Current best ACC is =  0.5882
Saving round 68 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 69: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be6b4d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1332116)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f02ff86cf0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 69 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_69.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914091190>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 6 clients, 4 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 69 ACC is =  0.588
round 69 loss is =  1.1872124274571736
Round 70: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784039190fe0>, len val=500, len test=500[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 9] set_parameters[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331913)[0m training started
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6de1846b0>, len val=500, len test=500[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 5x across cluster][0m
Aggregating aggregate_fit updates from 6 clients, 4 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 70 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_70.pth
[36m(ClientAppActor pid=1331911)[0m Client 8 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331907)[0m [Client 7] get_parameters[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09399610>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 70 ACC is =  0.5876
round 70 loss is =  1.1893270850181579
Round 71: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081c6060>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f038d5d3d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 71 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_71.pth
[36m(ClientAppActor pid=1331911)[0m Client 8 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd092de960>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a094cec0>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 71 ACC is =  0.585
round 71 loss is =  1.1869885206222535
Round 72: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfd9190>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331909)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8930a26570>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 72 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_72.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccdb0d77230>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bec4080>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 72 ACC is =  0.5892
round 72 loss is =  1.1862683176994324
Current best ACC is =  0.5892
Saving round 72 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 73: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bf8bda0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8930aaea50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 73 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_73.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f02ff870b0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d4819de20>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331934)[0m Available devices  1
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0
[36m(ClientAppActor pid=1331934)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331934)[0m before loading model statdict
[36m(ClientAppActor pid=1331934)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 73 ACC is =  0.5858
round 73 loss is =  1.1851547002792358
Round 74: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081c6570>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331909)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a77752e9f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 74 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_74.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0af76a50>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 74 ACC is =  0.5876
round 74 loss is =  1.184933602809906
Round 75: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f043000b90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49cf1b20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 75 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_75.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1ad640>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d480696a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 75 ACC is =  0.5864
round 75 loss is =  1.1834888458251953
Round 76: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd092dd7c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840e23ffe30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 76 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_76.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cccffeb95e0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5c21cf2f0>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331910)[0m Available devices  1
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0
[36m(ClientAppActor pid=1331910)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331910)[0m before loading model statdict
[36m(ClientAppActor pid=1331910)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 76 ACC is =  0.587
round 76 loss is =  1.1838438153266906
Round 77: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391410b320>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840393c9760>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 77 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_77.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6de4183320>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391410b320>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 77 ACC is =  0.5886
round 77 loss is =  1.181625497341156
Round 78: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49bfd040>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331910)[0m training started
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d00b2420>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 78 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_78.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b17730e0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0ad0b080>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 78 ACC is =  0.5902
round 78 loss is =  1.1804136753082275
Current best ACC is =  0.5902
Saving round 78 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 79: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1f5790>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89241cdf40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 79 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_79.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331913)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b17730e0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d1d90590>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 79 ACC is =  0.5896
round 79 loss is =  1.1806554675102234
Round 80: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391419cf20>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1afc80>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 3 clients, 7 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331909, ip=172.30.1.99, actor_id=636fcb173551027501320da401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7a6def70dbb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331909, ip=172.30.1.99, actor_id=636fcb173551027501320da401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7a6def70dbb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331909, ip=172.30.1.99, actor_id=636fcb173551027501320da401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7a6def70dbb0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 80 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_80.pth
[36m(ClientAppActor pid=1331913)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89300f8740>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa4350>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 2] get_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 80 ACC is =  0.5882
round 80 loss is =  1.183607244491577
Round 81: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739141784a0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331910)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038ddec30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 81 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_81.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0af74c80>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c0e8f20>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 81 ACC is =  0.588
round 81 loss is =  1.1781821370124816
Round 82: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfd8200>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1332116)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cdc0b30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 82 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_82.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bec6e70>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 82 ACC is =  0.5868
round 82 loss is =  1.1791713118553162
Round 83: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331907)[0m training started
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0ab0260>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b65017b3e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 83 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_83.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bec54f0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0ad5e420>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 83 ACC is =  0.589
round 83 loss is =  1.176521611213684
Round 84: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bec45c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331907)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d481b8f20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 84 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_84.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331907)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093f9c980>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 84 ACC is =  0.5893333333333334
round 84 loss is =  1.1710132492913141
Round 85: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6de41834a0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331913)[0m training started
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840d41f7110>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 85 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_85.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331934)[0m [Client 1] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081d4d10>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 85 ACC is =  0.5916
round 85 loss is =  1.1746255517005921
Current best ACC is =  0.5916
Saving round 85 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 86: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfdaed0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038da1d90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 86 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_86.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331934)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331909)[0m partition loaded
[36m(ClientAppActor pid=1331909)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914a9a9c0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 86 ACC is =  0.5914
round 86 loss is =  1.1737146377563477
Round 87: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfd99a0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89300f8680>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 87 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_87.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331913)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49bfcdd0>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840d5749310>, len val=500, len test=500
[36m(ClientAppActor pid=1331934)[0m gpu in client
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 87 ACC is =  0.5902
round 87 loss is =  1.172970724105835
Round 88: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c0fbfe0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b65b804b90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 88 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_88.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331910)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49bffef0>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391412ffb0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 88 ACC is =  0.593
round 88 loss is =  1.1719695925712585
Current best ACC is =  0.593
Saving round 88 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 89: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa41d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x78403859b350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 89 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_89.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331934)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331909)[0m partition loaded
[36m(ClientAppActor pid=1331909)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9d7d63f0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 89 ACC is =  0.5882
round 89 loss is =  1.1722383737564086
Round 90: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f894b59a0c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331907)[0m training started
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d481eb2c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 90 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_90.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m [Client 5] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c10acf0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 90 ACC is =  0.591
round 90 loss is =  1.170320987701416
Round 91: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71efa81f6720>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927fb1040>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 91 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_91.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49bff3b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840393ee0f0>, len val=500, len test=500
[36m(ClientAppActor pid=1331934)[0m gpu in client
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331934)[0m Available devices  1
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0
[36m(ClientAppActor pid=1331934)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331934)[0m before loading model statdict
[36m(ClientAppActor pid=1331934)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 91 ACC is =  0.5882
round 91 loss is =  1.1704654097557068
Round 92: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfd8e00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d0010350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 92 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_92.pth
[36m(ClientAppActor pid=1331911)[0m Client 8 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140b80e0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0919c1a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 92 ACC is =  0.592
round 92 loss is =  1.1692602992057801
Round 93: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914154980>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1332116)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927f98860>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 93 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_93.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f0401e3e90>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840d41f71d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331934)[0m gpu in client
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 93 ACC is =  0.5938
round 93 loss is =  1.1680375337600708
Current best ACC is =  0.5938
Saving round 93 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_best.pth
Round 94: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49b4d6d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d00b0e90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 94 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_94.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331913)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89241cf9b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 94 ACC is =  0.5916
round 94 loss is =  1.1671067237854005
Round 95: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5bc7ad0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331764)[0m training started
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccdb0d773e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 95 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_95.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914091010>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 95 ACC is =  0.591
round 95 loss is =  1.1675225138664245
Round 96: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c0e98b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be48cb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 96 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_96.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331911)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914572000>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 96 ACC is =  0.592
round 96 loss is =  1.1650872588157655
Round 97: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038cf3530>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Client 1 / 10
[36m(ClientAppActor pid=1331899)[0m client calling
[36m(ClientAppActor pid=1331899)[0m client loading model
[36m(ClientAppActor pid=1331899)[0m loading data
[36m(ClientAppActor pid=1331899)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331934)[0m partition loaded
[36m(ClientAppActor pid=1331934)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331934)[0m training started
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfd9610>, len val=500, len test=500[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5d7a750>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 97 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_97.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331910)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f03b50c950>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 97 ACC is =  0.593
round 97 loss is =  1.1647287130355835
Round 98: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4ba09e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038c8c8f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 98 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_98.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331934)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809c1f7ec0>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 98 ACC is =  0.593
round 98 loss is =  1.1639039039611816
Round 99: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840391c0860>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331764)[0m training started
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d4807d6a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1332116, ip=172.30.1.99, actor_id=d0f5abba6c7e0f44c3bee1df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71f043001bb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1332116, ip=172.30.1.99, actor_id=d0f5abba6c7e0f44c3bee1df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71f043001bb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1332116, ip=172.30.1.99, actor_id=d0f5abba6c7e0f44c3bee1df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71f043001bb0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 99 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_99.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331910)[0m [Client 4] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d4819faa0>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 99 ACC is =  0.5926
round 99 loss is =  1.164252269268036
Round 100: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.0010000000000000002
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739141911c0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd080b9220>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 100 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_100.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c076930>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809cd22180>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 100 ACC is =  0.5918
round 100 loss is =  1.1626270055770873
Round 101: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739bcd33050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840d41f71a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 101 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_101.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cca91c0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8090142570>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 101 ACC is =  0.591
round 101 loss is =  1.1624197125434876
Round 102: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8087ffc260>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0919ff20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 102 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_102.pth
[36m(ClientAppActor pid=1331913)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c109e20>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093eb76b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 102 ACC is =  0.591
round 102 loss is =  1.1621246457099914
Round 103: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914975f10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 2] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0ae51f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 103 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_103.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534947cce90>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 103 ACC is =  0.5913333333333334
round 103 loss is =  1.1561305125554402
Round 104: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927fb1970>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89241cd1c0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 104 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_104.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331913)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cd951f0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 104 ACC is =  0.5898
round 104 loss is =  1.1619611024856566
Round 105: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f038d1cd10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b65017aff0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 105 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_105.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927edc050>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be544a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 105 ACC is =  0.5906
round 105 loss is =  1.1619450449943542
Round 106: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391419cf20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331913)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927eddb50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 106 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_106.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49c1a6f0>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773908199df0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 106 ACC is =  0.591
round 106 loss is =  1.1617622017860412
Round 107: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bf8bdd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840392a9fd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 107 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_107.pth
[36m(ClientAppActor pid=1331911)[0m Client 8 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914154980>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cdc0c80>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 107 ACC is =  0.5906
round 107 loss is =  1.1617945313453675
Round 108: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093f9cb90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331909)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d481bb4a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 108 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_108.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331909)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bf89e20>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4a9f740>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 108 ACC is =  0.5904
round 108 loss is =  1.161650812625885
Round 109: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 8 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd091dab40>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x78403920af60>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 3] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 109 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_109.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 5] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c08ad20>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f814fa968d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 109 ACC is =  0.591
round 109 loss is =  1.1618834733963013
Round 110: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739141796a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331913)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4ae6e10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 110 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_110.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c08a120>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391419d280>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 110 ACC is =  0.591
round 110 loss is =  1.1614909529685975
Round 111: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa5850>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927e7b230>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 111 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_111.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccdb0d775f0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0b604a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 111 ACC is =  0.5902
round 111 loss is =  1.1614903569221497
Round 112: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d3c068b60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0919d9d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 112 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_112.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c08b740>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927feac30>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 112 ACC is =  0.5908
round 112 loss is =  1.161308467388153
Round 113: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038dde7e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927eecda0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 113 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_113.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331899)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m partition loaded
[36m(ClientAppActor pid=1331909)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be55af0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 113 ACC is =  0.5904
round 113 loss is =  1.161312472820282
Round 114: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5b9c7a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331913)[0m training started
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840d5749310>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1332116, ip=172.30.1.99, actor_id=d0f5abba6c7e0f44c3bee1df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71f043001bb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1332116, ip=172.30.1.99, actor_id=d0f5abba6c7e0f44c3bee1df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71f043001bb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1332116, ip=172.30.1.99, actor_id=d0f5abba6c7e0f44c3bee1df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71f043001bb0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 114 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_114.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331899)[0m client loading model
[36m(ClientAppActor pid=1331899)[0m loading data
[36m(ClientAppActor pid=1331899)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m [Client 6] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d3c9dae10>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bec5130>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 114 ACC is =  0.5908
round 114 loss is =  1.1612471342086792
Round 115: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9d18e6f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773921d30920>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 115 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_115.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef900176e0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f81441fec90>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 115 ACC is =  0.5916
round 115 loss is =  1.1611441135406495
Round 116: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c0756d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331899)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c406d880>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 116 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_116.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be69cd0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccdbc13c950>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 116 ACC is =  0.5908
round 116 loss is =  1.1610050559043885
Round 117: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be6ac60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89301687d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 117 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_117.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9d84a0c0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bf8bd10>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0b532b10>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 117 ACC is =  0.5906
round 117 loss is =  1.1610261917114257
Round 118: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09399a00>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f80907dcb90>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d00b2270>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 118 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_118.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331908)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m partition loaded
[36m(ClientAppActor pid=1331764)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081d2ea0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 118 ACC is =  0.5912
round 118 loss is =  1.1608616709709167
Round 119: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038ddeb70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a09ec290>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 119 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_119.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331907)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391419d0d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 119 ACC is =  0.5908
round 119 loss is =  1.160732138156891
Round 120: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331764)[0m training started
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4ab9cd0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cca8b30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 120 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_120.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f893091e6f0>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa41d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 120 ACC is =  0.5912
round 120 loss is =  1.160678231716156
Round 121: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5caccb0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Client 7 / 10
[36m(ClientAppActor pid=1331899)[0m client calling
[36m(ClientAppActor pid=1331899)[0m client loading model
[36m(ClientAppActor pid=1331899)[0m loading data
[36m(ClientAppActor pid=1331899)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331910)[0m partition loaded
[36m(ClientAppActor pid=1331910)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331910)[0m training started
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739145e72c0>, len val=500, len test=500[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89300f8ec0>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 121 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_121.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331913)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0919c7d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f038d5d3d0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 121 ACC is =  0.5916
round 121 loss is =  1.1605953812599181
Round 122: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914975f10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840381ad010>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 122 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_122.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391419cf20>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9ccdbc20>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 122 ACC is =  0.5908
round 122 loss is =  1.1605314493179322
Round 123: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d00b18e0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391419cf20>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 123 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_123.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m [Client 3] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927eee030>, len val=500, len test=500
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 123 ACC is =  0.58175
round 123 loss is =  1.1753921210765839
Round 124: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739c611a000>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49cf1af0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 124 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_124.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391419cf20>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef90022d50>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 124 ACC is =  0.5914
round 124 loss is =  1.1602989196777345
Round 125: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa6930>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c406f230>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 125 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_125.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6de4183110>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914570fb0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b65017b170>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 125 ACC is =  0.591
round 125 loss is =  1.1601775884628296
Round 126: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331910)[0m training started
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927f99580>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331910)[0m Available devices  1
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0
[36m(ClientAppActor pid=1331910)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331910)[0m before loading model statdict
[36m(ClientAppActor pid=1331910)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331764)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c41f7b30>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 126 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_126.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f043141700>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 126 ACC is =  0.5912
round 126 loss is =  1.1602107167243958
Round 127: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914154980>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331907)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a09f27b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 127 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_127.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331934)[0m partition loaded
[36m(ClientAppActor pid=1331934)[0m len partition= 5000
[36m(ClientAppActor pid=1331907)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840393ee210>, len val=500, len test=500
[36m(ClientAppActor pid=1331934)[0m gpu in client
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331934)[0m Available devices  1
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0
[36m(ClientAppActor pid=1331934)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331934)[0m before loading model statdict
[36m(ClientAppActor pid=1331934)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 127 ACC is =  0.591
round 127 loss is =  1.1601006269454956
Round 128: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c406f860>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d1c23aa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 128 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_128.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m [Client 3] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71efa81f4260>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 128 ACC is =  0.591
round 128 loss is =  1.160036551952362
Round 129: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c0591c0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331907)[0m training started
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89e56cf8f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 129 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_129.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa4500>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b617e5d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331910)[0m Available devices  1
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0
[36m(ClientAppActor pid=1331910)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331910)[0m before loading model statdict
[36m(ClientAppActor pid=1331910)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 129 ACC is =  0.5914
round 129 loss is =  1.1599403738975524
Round 130: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081d6d50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331764)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5b9c9e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 130 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_130.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6de4183380>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd080afdd0>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 130 ACC is =  0.5914
round 130 loss is =  1.1598537683486938
Round 131: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd080af560>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b4195550>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 131 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_131.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cca8770>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bec4f20>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 131 ACC is =  0.5914
round 131 loss is =  1.1597720384597778
Round 132: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b17a8170>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5bf6810>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 132 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_132.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c0458e0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 132 ACC is =  0.5914
round 132 loss is =  1.1594947218894958
Round 133: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b40618e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0990dd0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331907)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 133 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_133.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1f50d0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 133 ACC is =  0.5912
round 133 loss is =  1.15959312915802
Round 134: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9ccdbc20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331907)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5bf68d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 134 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_134.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa5850>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09399a00>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 134 ACC is =  0.5918
round 134 loss is =  1.1594935536384583
Round 135: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0ba08c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5b0e150>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 135 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_135.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1332116)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331909)[0m partition loaded
[36m(ClientAppActor pid=1331909)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c047da0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 135 ACC is =  0.5912
round 135 loss is =  1.1594061732292176
Round 136: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be6bfb0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac2826c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 136 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_136.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331907)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b1773380>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd092a9c70>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 136 ACC is =  0.592
round 136 loss is =  1.1593807697296143
Round 137: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1f70b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa41d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 137 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_137.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331910)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140db3b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 7x across cluster][0m
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331910, ip=172.30.1.99, actor_id=1a37263390e9b47eadfae9e401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x73b65b805cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 137 ACC is =  0.5911111111111111
round 137 loss is =  1.1578811539544
Round 138: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f814753bfb0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 2] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d1d82c90>, len val=500, len test=500[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 8] set_parameters[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded
[36m(ClientAppActor pid=1331934)[0m len partition= 5000
[36m(ClientAppActor pid=1331934)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038599310>, len val=500, len test=500[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 7] set_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 4x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 138 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_138.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331934)[0m [Client 7] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09291c40>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 138 ACC is =  0.591
round 138 loss is =  1.1592249631881715
Round 139: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914178470>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89305fa1b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 139 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_139.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331913)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bf89f10>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1c48c0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 139 ACC is =  0.5904
round 139 loss is =  1.1591154217720032
Round 140: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be486e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d1c23aa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 140 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_140.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739bcd33050>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cdc1400>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 140 ACC is =  0.592
round 140 loss is =  1.158981442451477
Round 141: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739145e72c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331764)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d0013200>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 141 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_141.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m 
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391419cf20>, len val=500, len test=500
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd093db830>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 141 ACC is =  0.5914
round 141 loss is =  1.1589558124542236
Round 142: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd092a94c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m  
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m 90100
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840df00f890>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 142 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_142.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331934)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331909)[0m partition loaded
[36m(ClientAppActor pid=1331909)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f038d5d3d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 142 ACC is =  0.5918
round 142 loss is =  1.1588974237442016
Round 143: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b356ca70>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a763f730e0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 7] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cdc1400>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 143 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_143.pth
[36m(ClientAppActor pid=1332116)[0m Client 5 / 10
[36m(ClientAppActor pid=1332116)[0m client calling
[36m(ClientAppActor pid=1332116)[0m client loading model
[36m(ClientAppActor pid=1332116)[0m loading data
[36m(ClientAppActor pid=1332116)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7738fe9f67b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 143 ACC is =  0.5914
round 143 loss is =  1.1588180541992188
Round 144: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be6b650>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840381af2c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 144 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_144.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49ba0590>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89e56cf8f0>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded
[36m(ClientAppActor pid=1331764)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6b87d1310>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 144 ACC is =  0.592
round 144 loss is =  1.158665657043457
Round 145: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded
[36m(ClientAppActor pid=1331764)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c40b3800>, len val=500, len test=500
[36m(ClientAppActor pid=1331764)[0m gpu in client
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6dec0f2090>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331913)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m training started
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840d41f71a0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 145 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_145.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd091d8350>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac09f6e0>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 145 ACC is =  0.5918
round 145 loss is =  1.158591079711914
Round 146: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f899cd36150>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331764)[0m training started
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded
[36m(ClientAppActor pid=1331934)[0m len partition= 5000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840391e4f50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 146 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_146.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331934)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f899cd36150>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 146 ACC is =  0.5914
round 146 loss is =  1.158488392829895
Round 147: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a76cd6c830>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b59ffa7b90>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 147 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_147.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140daea0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 147 ACC is =  0.5914
round 147 loss is =  1.1584192752838134
Round 148: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140912b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038ddecc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 148 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_148.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49ba0ad0>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b4061850>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 148 ACC is =  0.5916
round 148 loss is =  1.1583478093147277
Round 149: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa4980>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1332116)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d1bc97c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 149 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_149.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331909)[0m partition loaded
[36m(ClientAppActor pid=1331909)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef90010ce0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6de617c650>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 149 ACC is =  0.5922
round 149 loss is =  1.158206307888031
Round 150: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.00010000000000000003
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be107a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927e7b800>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 150 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_150.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331913)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7738fe9f41a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccdb0d77230>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 150 ACC is =  0.5916
round 150 loss is =  1.1581672191619874
Round 151: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be69cd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d00b0fb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 151 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_151.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331911)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927f9a030>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 151 ACC is =  0.5916
round 151 loss is =  1.1581647992134094
Round 152: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0b5306e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49ba1130>, len val=500, len test=500[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331907)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927f9a0f0>, len val=500, len test=500[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 5x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 152 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_152.pth
[36m(ClientAppActor pid=1331913)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331913)[0m Available devices  1
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331913)[0m before loading model statdict
[36m(ClientAppActor pid=1331913)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331913)[0m training started
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739145c1670>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 152 ACC is =  0.5914
round 152 loss is =  1.1581530570983887
Round 153: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09291d30>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a76cd6c800>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 153 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_153.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b17730e0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0bfa6c0>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 153 ACC is =  0.5918
round 153 loss is =  1.1581238389015198
Round 154: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140919a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d481e8e90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 154 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_154.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331907)[0m partition loaded
[36m(ClientAppActor pid=1331907)[0m len partition= 5000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a09ec200>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d3c0e6930>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 154 ACC is =  0.5916
round 154 loss is =  1.1581282496452332
Round 155: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140546e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d00128a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 155 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_155.pth
[36m(ClientAppActor pid=1331911)[0m Client 8 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739c61ce3f0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1af5c0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 155 ACC is =  0.5916
round 155 loss is =  1.1581317067146302
Round 156: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d0010350>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331909)[0m training started
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccdb0d77080>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 156 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_156.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331909)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bf8b980>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 3 clients, 7 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331909, ip=172.30.1.99, actor_id=636fcb173551027501320da401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7a6def70dbb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331909, ip=172.30.1.99, actor_id=636fcb173551027501320da401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7a6def70dbb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331909, ip=172.30.1.99, actor_id=636fcb173551027501320da401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7a6def70dbb0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331908, ip=172.30.1.99, actor_id=6ce3e33270ac77fdad7e012101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f814fa95c70>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331934, ip=172.30.1.99, actor_id=e0566b799753b2ebc0b28fd601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7840ded1bc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 156 ACC is =  0.5853333333333334
round 156 loss is =  1.1747836271921794
Round 157: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914154980>, len val=500, len test=500[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 0] set_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6df5aa2a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 157 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_157.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8090737590>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49b4d6d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 157 ACC is =  0.5918
round 157 loss is =  1.1581313729286193
Round 158: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739145e5f10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d1d82c90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 158 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_158.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccdbc13c950>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f043000b90>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 158 ACC is =  0.592
round 158 loss is =  1.158125913143158
Round 159: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331909)[0m training started
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49b4d6d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5b0e0f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 159 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_159.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331910)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b1773410>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d481eaf30>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 159 ACC is =  0.592
round 159 loss is =  1.1581000685691833
Round 160: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391419fe30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534947961b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 160 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_160.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d4806a990>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140546e0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 160 ACC is =  0.5918
round 160 loss is =  1.1581197500228881
Round 161: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331909)[0m partition loaded
[36m(ClientAppActor pid=1331909)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded
[36m(ClientAppActor pid=1331764)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d00b0fb0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 2] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331909)[0m training started
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840397dd640>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 2] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1332116, ip=172.30.1.99, actor_id=d0f5abba6c7e0f44c3bee1df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71f043001bb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1332116, ip=172.30.1.99, actor_id=d0f5abba6c7e0f44c3bee1df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71f043001bb0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1332116, ip=172.30.1.99, actor_id=d0f5abba6c7e0f44c3bee1df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71f043001bb0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331913, ip=172.30.1.99, actor_id=179328241f9ec1f826d5717301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f89e570d6d0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 161 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_161.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331934)[0m [Client 2] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71efc0d204d0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 161 ACC is =  0.5916
round 161 loss is =  1.1581308722496033
Round 162: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f02ff86ed0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331934)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391410b2c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 162 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_162.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49bff350>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914091490>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 162 ACC is =  0.5918
round 162 loss is =  1.1581003189086914
Round 163: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f038d1cd10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331910)[0m training started
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49cf1af0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 163 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_163.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f893091eb70>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f0400eade0>, len val=500, len test=500
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 163 ACC is =  0.592
round 163 loss is =  1.1580825567245483
Round 164: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739145e5f10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784039190bc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 164 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_164.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331909)[0m partition loaded
[36m(ClientAppActor pid=1331909)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa4500>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef90023170>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 164 ACC is =  0.5922
round 164 loss is =  1.1580531597137451
Round 165: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391499fd10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d49ca0860>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 165 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_165.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331909)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cccfff57050>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 7x across cluster][0m
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 165 ACC is =  0.5931111111111111
round 165 loss is =  1.1522809002134535
Round 166: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d480696a0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac322600>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 166 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_166.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa5190>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1c4950>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 166 ACC is =  0.5924
round 166 loss is =  1.158046019077301
Round 167: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a09f1190>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1c53d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 167 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_167.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739080092e0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c0e8980>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 167 ACC is =  0.592
round 167 loss is =  1.1580572843551635
Round 168: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8090779520>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89dcdae090>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 168 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_168.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927edd9d0>, len val=500, len test=500
[36m(ClientAppActor pid=1331913)[0m gpu in client
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809c0387a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 168 ACC is =  0.592
round 168 loss is =  1.1580464363098144
Round 169: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809077b440>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89241eaa50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 169 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_169.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d480dff50>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0ad7da00>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 169 ACC is =  0.5918
round 169 loss is =  1.1580491065979004
Round 170: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140da690>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331910)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b40f3f20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 170 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_170.pth
[36m(ClientAppActor pid=1331911)[0m Client 8 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773908198e60>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331907, ip=172.30.1.99, actor_id=8b9ac3f8a7f95fa834bbb0bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7535555fdfd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 170 ACC is =  0.59
round 170 loss is =  1.1550015658140182
Round 171: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89300a5550>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d00b1220>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 4] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 171 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_171.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331909)[0m [Client 2] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d4ad12e70>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331909)[0m training started
[36m(ClientAppActor pid=1331909)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7738fe9f6d50>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 171 ACC is =  0.5922
round 171 loss is =  1.1580564260482789
Round 172: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be698b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5d78b60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 172 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_172.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331910)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4ae6870>, len val=500, len test=500
[36m(ClientAppActor pid=1331764)[0m gpu in client
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739145e72c0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 172 ACC is =  0.5918
round 172 loss is =  1.158046019077301
Round 173: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b17730e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4044350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 173 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_173.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331764)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd080bbc50>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 173 ACC is =  0.5918
round 173 loss is =  1.1580222368240356
Round 174: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89d2183170>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b41e32c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 174 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_174.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331910)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739145e77a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 174 ACC is =  0.592
round 174 loss is =  1.1580112814903258
Round 175: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b41ae360>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89309e9850>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 175 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_175.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331913)[0m [Client 3] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093f37950>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 175 ACC is =  0.5916
round 175 loss is =  1.1580222725868226
Round 176: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be4a660>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b40ef890>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 176 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_176.pth
[36m(ClientAppActor pid=1331911)[0m Client 6 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0bfb410>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f814574be90>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 176 ACC is =  0.5922
round 176 loss is =  1.1579987049102782
Round 177: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b403fc20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1afaa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 177 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_177.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfa7560>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cdc1400>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331910)[0m Available devices  1
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0
[36m(ClientAppActor pid=1331910)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331910)[0m before loading model statdict
[36m(ClientAppActor pid=1331910)[0m after loading model statdict
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 177 ACC is =  0.5926
round 177 loss is =  1.1579920649528503
Round 178: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b40d3cb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4ba0ad0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 178 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_178.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773980326630>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd093db830>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 178 ACC is =  0.5924
round 178 loss is =  1.1579725742340088
Round 179: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331764)[0m training started
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a763f730e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=1331934)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840391e4f50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 179 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_179.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331907)[0m partition loaded
[36m(ClientAppActor pid=1331907)[0m len partition= 5000
[36m(ClientAppActor pid=1331934)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0ab0d40>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f80907f8500>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 179 ACC is =  0.5922
round 179 loss is =  1.157938253879547
Round 180: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d0087950>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331764)[0m training started
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140daea0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 180 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_180.pth
[36m(ClientAppActor pid=1331911)[0m Client 0 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d00b22a0>, len val=500, len test=500
[36m(ClientAppActor pid=1331764)[0m gpu in client
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 180 ACC is =  0.5918
round 180 loss is =  1.1579759478569032
Round 181: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739145c1670>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038cf2c90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 181 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_181.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391410b320>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809cda61b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331908)[0m Available devices  1
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0
[36m(ClientAppActor pid=1331908)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=1331908)[0m before loading model statdict
[36m(ClientAppActor pid=1331908)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 181 ACC is =  0.5922
round 181 loss is =  1.1579570651054383
Round 182: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be4b9e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 2] get_parameters
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 182 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_182.pth
[36m(ClientAppActor pid=1331764)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4ba1220>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739145e7da0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71f038d1cd10>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 182 ACC is =  0.5926
round 182 loss is =  1.1579424262046814
Round 183: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bec4170>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093e984d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 183 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_183.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b41ac680>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd080ad910>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 183 ACC is =  0.5922
round 183 loss is =  1.1579206347465516
Round 184: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cccffeb9b80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cd951f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 184 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_184.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c10ac60>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038da0920>, len val=500, len test=500
[36m(ClientAppActor pid=1331934)[0m gpu in client
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 184 ACC is =  0.5918
round 184 loss is =  1.1579174041748046
Round 185: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927f9a030>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b403f1d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 185 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_185.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1332116)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m partition loaded
[36m(ClientAppActor pid=1331910)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m partition loaded
[36m(ClientAppActor pid=1331913)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b5d414c0>, len val=500, len test=500
[36m(ClientAppActor pid=1331910)[0m gpu in client
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331910)[0m Available devices  1
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0
[36m(ClientAppActor pid=1331910)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=1331910)[0m before loading model statdict
[36m(ClientAppActor pid=1331910)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 185 ACC is =  0.5918
round 185 loss is =  1.1579424142837524
Round 186: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c4ab8ec0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914154980>, len val=500, len test=500[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 7] set_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=1332116)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534ac016e40>, len val=500, len test=500[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 2] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 6x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331764, ip=172.30.1.99, actor_id=d7b846743908c5dea976776001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76a77752cc80>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 186 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_186.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m [Client 8] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccdbc13dd30>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140db950>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 186 ACC is =  0.592
round 186 loss is =  1.1579384803771973
Round 187: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9d2dd7f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89241ce330>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 187 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_187.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331913)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391499fd10>, len val=500, len test=500
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 187 ACC is =  0.5922
round 187 loss is =  1.1579065561294555
Round 188: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89dcdada30>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331907)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038da1fd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 188 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_188.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8093ee5010>, len val=500, len test=500
[36m(ClientAppActor pid=1331908)[0m gpu in client
[36m(ClientAppActor pid=1331908)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331908)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331908)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b356c9b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 188 ACC is =  0.5918
round 188 loss is =  1.1579129219055175
Round 189: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1ad1c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=1331910)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b65017aed0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 189 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_189.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331910)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739b1773380>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cd948c0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 189 ACC is =  0.5916
round 189 loss is =  1.1579149603843688
Round 190: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1332116)[0m training started
[36m(ClientAppActor pid=1332116)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c0fbe00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73b5b40778c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 190 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_190.pth
[36m(ClientAppActor pid=1331911)[0m Client 3 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=1331910)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1ad1c0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331899, ip=172.30.1.99, actor_id=83f10e14cc7e08fe762ff33801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ccdbc13c6e0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 190 ACC is =  0.5928888888888889
round 190 loss is =  1.1521352926890056
Round 191: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0ba3290>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840391c0860>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 191 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_191.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331934)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m partition loaded
[36m(ClientAppActor pid=1331907)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c10bda0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 191 ACC is =  0.5922
round 191 loss is =  1.1578948259353639
Round 192: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914154980>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7840391e5100>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 192 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_192.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914091550>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cca8f50>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 192 ACC is =  0.592
round 192 loss is =  1.1578807353973388
Round 193: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331907)[0m training started
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75353e176e70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331764)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6c40b2630>, len val=500, len test=500[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 193 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_193.pth
[36m(ClientAppActor pid=1331911)[0m Client 4 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=1331909)[0m partition loaded
[36m(ClientAppActor pid=1331909)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8930116b10>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x773914179670>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 193 ACC is =  0.592
round 193 loss is =  1.1578425288200378
Round 194: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0b51c5f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m 0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f89e56cfb90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 194 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_194.pth
[36m(ClientAppActor pid=1331911)[0m Client 1 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd09155a60>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331899)[0m Available devices  1
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0
[36m(ClientAppActor pid=1331899)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331899)[0m before loading model statdict
[36m(ClientAppActor pid=1331899)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cd951f0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 194 ACC is =  0.5922
round 194 loss is =  1.157834768295288
Round 195: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390bfdaf90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331913)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927f9a300>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 195 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_195.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1332116)[0m partition loaded
[36m(ClientAppActor pid=1332116)[0m len partition= 5000
[36m(ClientAppActor pid=1331913)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391419cf20>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 195 ACC is =  0.5926
round 195 loss is =  1.1578164219856262
Round 196: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76a6d00a01a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f8927e65f70>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 196 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_196.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331764)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9cca83b0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 196 ACC is =  0.5916
round 196 loss is =  1.1578473925590516
Round 197: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331913)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77390be55af0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038cf3620>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 197 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_197.pth
[36m(ClientAppActor pid=1331911)[0m Client 5 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=1331913)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77391499fd10>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0a9b740>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331907)[0m Available devices  1
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0
[36m(ClientAppActor pid=1331907)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=1331907)[0m before loading model statdict
[36m(ClientAppActor pid=1331907)[0m after loading model statdict
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 197 ACC is =  0.5926
round 197 loss is =  1.157801866531372
Round 198: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739081980b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 2] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331911)[0m training started
[36m(ClientAppActor pid=1331911)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331910)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331910)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784038ddcd40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 198 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_198.pth
[36m(ClientAppActor pid=1331911)[0m Client 2 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140db3b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71ef9c1f70b0>, len val=500, len test=500
[36m(ClientAppActor pid=1332116)[0m gpu in client
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1332116)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1332116)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1332116)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1332116)[0m Available devices  1
[36m(ClientAppActor pid=1332116)[0m Current cuda device  0
[36m(ClientAppActor pid=1332116)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=1332116)[0m before loading model statdict
[36m(ClientAppActor pid=1332116)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd080bbcb0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 4] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 7x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 198 ACC is =  0.5918
round 198 loss is =  1.1577965140342712
Round 199: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331899)[0m partition loaded
[36m(ClientAppActor pid=1331899)[0m len partition= 5000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331899)[0m training started
[36m(ClientAppActor pid=1331899)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331899)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7ccd0afa7800>, len val=500, len test=500
[36m(ClientAppActor pid=1331899)[0m gpu in client
[36m(ClientAppActor pid=1331899)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331899)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331899)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331899)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m [Client 0] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m after loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f809cda6570>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=1331934)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0ba0500>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 199 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_199.pth
[36m(ClientAppActor pid=1331911)[0m Client 7 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a09ce7b0>, len val=500, len test=500
[36m(ClientAppActor pid=1331907)[0m gpu in client
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d4ad12e70>, len val=500, len test=500
[36m(ClientAppActor pid=1331909)[0m gpu in client
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331909)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331909)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331909)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331909)[0m Available devices  1
[36m(ClientAppActor pid=1331909)[0m Current cuda device  0
[36m(ClientAppActor pid=1331909)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=1331909)[0m before loading model statdict
[36m(ClientAppActor pid=1331909)[0m after loading model statdict
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 199 ACC is =  0.5924
round 199 loss is =  1.1577713251113892
Round 200: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 1.0000000000000004e-05
[36m(ClientAppActor pid=1331899)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331899)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x71efa81f4260>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331934)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 3] fit, config: {'lr': 1.0000000000000004e-05, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=1331908)[0m training started
[36m(ClientAppActor pid=1331908)[0m number of epochs in this 2
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a6d480e13a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 7] fit, config: {'lr': 1.0000000000000004e-05, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=1331911, ip=172.30.1.99, actor_id=c2c0a42bcc416592348b5c7801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7739c5539be0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 200 aggregated_parameters...
Model saved to ./checkpoints/1/SmallAllCNN/cifar10/2_17/models_chkpts/model_round_200.pth
[36m(ClientAppActor pid=1331911)[0m Client 9 / 10
[36m(ClientAppActor pid=1331911)[0m client calling
[36m(ClientAppActor pid=1331911)[0m client loading model
[36m(ClientAppActor pid=1331911)[0m loading data
[36m(ClientAppActor pid=1331911)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=1331909)[0m [Client 9] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331911)[0m partition loaded
[36m(ClientAppActor pid=1331911)[0m len partition= 5000
[36m(ClientAppActor pid=1331908)[0m partition loaded
[36m(ClientAppActor pid=1331908)[0m len partition= 5000
[36m(ClientAppActor pid=1331911)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331911)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7739140da690>, len val=500, len test=500
[36m(ClientAppActor pid=1331911)[0m gpu in client
[36m(ClientAppActor pid=1331911)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=1331911)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=1331911)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=1331911)[0m cuda:0
[36m(ClientAppActor pid=1331911)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=1331911)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=1331911)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB
[36m(ClientAppActor pid=1331911)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=1331911)[0m Available devices  1
[36m(ClientAppActor pid=1331911)[0m Current cuda device  0
[36m(ClientAppActor pid=1331911)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=1331911)[0m before loading model statdict
[36m(ClientAppActor pid=1331911)[0m after loading model statdict
[36m(ClientAppActor pid=1331764)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331764)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1332116)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1332116)[0m cuda:0
[36m(ClientAppActor pid=1331908)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331908)[0m cuda:0
[36m(ClientAppActor pid=1331934)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331934)[0m cuda:0
[36m(ClientAppActor pid=1331910)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331910)[0m cuda:0
[36m(ClientAppActor pid=1331913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331913)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331899)[0m cuda:0
[36m(ClientAppActor pid=1331909)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331909)[0m cuda:0
[36m(ClientAppActor pid=1331764)[0m cuda:0
[36m(ClientAppActor pid=1331907)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=1331907)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 200 ACC is =  0.5918
round 200 loss is =  1.1578152537345887
[36m(ClientAppActor pid=1331909)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331909)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7534a0990350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'SmallAllCNN', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 30706 MiB, 50344 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=1331907)[0m after loading model statdict[32m [repeated 9x across cluster][0m
