model initiated
Using freshly initialized model (no checkpoint loaded)
{'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '20', 'CLIENT_RESOURCES_NUM_GPUS': '0.2', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'SAVING_DIR': './checkpoints/1/nf_resnet18/cifar10/1_17', 'LOADED_MODEL': NFResNet(
  (conv1): ScaledStdConv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)}
server configured
Round 1: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=299164)[0m Client 0 / 10
[36m(ClientAppActor pid=299164)[0m client calling
[36m(ClientAppActor pid=299163)[0m client loading model
[36m(ClientAppActor pid=299163)[0m loading data
[36m(ClientAppActor pid=299163)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=299163)[0m partition loaded
[36m(ClientAppActor pid=299163)[0m len partition= 5000
[36m(ClientAppActor pid=299160)[0m Client 3 / 10[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=299160)[0m client calling[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m client loading model[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m loading data[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m loading data completed, start partitioning for 3[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299163)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299163)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7403a955fb30>, len val=500, len test=500
[36m(ClientAppActor pid=299160)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299163)[0m gpu in client
[36m(ClientAppActor pid=299163)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=299163)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=299163)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '20', 'CLIENT_RESOURCES_NUM_GPUS': '0.2', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=299163)[0m cuda:0
[36m(ClientAppActor pid=299163)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=299163)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 906 MiB, 23311 MiB
[36m(ClientAppActor pid=299163)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14456 MiB, 66593 MiB
[36m(ClientAppActor pid=299163)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=299163)[0m Available devices  1
[36m(ClientAppActor pid=299163)[0m Current cuda device  0
[36m(ClientAppActor pid=299160)[0m cuda:0
[36m(ClientAppActor pid=299163)[0m [Client 1] fit, config: {'lr': '0.01', 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=299163)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=299163)[0m before loading model statdict
[36m(ClientAppActor pid=299163)[0m after loading model statdict
[36m(ClientAppActor pid=299163)[0m training started
[36m(ClientAppActor pid=299163)[0m number of epochs in this 2
[36m(ClientAppActor pid=299164)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299164)[0m cuda:0
[36m(ClientAppActor pid=299161)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299161)[0m cuda:0
[36m(ClientAppActor pid=299163)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=299161)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299163)[0m Client 4 / 10
[36m(ClientAppActor pid=299163)[0m client calling
[36m(ClientAppActor pid=299163)[0m client loading model
[36m(ClientAppActor pid=299163)[0m loading data
[36m(ClientAppActor pid=299163)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=299161)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75c794082420>, len val=500, len test=500[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '20', 'CLIENT_RESOURCES_NUM_GPUS': '0.2', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3829 MiB, 20388 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14456 MiB, 66593 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m Active CUDA Device: GPU 0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m Available devices  1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m Current cuda device  0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m [Client 2] fit, config: {'lr': '0.01', 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m [Client 2] set_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m after loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m training started[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m number of epochs in this 2[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m [Client 2] get_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=299161)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=299161)[0m Client 7 / 10[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m client calling[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m client loading model[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m loading data[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299161)[0m loading data completed, start partitioning for 7[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299160)[0m cuda:0
[36m(ClientAppActor pid=299161)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299161)[0m cuda:0
[36m(ClientAppActor pid=299164)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299164)[0m cuda:0
[36m(ClientAppActor pid=299163)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299163)[0m cuda:0
[36m(ClientAppActor pid=299163)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7403a9fe18b0>, len val=500, len test=500[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299163)[0m gpu in client[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299163)[0m __CUDNN VERSION: 90100[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299163)[0m __Number CUDA Devices: 1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299163)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '20', 'CLIENT_RESOURCES_NUM_GPUS': '0.2', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 5217 MiB, 19000 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14456 MiB, 66593 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m Active CUDA Device: GPU 0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m Available devices  1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m Current cuda device  0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m [Client 6] fit, config: {'lr': '0.01', 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m [Client 6] set_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m before loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m after loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m training started[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m number of epochs in this 2[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299164)[0m [Client 6] get_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299160)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299163)[0m Client 9 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=299163)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=299163)[0m client loading model[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=299163)[0m loading data[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=299163)[0m loading data completed, start partitioning for 9[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=299160)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299160)[0m cuda:0
[36m(ClientAppActor pid=299163)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299163)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7403a8b26720>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=299160)[0m gpu in client
[36m(ClientAppActor pid=299160)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=299160)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=299160)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '20', 'CLIENT_RESOURCES_NUM_GPUS': '0.2', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=299160)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=299160)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 5217 MiB, 19000 MiB
[36m(ClientAppActor pid=299160)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14456 MiB, 66593 MiB
[36m(ClientAppActor pid=299160)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=299160)[0m Available devices  1
[36m(ClientAppActor pid=299160)[0m Current cuda device  0
[36m(ClientAppActor pid=299160)[0m [Client 8] fit, config: {'lr': '0.01', 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=299160)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=299160)[0m before loading model statdict
[36m(ClientAppActor pid=299160)[0m after loading model statdict
[36m(ClientAppActor pid=299160)[0m training started
[36m(ClientAppActor pid=299160)[0m number of epochs in this 2
[36m(ClientAppActor pid=299163)[0m gpu in client
[36m(ClientAppActor pid=299163)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=299163)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=299163)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '20', 'CLIENT_RESOURCES_NUM_GPUS': '0.2', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=299163)[0m cuda:0
[36m(ClientAppActor pid=299163)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=299163)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 5217 MiB, 19000 MiB
[36m(ClientAppActor pid=299163)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14456 MiB, 66593 MiB
[36m(ClientAppActor pid=299163)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=299163)[0m Available devices  1
[36m(ClientAppActor pid=299163)[0m Current cuda device  0
[36m(ClientAppActor pid=299163)[0m [Client 9] fit, config: {'lr': '0.01', 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=299163)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=299163)[0m before loading model statdict
[36m(ClientAppActor pid=299163)[0m after loading model statdict
[36m(ClientAppActor pid=299163)[0m training started
[36m(ClientAppActor pid=299163)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/1_17/models_chkpts/model_round_1.pth
[36m(ClientAppActor pid=299163)[0m [Client 9] get_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=299163)[0m partition loaded
[36m(ClientAppActor pid=299163)[0m len partition= 5000
[36m(ClientAppActor pid=299161)[0m Client 2 / 10
[36m(ClientAppActor pid=299161)[0m client calling
[36m(ClientAppActor pid=299163)[0m Client 0 / 10
[36m(ClientAppActor pid=299163)[0m client calling
[36m(ClientAppActor pid=299161)[0m client loading model
[36m(ClientAppActor pid=299161)[0m loading data
[36m(ClientAppActor pid=299161)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=299161)[0m partition loaded
[36m(ClientAppActor pid=299161)[0m len partition= 5000
[36m(ClientAppActor pid=299161)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299161)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75c7880f1ac0>, len val=500, len test=500
[36m(ClientAppActor pid=299161)[0m gpu in client
[36m(ClientAppActor pid=299161)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=299161)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=299161)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '20', 'CLIENT_RESOURCES_NUM_GPUS': '0.2', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=299161)[0m cuda:0
[36m(ClientAppActor pid=299161)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=299161)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 5217 MiB, 19000 MiB
[36m(ClientAppActor pid=299161)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14456 MiB, 66593 MiB
[36m(ClientAppActor pid=299161)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=299161)[0m Available devices  1
[36m(ClientAppActor pid=299161)[0m Current cuda device  0
[36m(ClientAppActor pid=299161)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=299161)[0m before loading model statdict
[36m(ClientAppActor pid=299164)[0m Client 3 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=299164)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=299164)[0m client loading model[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299164)[0m loading data[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299164)[0m loading data completed, start partitioning for 3[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299163)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299163)[0m cuda:0
[36m(ClientAppActor pid=299163)[0m after loading model statdict
[36m(ClientAppActor pid=299164)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299164)[0m cuda:0
[36m(ClientAppActor pid=299160)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299160)[0m cuda:0
[36m(ClientAppActor pid=299163)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299163)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299163)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299163)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7403b40bed50>, len val=500, len test=500[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299160)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '20', 'CLIENT_RESOURCES_NUM_GPUS': '0.2', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 5217 MiB, 19000 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14456 MiB, 66593 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m Active CUDA Device: GPU 0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m Available devices  1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m Current cuda device  0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m [Client 1] set_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299160)[0m Client 7 / 10[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299160)[0m client calling[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299160)[0m client loading model[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299160)[0m loading data[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299160)[0m loading data completed, start partitioning for 7[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299160)[0m after loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=299163)[0m cuda:0
[36m(ClientAppActor pid=299160)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299160)[0m cuda:0
[36m(ClientAppActor pid=299161)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299161)[0m cuda:0
[36m(ClientAppActor pid=299164)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299164)[0m cuda:0
[36m(ClientAppActor pid=299163)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299163)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299163)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=299163)[0m cuda:0
[36m(ClientAppActor pid=299163)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7403a8128410>, len val=500, len test=500[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=299163)[0m gpu in client[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=299163)[0m __CUDNN VERSION: 90100[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=299163)[0m __Number CUDA Devices: 1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=299163)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '1', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '20', 'CLIENT_RESOURCES_NUM_GPUS': '0.2', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '5,8,9', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=299163)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=299163)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 5217 MiB, 19000 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=299163)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14456 MiB, 66593 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=299163)[0m Active CUDA Device: GPU 0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=299163)[0m Available devices  1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=299163)[0m Current cuda device  0[32m [repeated 5x across cluster][0m
