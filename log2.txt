model initiated
Using freshly initialized model (no checkpoint loaded)
{'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'SAVING_DIR': './checkpoints/1/nf_resnet18/cifar10/2_17', 'LOADED_MODEL': NFResNet(
  (conv1): ScaledStdConv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)}
server configured
Round 1: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561206)[0m Client 8 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 9 / 10[32m [repeated 9x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb80ea80>, len val=500, len test=500
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14974 MiB, 66076 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561210)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m training started
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef7918d7c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 21756 MiB, 59294 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_1.pth
[36m(ClientAppActor pid=561208)[0m Client 2 / 10
[36m(ClientAppActor pid=561208)[0m client calling
[36m(ClientAppActor pid=561913)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d2787a8d10>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 1 ACC is =  0.1732
round 1 loss is =  5.501452207565308
Current best ACC is =  0.1732
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 2: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9de4620>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f017547080>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 2 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_2.pth
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f54881a40e0>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 2 ACC is =  0.1654
round 2 loss is =  3.4349398851394652
Round 3: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50812bc500>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7ed760>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561913)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a3d88c80>, len val=500, len test=500
[36m(ClientAppActor pid=561913)[0m gpu in client
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561913)[0m Available devices  1
[36m(ClientAppActor pid=561913)[0m Current cuda device  0
[36m(ClientAppActor pid=561913)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561913)[0m before loading model statdict
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 3 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_3.pth
[36m(ClientAppActor pid=561204)[0m Client 3 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561913)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969008d250>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m gpu in client
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561913)[0m Available devices  1
[36m(ClientAppActor pid=561913)[0m Current cuda device  0
[36m(ClientAppActor pid=561913)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561913)[0m before loading model statdict
[36m(ClientAppActor pid=561913)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 3 ACC is =  0.229
round 3 loss is =  2.1308282136917116
Current best ACC is =  0.229
Saving round 3 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 4: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Client 4 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561204)[0m Client 3 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7693617771d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c60584680>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_4.pth
[36m(ClientAppActor pid=561204)[0m Client 0 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77968419c380>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 4 ACC is =  0.2744
round 4 loss is =  1.9231644034385682
Current best ACC is =  0.2744
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 5: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 3 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5081290680>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c99f8f0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78cab7a0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m gpu in client
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c2d10170>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_5.pth
[36m(ClientAppActor pid=561211)[0m Client 0 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561210)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0197f2c0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m before loading model statdict
[36m(ClientAppActor pid=561211)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 5 ACC is =  0.3504
round 5 loss is =  1.7745529055595397
Current best ACC is =  0.3504
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 6: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Client 0 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561208)[0m Client 2 / 10
[36m(ClientAppActor pid=561208)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78dbcda0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969018ce00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_6.pth
[36m(ClientAppActor pid=561209)[0m Client 5 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561204)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0f7fb9b0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 6 ACC is =  0.3892
round 6 loss is =  1.652667474746704
Current best ACC is =  0.3892
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 7: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x771a641735c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969008c5f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_7.pth
[36m(ClientAppActor pid=561204)[0m Client 1 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561208)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a3fe8aa0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 7 ACC is =  0.4256
round 7 loss is =  1.5837892770767212
Current best ACC is =  0.4256
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 8: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f01ebd3590>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53dcb97c80>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_8.pth
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561913)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbcee10>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561202)[0m before loading model statdict
[36m(ClientAppActor pid=561202)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 8 ACC is =  0.4436
round 8 loss is =  1.5093702912330627
Current best ACC is =  0.4436
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 9: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9da0590>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m training started
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687fd9640>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9f1a90>, len val=500, len test=500
[36m(ClientAppActor pid=561202)[0m gpu in client
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561202)[0m Available devices  1
[36m(ClientAppActor pid=561202)[0m Current cuda device  0
[36m(ClientAppActor pid=561202)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561202)[0m before loading model statdict
[36m(ClientAppActor pid=561202)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m training started
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_9.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617a7470>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 9 ACC is =  0.4608
round 9 loss is =  1.484696638584137
Current best ACC is =  0.4608
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 10: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Client 4 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561211)[0m Client 1 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508118bbf0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m training started
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969053b830>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 10 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_10.pth
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f41d0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 10 ACC is =  0.4738
round 10 loss is =  1.460586929321289
Current best ACC is =  0.4738
Saving round 10 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 11: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 0 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddce8980>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d2782e22d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_11.pth
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561208)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c61707f80>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 11 ACC is =  0.4904
round 11 loss is =  1.4193724155426026
Current best ACC is =  0.4904
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 12: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m Client 2 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561208)[0m Client 7 / 10
[36m(ClientAppActor pid=561208)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5080b6ff20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddd79250>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a511e153050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_12.pth
[36m(ClientAppActor pid=561201)[0m Client 0 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model
[36m(ClientAppActor pid=561201)[0m loading data
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d080af950>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 12 ACC is =  0.5058
round 12 loss is =  1.3775385737419128
Current best ACC is =  0.5058
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 13: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000cbb8dd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ba8620>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 13 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_13.pth
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c60584680>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 13 ACC is =  0.5198
round 13 loss is =  1.3447165966033936
Current best ACC is =  0.5198
Saving round 13 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 14: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m Client 1 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687f87bc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78b0a9f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 14 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_14.pth
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77968415bd40>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 14 ACC is =  0.507
round 14 loss is =  1.377931332588196
Round 15: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Client 8 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a0000777e60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f0140c3020>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 15 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_15.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0197f440>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 15 ACC is =  0.5232
round 15 loss is =  1.3351199626922607
Current best ACC is =  0.5232
Saving round 15 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 16: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 9 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c116c290>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c61707aa0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddb8d190>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ca85f0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 16 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_16.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617d8920>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 16 ACC is =  0.5422
round 16 loss is =  1.2707043528556823
Current best ACC is =  0.5422
Saving round 16 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 17: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m Client 0 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561913)[0m Client 6 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbdcb90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619a4a70>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53dcb95c10>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78d72e10>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 17 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_17.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561211)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f54881c0470>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 17 ACC is =  0.557
round 17 loss is =  1.2504104614257812
Current best ACC is =  0.557
Saving round 17 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 18: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 7 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c633899a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef79292690>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_18.pth
[36m(ClientAppActor pid=561206)[0m Client 5 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model
[36m(ClientAppActor pid=561208)[0m loading data
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53df8d92e0>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 18 ACC is =  0.5692
round 18 loss is =  1.2170000791549682
Current best ACC is =  0.5692
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 19: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m Client 5 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78d06f60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7988c0>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7797397d8d10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 19 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_19.pth
[36m(ClientAppActor pid=561211)[0m Client 6 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561208)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687fc38f0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 19 ACC is =  0.573
round 19 loss is =  1.21866295337677
Current best ACC is =  0.573
Saving round 19 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 20: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 6 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769368109850>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2ac0797f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 20 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_20.pth
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client loading model
[36m(ClientAppActor pid=561210)[0m loading data
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7efcb0>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 20 ACC is =  0.5746
round 20 loss is =  1.1929526686668397
Current best ACC is =  0.5746
Saving round 20 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 21: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 7 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78c701d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969008d040>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 21 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_21.pth
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f5488173440>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 21 ACC is =  0.581
round 21 loss is =  1.1833031058311463
Current best ACC is =  0.581
Saving round 21 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 22: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76936caffe60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c13f9c10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 22 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_22.pth
[36m(ClientAppActor pid=561204)[0m Client 4 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561211)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f7020>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 22 ACC is =  0.594
round 22 loss is =  1.1456918954849242
Current best ACC is =  0.594
Saving round 22 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 23: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 6 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9d8cb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561202)[0m training started
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796901a0cb0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 23 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_23.pth
[36m(ClientAppActor pid=561209)[0m Client 5 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddd0aff0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m gpu in client
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 23 ACC is =  0.6008
round 23 loss is =  1.1376073122024537
Current best ACC is =  0.6008
Saving round 23 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 24: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000cbfbe90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508125c140>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 24 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_24.pth
[36m(ClientAppActor pid=561206)[0m Client 2 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5081293bf0>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 24 ACC is =  0.5958
round 24 loss is =  1.163725447654724
Round 25: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a389e450>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 8 / 10[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddb8ef90>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 25 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_25.pth
[36m(ClientAppActor pid=561204)[0m Client 0 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561201)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779690040410>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 25 ACC is =  0.6074
round 25 loss is =  1.1278446674346925
Current best ACC is =  0.6074
Saving round 25 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 26: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 2 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78d72de0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbddb50>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5081188860>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x771a735a3dd0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 26 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_26.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561913)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617d9c10>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 26 ACC is =  0.6152
round 26 loss is =  1.1026298999786377
Current best ACC is =  0.6152
Saving round 26 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 27: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Client 1 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561201)[0m Client 3 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7693617773b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508118b710>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 27 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_27.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561201)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb8b6000>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 27 ACC is =  0.6238
round 27 loss is =  1.0742725551128387
Current best ACC is =  0.6238
Saving round 27 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 28: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 6 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d31ed10440>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12dd6d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 28 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_28.pth
[36m(ClientAppActor pid=561203)[0m Client 7 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617a7620>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 28 ACC is =  0.633
round 28 loss is =  1.0693444609642029
Current best ACC is =  0.633
Saving round 28 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 29: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Client 5 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c134c440>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12df950>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 29 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_29.pth
[36m(ClientAppActor pid=561204)[0m Client 5 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561211)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x771a64173350>, len val=500, len test=500
[36m(ClientAppActor pid=561211)[0m gpu in client
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561211)[0m Available devices  1
[36m(ClientAppActor pid=561211)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561211)[0m before loading model statdict
[36m(ClientAppActor pid=561211)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 29 ACC is =  0.62
round 29 loss is =  1.0965808391571046
Round 30: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Client 6 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a38dfce0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508173ecf0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 30 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_30.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561201)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c633d5880>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 30 ACC is =  0.627
round 30 loss is =  1.089184683561325
Round 31: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f01611b0e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000cbb8e30>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 31 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_31.pth
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561201)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619449b0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 31 ACC is =  0.6266
round 31 loss is =  1.0843093514442443
Round 32: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12a59d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb798980>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 32 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_32.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561208)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50811c4080>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 32 ACC is =  0.6368
round 32 loss is =  1.0536719381809234
Current best ACC is =  0.6368
Saving round 32 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 33: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 3 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561210)[0m client loading model
[36m(ClientAppActor pid=561210)[0m loading data
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000caa8950>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddb9d100>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508125e8d0>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a00ab583110>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 33 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_33.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561208)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f5c10>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561913)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 33 ACC is =  0.6498
round 33 loss is =  1.0272047162055968
Current best ACC is =  0.6498
Saving round 33 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 34: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12ec140>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b8b6bcb0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561210)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 34 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_34.pth
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561210)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7797397d8d10>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 34 ACC is =  0.6436
round 34 loss is =  1.0431010901927948
Round 35: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Client 3 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561210)[0m Client 0 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c1398890>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a00bf2cfef0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 35 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_35.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbde210>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 35 ACC is =  0.6548
round 35 loss is =  1.021684068441391
Current best ACC is =  0.6548
Saving round 35 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 36: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m Client 8 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d31e25bb90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561208)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617a5d60>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m gpu in client
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561201)[0m Available devices  1
[36m(ClientAppActor pid=561201)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c2db0da0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 36 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_36.pth
[36m(ClientAppActor pid=561204)[0m Client 6 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561208)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53df7ea9f0>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 36 ACC is =  0.6498
round 36 loss is =  1.0432248651981353
Round 37: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 6 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 6[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c618a8830>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78183bf0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 37 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_37.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561208)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779684175280>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 37 ACC is =  0.6492
round 37 loss is =  1.035979014635086
Round 38: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 0 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78183b60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de35d24ff20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 38 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_38.pth
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561202)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53f6185e50>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 38 ACC is =  0.6684
round 38 loss is =  1.0148314893245698
Current best ACC is =  0.6684
Saving round 38 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 39: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 8 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ca8ef0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77974172dca0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 39 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_39.pth
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f5fd0>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m gpu in client
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 39 ACC is =  0.6736
round 39 loss is =  0.9779532372951507
Current best ACC is =  0.6736
Saving round 39 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 40: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Client 3 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561913)[0m Client 0 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12f3fe0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12ed820>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 40 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_40.pth
[36m(ClientAppActor pid=561913)[0m Client 0 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561211)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5080b89790>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 40 ACC is =  0.6794
round 40 loss is =  0.9885640323162079
Current best ACC is =  0.6794
Saving round 40 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 41: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef785bf7a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a0003f751f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 41 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_41.pth
[36m(ClientAppActor pid=561206)[0m Client 3 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5080b6f410>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 41 ACC is =  0.6722
round 41 loss is =  1.0121829092502594
Round 42: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 6 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78bef2f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12df230>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 42 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_42.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561204)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client loading model
[36m(ClientAppActor pid=561210)[0m loading data
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b8bce0f0>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 42 ACC is =  0.6762
round 42 loss is =  1.0288903772830964
Round 43: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 5 / 10[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000ca70290>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 4 / 10[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78183f50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 43 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_43.pth
[36m(ClientAppActor pid=561201)[0m Client 0 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561201)[0m client loading model
[36m(ClientAppActor pid=561201)[0m loading data
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561201)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5081189970>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 43 ACC is =  0.6676
round 43 loss is =  1.0332831621170044
Round 44: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m Client 1 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000caa8980>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d26c96fe90>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 44 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_44.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561208)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f4770>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 44 ACC is =  0.663
round 44 loss is =  1.1018695116043091
Round 45: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Client 6 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ca8a40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561210)[0m training started
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c129a120>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 45 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_45.pth
[36m(ClientAppActor pid=561203)[0m Client 1 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbdd850>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 45 ACC is =  0.6732
round 45 loss is =  1.0093244433403015
Round 46: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c905a90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c116fe00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 46 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_46.pth
[36m(ClientAppActor pid=561209)[0m Client 5 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561211)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687f875f0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 46 ACC is =  0.6838
round 46 loss is =  1.0396871030330659
Current best ACC is =  0.6838
Saving round 46 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 47: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Client 1 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561913)[0m Client 3 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c0198830>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687f84fe0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561210)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769361777200>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 47 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_47.pth
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687f87d10>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 47 ACC is =  0.6792
round 47 loss is =  1.010215550661087
Round 48: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 5 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 0 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddb8f110>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb798b00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 48 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_48.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561210)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0c10dc10>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 48 ACC is =  0.689
round 48 loss is =  1.0248911559581757
Current best ACC is =  0.689
Saving round 48 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 49: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Client 7 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561202)[0m Client 1 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ca8aa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78baad50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 49 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_49.pth
[36m(ClientAppActor pid=561201)[0m Client 1 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model
[36m(ClientAppActor pid=561201)[0m loading data
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c6059e330>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m gpu in client
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561201)[0m Available devices  1
[36m(ClientAppActor pid=561201)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561201)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 49 ACC is =  0.6926
round 49 loss is =  1.0310816824436189
Current best ACC is =  0.6926
Saving round 49 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 50: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.010000000000000002
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50807c5a90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c618a8890>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d2783edc10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 50 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_50.pth
[36m(ClientAppActor pid=561203)[0m Client 8 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model
[36m(ClientAppActor pid=561201)[0m loading data
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78d24290>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 50 ACC is =  0.6956
round 50 loss is =  0.986249440908432
Current best ACC is =  0.6956
Saving round 50 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 51: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 7 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619a4a70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7ed850>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 51 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_51.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619449b0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 51 ACC is =  0.7002
round 51 loss is =  0.9821506977081299
Current best ACC is =  0.7002
Saving round 51 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 52: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Client 4 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561211)[0m Client 1 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d30bf72ff0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78da86b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 52 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_52.pth
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561201)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a3e81d00>, len val=500, len test=500
[36m(ClientAppActor pid=561913)[0m gpu in client
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 52 ACC is =  0.6982
round 52 loss is =  0.9863104283809662
Round 53: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561204)[0m Client 4 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d27829b380>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12edd00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 53 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_53.pth
[36m(ClientAppActor pid=561206)[0m Client 7 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561201)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c61870350>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 53 ACC is =  0.701
round 53 loss is =  0.9883223354816437
Current best ACC is =  0.701
Saving round 53 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 54: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7edca0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7985f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 54 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_54.pth
[36m(ClientAppActor pid=561206)[0m Client 8 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561211)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7edca0>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 54 ACC is =  0.6994
round 54 loss is =  0.993309086561203
Round 55: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508125e8d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9da2cf0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 55 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_55.pth
[36m(ClientAppActor pid=561913)[0m Client 5 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddb8f2f0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 55 ACC is =  0.7006
round 55 loss is =  0.9952247202396393
Round 56: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78bf9550>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78bf9d30>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 56 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_56.pth
[36m(ClientAppActor pid=561210)[0m Client 0 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561210)[0m client loading model
[36m(ClientAppActor pid=561210)[0m loading data
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561210)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b8b699d0>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561201)[0m Available devices  1
[36m(ClientAppActor pid=561201)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 56 ACC is =  0.6998
round 56 loss is =  0.9994685351848602
Round 57: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c1399190>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a00bf2cfef0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 57 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_57.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561204)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d314d6c530>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 57 ACC is =  0.7006
round 57 loss is =  1.002351850271225
Round 58: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 6 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0197f350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a0003e56de0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 58 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_58.pth
[36m(ClientAppActor pid=561204)[0m Client 1 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561202)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796841772f0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 58 ACC is =  0.7006
round 58 loss is =  1.0051860094070435
Round 59: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 8 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m client loading model
[36m(ClientAppActor pid=561201)[0m loading data
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de34cd82ba0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m training started
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508130ef90>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 59 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_59.pth
[36m(ClientAppActor pid=561211)[0m Client 1 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c33c5fd0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 59 ACC is =  0.7002
round 59 loss is =  1.008720737695694
Round 60: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Client 0 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561210)[0m Client 1 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7ef7d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d2782980b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 60 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_60.pth
[36m(ClientAppActor pid=561913)[0m Client 5 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617d8fb0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m before loading model statdict
[36m(ClientAppActor pid=561913)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 60 ACC is =  0.7012
round 60 loss is =  1.0117349803447724
Current best ACC is =  0.7012
Saving round 60 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 61: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Client 2 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561204)[0m Client 7 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12ec050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb9af650>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561210)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 61 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_61.pth
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796909f19d0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 61 ACC is =  0.7
round 61 loss is =  1.0150916695594787
Round 62: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508118bbf0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5080b6ffe0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 62 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_62.pth
[36m(ClientAppActor pid=561210)[0m Client 8 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c60587ec0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 62 ACC is =  0.7004
round 62 loss is =  1.017708683013916
Round 63: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 7 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78183b60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m training started
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78befd70>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 63 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_63.pth
[36m(ClientAppActor pid=561201)[0m Client 1 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561204)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796909f19d0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 63 ACC is =  0.6996
round 63 loss is =  1.0210031270980835
Round 64: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d26c98cfe0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef7853d9d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 64 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_64.pth
[36m(ClientAppActor pid=561211)[0m Client 4 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561204)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b8b9dbb0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m after loading model statdict
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 64 ACC is =  0.7002
round 64 loss is =  1.0250126123428345
Round 65: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 1 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78183b60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7693705ffaa0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 65 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_65.pth
[36m(ClientAppActor pid=561913)[0m Client 0 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561913)[0m partition loaded
[36m(ClientAppActor pid=561913)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a3eb7470>, len val=500, len test=500
[36m(ClientAppActor pid=561913)[0m gpu in client
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561913)[0m Available devices  1
[36m(ClientAppActor pid=561913)[0m Current cuda device  0
[36m(ClientAppActor pid=561913)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561913)[0m before loading model statdict
[36m(ClientAppActor pid=561913)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 65 ACC is =  0.7
round 65 loss is =  1.0274887442588807
Round 66: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78dbdeb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m Client 8 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef781afdd0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 66 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_66.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561201)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c618a8e30>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 66 ACC is =  0.7006
round 66 loss is =  1.0312212526798248
Round 67: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m Client 8 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 2 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef781bd9a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561202)[0m training started
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c1399190>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 4] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561211)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5080b6c8f0>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m [Client 1] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 67 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_67.pth
[36m(ClientAppActor pid=561913)[0m Client 2 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d27828b3b0>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561211)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 67 ACC is =  0.7004
round 67 loss is =  1.0338796079158783
Round 68: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78bed100>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508130e660>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 68 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_68.pth
[36m(ClientAppActor pid=561202)[0m Client 1 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508d748b30>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 68 ACC is =  0.7
round 68 loss is =  1.0376326620578766
Round 69: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78bfbf80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78b0af90>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 69 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_69.pth
[36m(ClientAppActor pid=561201)[0m Client 0 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model
[36m(ClientAppActor pid=561201)[0m loading data
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbdd160>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561201)[0m Available devices  1
[36m(ClientAppActor pid=561201)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561201)[0m before loading model statdict
[36m(ClientAppActor pid=561201)[0m after loading model statdict
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 69 ACC is =  0.7002
round 69 loss is =  1.0404512524604796
Round 70: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb80f350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c129bda0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561211)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561211)[0m Available devices  1
[36m(ClientAppActor pid=561211)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561211)[0m before loading model statdict
[36m(ClientAppActor pid=561211)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 70 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_70.pth
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c01b30e0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 70 ACC is =  0.7012
round 70 loss is =  1.0441631197929382
Round 71: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d278299220>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a00bfc4da90>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 71 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_71.pth
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c61705ac0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 71 ACC is =  0.7006
round 71 loss is =  1.0463574588298798
Round 72: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000caa81d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12a59d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 72 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_72.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f5488173470>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 72 ACC is =  0.6994
round 72 loss is =  1.0500206291675567
Round 73: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a00bf30dbb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m Client 9 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561202)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9de64e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 73 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_73.pth
[36m(ClientAppActor pid=561203)[0m Client 7 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561201)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50811de5a0>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 73 ACC is =  0.699
round 73 loss is =  1.05361151099205
Round 74: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 6 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9d9ac0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619449b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 74 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_74.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619b9760>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 74 ACC is =  0.6986
round 74 loss is =  1.0567907094955444
Round 75: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m loading data[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c116ff50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a38ecbf0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 75 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_75.pth
[36m(ClientAppActor pid=561913)[0m Client 0 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561202)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c61705100>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 75 ACC is =  0.6988
round 75 loss is =  1.0605056703090667
Round 76: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 1 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9da1730>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0377ca10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 76 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_76.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c605cc890>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 76 ACC is =  0.6974
round 76 loss is =  1.0643746495246886
Round 77: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ba8f50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ca87a0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 77 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_77.pth
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561204)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12df830>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 77 ACC is =  0.6984
round 77 loss is =  1.0679281413555146
Round 78: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78b0ae10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 8[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12f31d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 78 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_78.pth
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c60587e90>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 78 ACC is =  0.6972
round 78 loss is =  1.0720992505550384
Round 79: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561206)[0m Client 7 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561206)[0m loading data[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 7[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d278790860>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 3[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969008cec0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 79 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_79.pth
[36m(ClientAppActor pid=561206)[0m Client 0 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77968780dc70>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a38f4260>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 79 ACC is =  0.6984
round 79 loss is =  1.0746852934360505
Round 80: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m Client 1 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561913)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561913)[0m before loading model statdict
[36m(ClientAppActor pid=561913)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796900e0ec0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbdc4d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 80 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_80.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d26c9ab620>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 80 ACC is =  0.6972
round 80 loss is =  1.078626126050949
Round 81: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a0000777e00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c633ffad0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 81 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_81.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53dcb46d80>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 81 ACC is =  0.6976
round 81 loss is =  1.0814673602581024
Round 82: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 7 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000cbf8080>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f01ec1d610>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 82 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_82.pth
[36m(ClientAppActor pid=561913)[0m Client 1 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969018c920>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561913)[0m Available devices  1
[36m(ClientAppActor pid=561913)[0m Current cuda device  0
[36m(ClientAppActor pid=561913)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561913)[0m before loading model statdict
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 82 ACC is =  0.6978
round 82 loss is =  1.0859294831752777
Round 83: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50812bc1d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796841c6870>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561204)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 83 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_83.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969008cad0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 83 ACC is =  0.6982
round 83 loss is =  1.0893030524253846
Round 84: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c012c8f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a512a54d820>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561913)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 84 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_84.pth
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddda3bf0>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 84 ACC is =  0.6982
round 84 loss is =  1.0938906729221345
Round 85: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 8 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c2db1f70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m training started
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c2fa7bc0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 85 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_85.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561204)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53dfd98aa0>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 85 ACC is =  0.6982
round 85 loss is =  1.0967440962791444
Round 86: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bbf7f680>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de35dcb7c50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 86 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_86.pth
[36m(ClientAppActor pid=561209)[0m Client 5 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561913)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5081775040>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 86 ACC is =  0.698
round 86 loss is =  1.100130420923233
Round 87: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 3 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687fd9df0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7693705ffaa0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 87 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_87.pth
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m client loading model
[36m(ClientAppActor pid=561210)[0m loading data
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561210)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617a79e0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561211)[0m Available devices  1
[36m(ClientAppActor pid=561211)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 87 ACC is =  0.6982
round 87 loss is =  1.104846900701523
Round 88: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 8 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a38deed0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m training started
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969c02b290>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 88 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_88.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12ed5b0>, len val=500, len test=500
[36m(ClientAppActor pid=561211)[0m gpu in client
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561211)[0m Available devices  1
[36m(ClientAppActor pid=561211)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 88 ACC is =  0.6982
round 88 loss is =  1.108435195684433
Round 89: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m Client 5 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78babec0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c13603b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 89 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_89.pth
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d314d6c560>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 89 ACC is =  0.6962
round 89 loss is =  1.1120139062404633
Round 90: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78b0a990>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m training started
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbddf10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 90 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_90.pth
[36m(ClientAppActor pid=561203)[0m Client 1 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f6270>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 90 ACC is =  0.698
round 90 loss is =  1.1158781409263612
Round 91: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78bed520>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c13989e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 91 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_91.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddceb050>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561211)[0m Available devices  1
[36m(ClientAppActor pid=561211)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561211)[0m before loading model statdict
[36m(ClientAppActor pid=561211)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 91 ACC is =  0.6972
round 91 loss is =  1.1198469579219819
Round 92: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 6 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b97bcc50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f49e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 92 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_92.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c61843c20>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 92 ACC is =  0.6986
round 92 loss is =  1.1240071296691894
Round 93: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d314d6c590>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561202)[0m training started
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c60587e60>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 93 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_93.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c618a8aa0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 93 ACC is =  0.6974
round 93 loss is =  1.1284537851810454
Round 94: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a00242ba6c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617a5fd0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 94 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_94.pth
[36m(ClientAppActor pid=561202)[0m Client 1 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561210)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddc94680>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 94 ACC is =  0.6984
round 94 loss is =  1.1320667147636414
Round 95: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c11f0680>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f0140c30b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 95 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_95.pth
[36m(ClientAppActor pid=561211)[0m Client 6 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77972e173050>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561211)[0m Available devices  1
[36m(ClientAppActor pid=561211)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561211)[0m before loading model statdict
[36m(ClientAppActor pid=561211)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 95 ACC is =  0.6976
round 95 loss is =  1.1361817061901092
Round 96: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Client 3 / 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client calling[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 9[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b8b6bef0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9d98e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 96 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_96.pth
[36m(ClientAppActor pid=561202)[0m Client 0 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9f3e00>, len val=500, len test=500
[36m(ClientAppActor pid=561202)[0m gpu in client
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561202)[0m Available devices  1
[36m(ClientAppActor pid=561202)[0m Current cuda device  0
[36m(ClientAppActor pid=561202)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561202)[0m before loading model statdict
[36m(ClientAppActor pid=561202)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 96 ACC is =  0.6978
round 96 loss is =  1.1395005285739899
Round 97: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x771a67f137d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2bb586db0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 97 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_97.pth
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617a5c70>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 97 ACC is =  0.6982
round 97 loss is =  1.144362211227417
Round 98: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 1 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c129bc50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f0140c2ed0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 98 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_98.pth
[36m(ClientAppActor pid=561202)[0m Client 9 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619ba0f0>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 98 ACC is =  0.6982
round 98 loss is =  1.1476231336593627
Round 99: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Client 9 / 10[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561206)[0m client calling[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ca8b00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m Client 8 / 10[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9daf00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 99 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_99.pth
[36m(ClientAppActor pid=561203)[0m Client 9 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561210)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c60587e60>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 99 ACC is =  0.6974
round 99 loss is =  1.1529683768749237
Round 100: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.0010000000000000002
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Client 1 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561202)[0m Client 0 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9f07d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a00007b9970>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561202)[0m Available devices  1
[36m(ClientAppActor pid=561202)[0m Current cuda device  0
[36m(ClientAppActor pid=561202)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561202)[0m before loading model statdict
[36m(ClientAppActor pid=561202)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 100 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_100.pth
[36m(ClientAppActor pid=561203)[0m Client 7 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c605cee70>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 100 ACC is =  0.697
round 100 loss is =  1.151777970790863
Round 101: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78b0aa80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d278299100>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561208)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561208)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 101 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_101.pth
[36m(ClientAppActor pid=561210)[0m Client 6 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client loading model
[36m(ClientAppActor pid=561210)[0m loading data
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9d93e60>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 101 ACC is =  0.6966
round 101 loss is =  1.1521130979061127
Round 102: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Client 7 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561913)[0m Client 6 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78183c50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b8ba8d40>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 102 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_102.pth
[36m(ClientAppActor pid=561202)[0m Client 1 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561211)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000cb935c0>, len val=500, len test=500
[36m(ClientAppActor pid=561202)[0m gpu in client
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561202)[0m Available devices  1
[36m(ClientAppActor pid=561202)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 102 ACC is =  0.6966
round 102 loss is =  1.1524512887001037
Round 103: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78c701d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78b0a990>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 103 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_103.pth
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508118bf20>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561201)[0m before loading model statdict
[36m(ClientAppActor pid=561201)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 103 ACC is =  0.6968
round 103 loss is =  1.1527526199817657
Round 104: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12998b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9d8f50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 104 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_104.pth
[36m(ClientAppActor pid=561204)[0m Client 0 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561208)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796909f19d0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 104 ACC is =  0.6968
round 104 loss is =  1.1529809832572937
Round 105: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef7842c050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 3 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a00b7fffad0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 105 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_105.pth
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561208)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77968415bd10>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 105 ACC is =  0.6968
round 105 loss is =  1.153299617767334
Round 106: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a0003f81a30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50811de510>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 106 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_106.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d27828b5f0>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561208)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 106 ACC is =  0.6968
round 106 loss is =  1.1537229359149932
Round 107: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a39a4e90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c99d880>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 107 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_107.pth
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561208)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78143980>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 107 ACC is =  0.6968
round 107 loss is =  1.1539790391921998
Round 108: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 6 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a0019cb0350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9753bc0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 108 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_108.pth
[36m(ClientAppActor pid=561206)[0m Client 7 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbdd280>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 108 ACC is =  0.697
round 108 loss is =  1.1543994665145874
Round 109: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Client 6 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561210)[0m Client 1 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f0140c3c80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c904bc0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561202)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561202)[0m Available devices  1
[36m(ClientAppActor pid=561202)[0m Current cuda device  0
[36m(ClientAppActor pid=561202)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561202)[0m before loading model statdict
[36m(ClientAppActor pid=561202)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 109 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_109.pth
[36m(ClientAppActor pid=561211)[0m Client 7 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f6000>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561211)[0m before loading model statdict
[36m(ClientAppActor pid=561211)[0m after loading model statdict
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 109 ACC is =  0.6972
round 109 loss is =  1.154727327823639
Round 110: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f0140c30b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d31c390890>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 110 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_110.pth
[36m(ClientAppActor pid=561202)[0m Client 5 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model
[36m(ClientAppActor pid=561208)[0m loading data
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d26c96fec0>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 110 ACC is =  0.6972
round 110 loss is =  1.1550780355930328
Round 111: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 7 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78183a70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de31c22e330>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 111 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_111.pth
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561201)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50811c61e0>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 111 ACC is =  0.6972
round 111 loss is =  1.1554285824298858
Round 112: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Client 7 / 10[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client calling[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d30bf730e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m Client 0 / 10[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bbdfdb50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 112 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_112.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddb8d280>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 112 ACC is =  0.6972
round 112 loss is =  1.1558478057384491
Round 113: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Client 4 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561211)[0m Client 1 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef792bb0b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77972e173050>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 113 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_113.pth
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d32194d820>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561208)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 113 ACC is =  0.6972
round 113 loss is =  1.1561745941638946
Round 114: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77968781c9e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d278978380>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef781ada60>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m gpu in client
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561201)[0m Available devices  1
[36m(ClientAppActor pid=561201)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561201)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561201)[0m before loading model statdict
[36m(ClientAppActor pid=561201)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m training started
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c1151370>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 114 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_114.pth
[36m(ClientAppActor pid=561211)[0m Client 4 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561204)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c13faf30>, len val=500, len test=500
[36m(ClientAppActor pid=561211)[0m gpu in client
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 114 ACC is =  0.6976
round 114 loss is =  1.1565204858779907
Round 115: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef79156c90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561202)[0m training started
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c13122d0>, len val=500, len test=500[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 9] set_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78bed910>, len val=500, len test=500[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m training started
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m [Client 6] get_parameters[32m [repeated 6x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 115 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_115.pth
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m [Client 1] get_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53dfd72a80>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 115 ACC is =  0.6974
round 115 loss is =  1.1568841934204102
Round 116: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9f1010>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a3d1ae70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78beee40>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m gpu in client
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561201)[0m Available devices  1
[36m(ClientAppActor pid=561201)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561201)[0m before loading model statdict
[36m(ClientAppActor pid=561201)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m training started
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 116 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_116.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c605bc830>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 116 ACC is =  0.697
round 116 loss is =  1.1573074281215667
Round 117: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef785bc380>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c116ff20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 117 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_117.pth
[36m(ClientAppActor pid=561210)[0m Client 6 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561210)[0m client loading model
[36m(ClientAppActor pid=561210)[0m loading data
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561210)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bbea7f80>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 117 ACC is =  0.6974
round 117 loss is =  1.1576548874378205
Round 118: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m Client 5 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c61704410>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78d95280>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 118 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_118.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561201)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617d81d0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m gpu in client
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561201)[0m Available devices  1
[36m(ClientAppActor pid=561201)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561201)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 118 ACC is =  0.6974
round 118 loss is =  1.1579738199710845
Round 119: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 9 / 10[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000cbb8cb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561202)[0m training started
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78bed040>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 119 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_119.pth
[36m(ClientAppActor pid=561210)[0m Client 5 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561201)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d26c96f3e0>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561208)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 119 ACC is =  0.6972
round 119 loss is =  1.1584657907485962
Round 120: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Client 4 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78183ef0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561202)[0m training started
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c1151070>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 120 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_120.pth
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561211)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0197f650>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 120 ACC is =  0.6976
round 120 loss is =  1.1587947309017181
Round 121: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef781bd970>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78becb00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 121 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_121.pth
[36m(ClientAppActor pid=561203)[0m Client 1 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561201)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddb9f770>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 121 ACC is =  0.6974
round 121 loss is =  1.1591810822486877
Round 122: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 9 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d30bf72ea0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9f1e50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 122 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_122.pth
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796901a0e30>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 122 ACC is =  0.6974
round 122 loss is =  1.1596208453178405
Round 123: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 6 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7ed2b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78b0af90>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 123 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_123.pth
[36m(ClientAppActor pid=561206)[0m Client 3 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561210)[0m client loading model
[36m(ClientAppActor pid=561210)[0m loading data
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561201)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617a7c80>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 123 ACC is =  0.6974
round 123 loss is =  1.1599646270275117
Round 124: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78cd8230>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7efd10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 124 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_124.pth
[36m(ClientAppActor pid=561209)[0m Client 5 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561210)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50812e5940>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 124 ACC is =  0.6974
round 124 loss is =  1.1604652106761932
Round 125: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c2fa7c80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796909f1940>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 125 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_125.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50807c44d0>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 125 ACC is =  0.6974
round 125 loss is =  1.160826164484024
Round 126: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ca8b00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ca8c50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 126 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_126.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f54901f86e0>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 126 ACC is =  0.6974
round 126 loss is =  1.1611339330673218
Round 127: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ba9b80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619ba150>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 127 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_127.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f49b0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 127 ACC is =  0.6974
round 127 loss is =  1.1615009784698487
Round 128: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692d35b3500>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9751f40>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 128 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_128.pth
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561211)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a00ab5832c0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m gpu in client
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561202)[0m Available devices  1
[36m(ClientAppActor pid=561202)[0m Current cuda device  0
[36m(ClientAppActor pid=561202)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561202)[0m before loading model statdict
[36m(ClientAppActor pid=561202)[0m after loading model statdict
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 128 ACC is =  0.6974
round 128 loss is =  1.1619395911693573
Round 129: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b8b89a30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50811c7e30>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561206)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 129 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_129.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbdcb90>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f6300>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 129 ACC is =  0.6976
round 129 loss is =  1.1622338593006134
Round 130: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687fd9c70>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78cd8ec0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 130 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_130.pth
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddb8ec00>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 130 ACC is =  0.6978
round 130 loss is =  1.162624990940094
Round 131: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0197ebd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12a4e00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 131 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_131.pth
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561204)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77968415b3b0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561211)[0m Available devices  1
[36m(ClientAppActor pid=561211)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561211)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 131 ACC is =  0.6976
round 131 loss is =  1.1631026446819306
Round 132: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef79156c90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d26c96c740>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561208)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 132 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_132.pth
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model
[36m(ClientAppActor pid=561208)[0m loading data
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d278358260>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561208)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 132 ACC is =  0.6976
round 132 loss is =  1.163468611240387
Round 133: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 3 / 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78dbde80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m Client 9 / 10[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef79292690>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 133 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_133.pth
[36m(ClientAppActor pid=561206)[0m Client 8 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561201)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561210)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d316b65cd0>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561201)[0m Available devices  1
[36m(ClientAppActor pid=561201)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 133 ACC is =  0.6976
round 133 loss is =  1.1639462471008302
Round 134: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m loading data[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50812e55e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a38f6c00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 134 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_134.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d30bf73ce0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 134 ACC is =  0.6976
round 134 loss is =  1.1642461001873017
Round 135: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 2 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000caa8650>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53d3f3f3b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5081290ec0>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 135 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_135.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c6352f7a0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 135 ACC is =  0.6974
round 135 loss is =  1.164602518081665
Round 136: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f0140c2ed0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50811de090>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 136 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_136.pth
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c607d4fe0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 136 ACC is =  0.6974
round 136 loss is =  1.1650704264640808
Round 137: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d278391b20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617d8f50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 137 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_137.pth
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561201)[0m client loading model
[36m(ClientAppActor pid=561201)[0m loading data
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561201)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508120a060>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 137 ACC is =  0.6976
round 137 loss is =  1.1653805494308471
Round 138: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78baaae0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c116fe00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 138 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_138.pth
[36m(ClientAppActor pid=561204)[0m Client 7 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c60725010>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 138 ACC is =  0.6976
round 138 loss is =  1.1659249663352966
Round 139: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d26c98c410>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a0000758ce0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 139 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_139.pth
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561206)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796a80453d0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 139 ACC is =  0.6974
round 139 loss is =  1.1662212908267975
Round 140: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c2e7f080>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a00ab583200>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 140 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_140.pth
[36m(ClientAppActor pid=561203)[0m Client 9 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5080be0e90>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m gpu in client
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 140 ACC is =  0.6974
round 140 loss is =  1.1666608095169066
Round 141: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9752720>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m Client 2 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50812909e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 141 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_141.pth
[36m(ClientAppActor pid=561210)[0m Client 4 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a00bf30dc10>, len val=500, len test=500
[36m(ClientAppActor pid=561202)[0m gpu in client
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 141 ACC is =  0.698
round 141 loss is =  1.1671511471271514
Round 142: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c129ad50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c2fa7920>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 142 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_142.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d2783edbb0>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 142 ACC is =  0.6978
round 142 loss is =  1.1676132023334502
Round 143: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969008d5e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a38dcc20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 143 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_143.pth
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561210)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddc95610>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 143 ACC is =  0.6978
round 143 loss is =  1.168011236190796
Round 144: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561204)[0m Client 0 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561201)[0m Client 3 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969018ce00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef792bb0b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 144 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_144.pth
[36m(ClientAppActor pid=561211)[0m Client 3 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77968419f770>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 144 ACC is =  0.6976
round 144 loss is =  1.1683642506599425
Round 145: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 4 / 10[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d27835a690>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 2 / 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50812e4a70>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 145 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_145.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c7b5de690>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 145 ACC is =  0.698
round 145 loss is =  1.1687909007072448
Round 146: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9dad1f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9dae870>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 146 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_146.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53dcb60380>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 146 ACC is =  0.698
round 146 loss is =  1.169143909215927
Round 147: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 9 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50811dc950>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c33c5fd0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 147 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_147.pth
[36m(ClientAppActor pid=561211)[0m Client 0 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561211)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796841587a0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 147 ACC is =  0.698
round 147 loss is =  1.1695915699005126
Round 148: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 0 / 10[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c99f620>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x771a64172db0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561211)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 148 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_148.pth
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f5c10>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 148 ACC is =  0.6978
round 148 loss is =  1.1699147462844848
Round 149: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d278390890>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c1150500>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561211)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561211)[0m before loading model statdict
[36m(ClientAppActor pid=561211)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 149 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_149.pth
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c6059cb00>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 149 ACC is =  0.6978
round 149 loss is =  1.1705037295818328
Round 150: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.00010000000000000003
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Client 9 / 10[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client calling[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d30bf730b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Client 7 / 10[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddce9040>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561210)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7693617a8050>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 150 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_150.pth
[36m(ClientAppActor pid=561210)[0m Client 0 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client loading model
[36m(ClientAppActor pid=561210)[0m loading data
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619938f0>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m gpu in client
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561211)[0m Available devices  1
[36m(ClientAppActor pid=561211)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 150 ACC is =  0.6978
round 150 loss is =  1.170528656244278
Round 151: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 7 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000caa8fb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c634d5f10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 151 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_151.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c6191b530>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 151 ACC is =  0.6978
round 151 loss is =  1.1705505311489106
Round 152: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Client 7 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a0000790d70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561202)[0m training started
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5081776000>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 152 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_152.pth
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619ba150>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 152 ACC is =  0.698
round 152 loss is =  1.1705871999263764
Round 153: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d278978350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77973a133290>, len val=500, len test=500
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 7[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508130ef90>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d26cb94fb0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 153 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_153.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c618abcb0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m gpu in client
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 153 ACC is =  0.698
round 153 loss is =  1.1706382513046265
Round 154: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d263f75460>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12a5b80>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 154 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_154.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561201)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617db740>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 154 ACC is =  0.698
round 154 loss is =  1.170655083656311
Round 155: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Client 9 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d278790800>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50811c7ad0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 155 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_155.pth
[36m(ClientAppActor pid=561209)[0m Client 5 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561202)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7ecad0>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 155 ACC is =  0.6978
round 155 loss is =  1.1706787467002868
Round 156: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d2783ed2e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbcd160>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 156 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_156.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c607f4c50>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 156 ACC is =  0.6978
round 156 loss is =  1.170723956823349
Round 157: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78d26ae0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a3d1af00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 157 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_157.pth
[36m(ClientAppActor pid=561913)[0m Client 0 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c63389010>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 157 ACC is =  0.6978
round 157 loss is =  1.1707456052303313
Round 158: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 5 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a0024295100>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561913)[0m partition loaded
[36m(ClientAppActor pid=561913)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508199e990>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 158 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_158.pth
[36m(ClientAppActor pid=561202)[0m Client 0 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000cbf81d0>, len val=500, len test=500
[36m(ClientAppActor pid=561202)[0m gpu in client
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561202)[0m Available devices  1
[36m(ClientAppActor pid=561202)[0m Current cuda device  0
[36m(ClientAppActor pid=561202)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561202)[0m before loading model statdict
[36m(ClientAppActor pid=561202)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 158 ACC is =  0.6978
round 158 loss is =  1.1707817375659944
Round 159: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561204)[0m Client 6 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a3d89580>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561210)[0m training started
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m 
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9d8c50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 159 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_159.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561202)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617a77d0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 159 ACC is =  0.6978
round 159 loss is =  1.1708484947681428
Round 160: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x771a6c363950>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m training started
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d31e25bd10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561203)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f54881a40e0>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 160 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_160.pth
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50812bc500>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 160 ACC is =  0.6978
round 160 loss is =  1.1708713054656983
Round 161: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 4 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9de5d90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb798f20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561206)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 161 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_161.pth
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c634b6600>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 161 ACC is =  0.6978
round 161 loss is =  1.1709042370319367
Round 162: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 8 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c13991f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m training started
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000caa8b90>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561202)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 162 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_162.pth
[36m(ClientAppActor pid=561211)[0m Client 2 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a511e153050>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 162 ACC is =  0.6978
round 162 loss is =  1.17091246843338
Round 163: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 5 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 0 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000cba7830>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ca89e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 163 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_163.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619bbd10>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 163 ACC is =  0.6978
round 163 loss is =  1.170957523584366
Round 164: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d26cbe00b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a389eea0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 164 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_164.pth
[36m(ClientAppActor pid=561204)[0m Client 2 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561201)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d27877c500>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 164 ACC is =  0.698
round 164 loss is =  1.1710251152515412
Round 165: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddc94c50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5080b8b8c0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 165 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_165.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561913)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5080b8b440>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 165 ACC is =  0.6978
round 165 loss is =  1.1710594475269318
Round 166: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a3db4f20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687fd9a30>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 166 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_166.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5080b89310>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 166 ACC is =  0.698
round 166 loss is =  1.1711016833782195
Round 167: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 0 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbddbb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561210)[0m training started
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c12f1a30>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 167 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_167.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded
[36m(ClientAppActor pid=561211)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddc410a0>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561211)[0m Available devices  1
[36m(ClientAppActor pid=561211)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 167 ACC is =  0.698
round 167 loss is =  1.171127301454544
Round 168: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796901e1b50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78d07bf0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 168 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_168.pth
[36m(ClientAppActor pid=561206)[0m Client 0 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508c1174a0>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 168 ACC is =  0.698
round 168 loss is =  1.1711454033851623
Round 169: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969008ccb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x771a6c154c20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 169 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_169.pth
[36m(ClientAppActor pid=561913)[0m Client 5 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561206)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d2787aa000>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561208)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 169 ACC is =  0.6978
round 169 loss is =  1.1711682856082917
Round 170: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 7 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2967aae40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78d73ef0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 170 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_170.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561201)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50811c69f0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 170 ACC is =  0.698
round 170 loss is =  1.171196848154068
Round 171: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78cabd10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561913)[0m partition loaded
[36m(ClientAppActor pid=561913)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a511c176e70>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 171 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_171.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561201)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9788dd0>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561201)[0m Available devices  1
[36m(ClientAppActor pid=561201)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 171 ACC is =  0.698
round 171 loss is =  1.1712412655353546
Round 172: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m Client 0 / 10
[36m(ClientAppActor pid=561208)[0m client calling
[36m(ClientAppActor pid=561208)[0m client loading model
[36m(ClientAppActor pid=561208)[0m loading data
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d27828bda0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c605beb10>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddd78110>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561202)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c99fad0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 172 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_172.pth
[36m(ClientAppActor pid=561204)[0m Client 3 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561208)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617a5910>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561202)[0m Available devices  1
[36m(ClientAppActor pid=561202)[0m Current cuda device  0
[36m(ClientAppActor pid=561202)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561202)[0m before loading model statdict
[36m(ClientAppActor pid=561202)[0m after loading model statdict
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 172 ACC is =  0.698
round 172 loss is =  1.1712993919849395
Round 173: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef7918dd90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561210)[0m training started
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d26cbe1160>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 173 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_173.pth
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617d8740>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 173 ACC is =  0.698
round 173 loss is =  1.1713355779647827
Round 174: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 1 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d314d6de50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb9f3a10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 174 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_174.pth
[36m(ClientAppActor pid=561201)[0m Client 3 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561201)[0m client loading model
[36m(ClientAppActor pid=561201)[0m loading data
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561201)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796900e1610>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561201)[0m Available devices  1
[36m(ClientAppActor pid=561201)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 174 ACC is =  0.698
round 174 loss is =  1.171403843164444
Round 175: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 2 / 10[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x771a6fffbf50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78bf8e30>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 175 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_175.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddb8eed0>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 175 ACC is =  0.698
round 175 loss is =  1.1713941991329193
Round 176: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Client 3 / 10[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client calling[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561209)[0m loading data[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 5[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78baa690>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 7 / 10[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 7[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561201)[0m training started
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bbdfdb50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 176 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_176.pth
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561211)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c633ffad0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 176 ACC is =  0.698
round 176 loss is =  1.17147798538208
Round 177: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000caa87d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de35800f950>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561913)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 177 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_177.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50811c6ff0>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561211)[0m Available devices  1
[36m(ClientAppActor pid=561211)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m before loading model statdict
[36m(ClientAppActor pid=561208)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 177 ACC is =  0.698
round 177 loss is =  1.1715057373046875
Round 178: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 1 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000cbf81d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78b0af90>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 1] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c99f890>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] set_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 3x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 178 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_178.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c618a88c0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561201)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 178 ACC is =  0.698
round 178 loss is =  1.1715571105480194
Round 179: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Client 7 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50811c4560>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a51241fc110>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561211)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x771a6c363950>, len val=500, len test=500
[36m(ClientAppActor pid=561211)[0m gpu in client
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561211)[0m Available devices  1
[36m(ClientAppActor pid=561211)[0m Current cuda device  0
[36m(ClientAppActor pid=561211)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561211)[0m before loading model statdict
[36m(ClientAppActor pid=561211)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 179 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_179.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617059d0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 179 ACC is =  0.698
round 179 loss is =  1.1715950071811676
Round 180: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9f1580>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Client 9 / 10[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client calling[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561211)[0m training started
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de34cd83260>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 180 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_180.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561210)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687868b30>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 180 ACC is =  0.6982
round 180 loss is =  1.171638798713684
Round 181: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617a7c50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50811dd850>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 181 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_181.pth
[36m(ClientAppActor pid=561209)[0m Client 5 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561206)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617a7920>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561913)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 181 ACC is =  0.698
round 181 loss is =  1.1716627895832061
Round 182: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d2787a8d10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7796900e3fe0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bbdfdb50>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 182 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_182.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c618a8e90>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 182 ACC is =  0.6982
round 182 loss is =  1.1717057824134827
Round 183: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 9 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9da4e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000cb913d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict
[36m(ClientAppActor pid=561202)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 183 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_183.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561201)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619bb980>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561211)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 183 ACC is =  0.698
round 183 loss is =  1.1717524349689483
Round 184: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a00ab5829f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5081776a50>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7ed2b0>, len val=500, len test=500[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 8] set_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561210)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561210)[0m training started
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 184 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_184.pth
[36m(ClientAppActor pid=561209)[0m Client 5 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m client loading model
[36m(ClientAppActor pid=561210)[0m loading data
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77973a133290>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 184 ACC is =  0.698
round 184 loss is =  1.1717977344989776
Round 185: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 2 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d30bf73230>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de29574b1d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 185 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_185.pth
[36m(ClientAppActor pid=561204)[0m Client 9 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561208)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969008d130>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 185 ACC is =  0.6982
round 185 loss is =  1.171824085712433
Round 186: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561913)[0m Client 3 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bbea6a50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d30bf72db0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 186 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_186.pth
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561208)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f4200>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 186 ACC is =  0.6978
round 186 loss is =  1.1718773007392884
Round 187: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9f0dd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7122a0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 187 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_187.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0c10dc10>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 187 ACC is =  0.6982
round 187 loss is =  1.1719326019287108
Round 188: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78bf9310>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c6191a810>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561203)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53dc3d4410>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 188 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_188.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561208)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619ba0f0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 188 ACC is =  0.698
round 188 loss is =  1.1719360053539276
Round 189: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9d97f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bbf7e1b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 189 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_189.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9d93620>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 189 ACC is =  0.698
round 189 loss is =  1.172004896402359
Round 190: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d2783ecd40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53df874380>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 1] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d2783ed670>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 2] set_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 190 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_190.pth
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561208)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model
[36m(ClientAppActor pid=561208)[0m loading data
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561913)[0m partition loaded
[36m(ClientAppActor pid=561913)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d26c98eed0>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 190 ACC is =  0.6982
round 190 loss is =  1.1720521688461303
Round 191: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c33c5fd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f6480>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 191 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_191.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m client loading model
[36m(ClientAppActor pid=561210)[0m loading data
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561209)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c618a8b90>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 191 ACC is =  0.6982
round 191 loss is =  1.1720810174942016
Round 192: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ca84d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d26c96c6e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 192 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_192.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561208)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c6075f2f0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 192 ACC is =  0.6982
round 192 loss is =  1.1721002519130708
Round 193: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2957688f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c1299b50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 193 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_193.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561211)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f5488173500>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561201)[0m Available devices  1
[36m(ClientAppActor pid=561201)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561201)[0m before loading model statdict
[36m(ClientAppActor pid=561201)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 193 ACC is =  0.6982
round 193 loss is =  1.17213534116745
Round 194: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b8baa1e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77972e173fb0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561204)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 194 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_194.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619ba180>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 194 ACC is =  0.6982
round 194 loss is =  1.1721777439117431
Round 195: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Client 5 / 10[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client calling[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9db350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m training started
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508118bf20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 195 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_195.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619ba150>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 195 ACC is =  0.6982
round 195 loss is =  1.1722070217132567
Round 196: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a38dfc50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m training started
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50812e7e60>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 196 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_196.pth
[36m(ClientAppActor pid=561201)[0m Client 0 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561201)[0m client loading model
[36m(ClientAppActor pid=561201)[0m loading data
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561201)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c6075d5e0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 196 ACC is =  0.6982
round 196 loss is =  1.1722465693950652
Round 197: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a39ee3c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78dbd490>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 197 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_197.pth
[36m(ClientAppActor pid=561209)[0m Client 7 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617db4a0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 197 ACC is =  0.698
round 197 loss is =  1.1723312079906463
Round 198: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 6 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d30bf73050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb880470>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561210)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 198 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_198.pth
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508075c3e0>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 198 ACC is =  0.6982
round 198 loss is =  1.1723392605781555
Round 199: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de29576aba0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c116f110>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 199 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_199.pth
[36m(ClientAppActor pid=561204)[0m Client 5 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77968792c830>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 199 ACC is =  0.6978
round 199 loss is =  1.1723718166351318
Round 200: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 1.0000000000000004e-05
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 2 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef781bd310>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] fit, config: {'lr': 1.0000000000000004e-05, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c019b9b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m [Client 3] fit, config: {'lr': 1.0000000000000004e-05, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 200 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_200.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561209)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0197f080>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 200 ACC is =  0.6982
round 200 loss is =  1.1723997950553895
Round 201: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 8 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d31e25bd10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 8] fit, config: {'lr': 1.0000000000000004e-05, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef784b8d10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 6] fit, config: {'lr': 1.0000000000000004e-05, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 201 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_201.pth
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561209)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77974172d910>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 201 ACC is =  0.6982
round 201 loss is =  1.1723924815654754
Round 202: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c904ec0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m [Client 6] fit, config: {'lr': 1.0000000000000004e-05, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561211)[0m training started
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78183f50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 7] fit, config: {'lr': 1.0000000000000004e-05, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 202 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_202.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561201)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508075e150>, len val=500, len test=500
[36m(ClientAppActor pid=561206)[0m gpu in client
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561206)[0m Available devices  1
[36m(ClientAppActor pid=561206)[0m Current cuda device  0
[36m(ClientAppActor pid=561206)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 202 ACC is =  0.698
round 202 loss is =  1.172413271665573
Round 203: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Client 7 / 10[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client calling[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a0003fa4b60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 2] fit, config: {'lr': 1.0000000000000004e-05, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c012d460>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] fit, config: {'lr': 1.0000000000000004e-05, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 203 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_203.pth
[36m(ClientAppActor pid=561913)[0m Client 2 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561209)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687fd9400>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561201)[0m Available devices  1
[36m(ClientAppActor pid=561201)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 203 ACC is =  0.698
round 203 loss is =  1.1723987460136414
Round 204: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Client 2 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561210)[0m Client 0 / 10
[36m(ClientAppActor pid=561210)[0m client calling
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bbea6ab0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 5] fit, config: {'lr': 1.0000000000000004e-05, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c13fab10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 10x across cluster][0m
