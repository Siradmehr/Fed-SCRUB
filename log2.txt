model initiated
Using freshly initialized model (no checkpoint loaded)
{'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'SAVING_DIR': './checkpoints/1/nf_resnet18/cifar10/2_17', 'LOADED_MODEL': NFResNet(
  (conv1): ScaledStdConv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)}
server configured
Round 1: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561206)[0m Client 8 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561210)[0m partition loaded
[36m(ClientAppActor pid=561210)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 9 / 10[32m [repeated 9x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb80ea80>, len val=500, len test=500
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14974 MiB, 66076 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561210)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561210)[0m before loading model statdict
[36m(ClientAppActor pid=561210)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m training started
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef7918d7c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 21756 MiB, 59294 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_1.pth
[36m(ClientAppActor pid=561208)[0m Client 2 / 10
[36m(ClientAppActor pid=561208)[0m client calling
[36m(ClientAppActor pid=561913)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d2787a8d10>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561206)[0m before loading model statdict
[36m(ClientAppActor pid=561206)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 1 ACC is =  0.1732
round 1 loss is =  5.501452207565308
Current best ACC is =  0.1732
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 2: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9de4620>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561204)[0m training started
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f017547080>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 2 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_2.pth
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561206)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f54881a40e0>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 2 ACC is =  0.1654
round 2 loss is =  3.4349398851394652
Round 3: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a50812bc500>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7ed760>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561913)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a3d88c80>, len val=500, len test=500
[36m(ClientAppActor pid=561913)[0m gpu in client
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561913)[0m Available devices  1
[36m(ClientAppActor pid=561913)[0m Current cuda device  0
[36m(ClientAppActor pid=561913)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561913)[0m before loading model statdict
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 3 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_3.pth
[36m(ClientAppActor pid=561204)[0m Client 3 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561913)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969008d250>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m gpu in client
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561913)[0m Available devices  1
[36m(ClientAppActor pid=561913)[0m Current cuda device  0
[36m(ClientAppActor pid=561913)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561913)[0m before loading model statdict
[36m(ClientAppActor pid=561913)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 3 ACC is =  0.229
round 3 loss is =  2.1308282136917116
Current best ACC is =  0.229
Saving round 3 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 4: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Client 4 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561204)[0m Client 3 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7693617771d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c60584680>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_4.pth
[36m(ClientAppActor pid=561204)[0m Client 0 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561210)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77968419c380>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 4 ACC is =  0.2744
round 4 loss is =  1.9231644034385682
Current best ACC is =  0.2744
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 5: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 3 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5081290680>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c99f8f0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78cab7a0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m gpu in client
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c2d10170>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_5.pth
[36m(ClientAppActor pid=561211)[0m Client 0 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561210)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0197f2c0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561210)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m before loading model statdict
[36m(ClientAppActor pid=561211)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 5 ACC is =  0.3504
round 5 loss is =  1.7745529055595397
Current best ACC is =  0.3504
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 6: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Client 0 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561208)[0m Client 2 / 10
[36m(ClientAppActor pid=561208)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78dbcda0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561208)[0m training started
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969018ce00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_6.pth
[36m(ClientAppActor pid=561209)[0m Client 5 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561204)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0f7fb9b0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 6 ACC is =  0.3892
round 6 loss is =  1.652667474746704
Current best ACC is =  0.3892
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 7: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x771a641735c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969008c5f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_7.pth
[36m(ClientAppActor pid=561204)[0m Client 1 / 10
[36m(ClientAppActor pid=561204)[0m client calling
[36m(ClientAppActor pid=561204)[0m client loading model
[36m(ClientAppActor pid=561204)[0m loading data
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561208)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2a3fe8aa0>, len val=500, len test=500
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m gpu in client
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 7 ACC is =  0.4256
round 7 loss is =  1.5837892770767212
Current best ACC is =  0.4256
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 8: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 4 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f01ebd3590>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53dcb97c80>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded
[36m(ClientAppActor pid=561206)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_8.pth
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561913)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbcee10>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561202)[0m before loading model statdict
[36m(ClientAppActor pid=561202)[0m after loading model statdict
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 8 ACC is =  0.4436
round 8 loss is =  1.5093702912330627
Current best ACC is =  0.4436
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 9: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 4 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692b9da0590>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m training started
[36m(ClientAppActor pid=561210)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687fd9640>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m partition loaded
[36m(ClientAppActor pid=561202)[0m len partition= 5000
[36m(ClientAppActor pid=561202)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000c9f1a90>, len val=500, len test=500
[36m(ClientAppActor pid=561202)[0m gpu in client
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561202)[0m Available devices  1
[36m(ClientAppActor pid=561202)[0m Current cuda device  0
[36m(ClientAppActor pid=561202)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561202)[0m before loading model statdict
[36m(ClientAppActor pid=561202)[0m after loading model statdict
[36m(ClientAppActor pid=561202)[0m training started
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_9.pth
[36m(ClientAppActor pid=561209)[0m Client 2 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617a7470>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 9 ACC is =  0.4608
round 9 loss is =  1.484696638584137
Current best ACC is =  0.4608
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 10: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Client 4 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561211)[0m Client 1 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a508118bbf0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m training started
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77969053b830>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 10 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_10.pth
[36m(ClientAppActor pid=561209)[0m Client 6 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617f41d0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 10 ACC is =  0.4738
round 10 loss is =  1.460586929321289
Current best ACC is =  0.4738
Saving round 10 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 11: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 0 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddce8980>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561208)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x73d2782e22d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561208)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561208)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_11.pth
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561208)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c61707f80>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 11 ACC is =  0.4904
round 11 loss is =  1.4193724155426026
Current best ACC is =  0.4904
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 12: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m Client 2 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561208)[0m Client 7 / 10
[36m(ClientAppActor pid=561208)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a5080b6ff20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m partition loaded
[36m(ClientAppActor pid=561208)[0m len partition= 5000
[36m(ClientAppActor pid=561211)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddd79250>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561208)[0m Available devices  1
[36m(ClientAppActor pid=561208)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561206)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a511e153050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_12.pth
[36m(ClientAppActor pid=561201)[0m Client 0 / 10
[36m(ClientAppActor pid=561201)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model
[36m(ClientAppActor pid=561201)[0m loading data
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561201)[0m partition loaded
[36m(ClientAppActor pid=561201)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d080af950>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 12 ACC is =  0.5058
round 12 loss is =  1.3775385737419128
Current best ACC is =  0.5058
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 13: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561206)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561206)[0m client loading model
[36m(ClientAppActor pid=561206)[0m loading data
[36m(ClientAppActor pid=561206)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a000cbb8dd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m training started
[36m(ClientAppActor pid=561206)[0m number of epochs in this 2
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ba8620>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 13 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_13.pth
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c60584680>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 13 ACC is =  0.5198
round 13 loss is =  1.3447165966033936
Current best ACC is =  0.5198
Saving round 13 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 14: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m Client 1 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687f87bc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78b0a9f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 14 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_14.pth
[36m(ClientAppActor pid=561203)[0m Client 5 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model
[36m(ClientAppActor pid=561203)[0m loading data
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561208)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77968415bd40>, len val=500, len test=500
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 14 ACC is =  0.507
round 14 loss is =  1.377931332588196
Round 15: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Client 8 / 10[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client calling[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a0000777e60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74f0140c3020>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 15 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_15.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725d0197f440>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 15 ACC is =  0.5232
round 15 loss is =  1.3351199626922607
Current best ACC is =  0.5232
Saving round 15 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 16: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 9 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561211)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7719c116c290>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m partition loaded
[36m(ClientAppActor pid=561204)[0m len partition= 5000
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c61707aa0>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddb8d190>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78ca85f0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 16 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_16.pth
[36m(ClientAppActor pid=561209)[0m Client 9 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561211)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561211)[0m client loading model
[36m(ClientAppActor pid=561211)[0m loading data
[36m(ClientAppActor pid=561211)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561204)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c617d8920>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 16 ACC is =  0.5422
round 16 loss is =  1.2707043528556823
Current best ACC is =  0.5422
Saving round 16 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 17: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561203)[0m Client 0 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561913)[0m Client 6 / 10
[36m(ClientAppActor pid=561913)[0m client calling
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53ddbdcb90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=561203)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c619a4a70>, len val=500, len test=500
[36m(ClientAppActor pid=561209)[0m gpu in client
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561209)[0m Available devices  1
[36m(ClientAppActor pid=561209)[0m Current cuda device  0
[36m(ClientAppActor pid=561209)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict
[36m(ClientAppActor pid=561209)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53dcb95c10>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78d72e10>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561202)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 17 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_17.pth
[36m(ClientAppActor pid=561209)[0m Client 8 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561209)[0m client loading model
[36m(ClientAppActor pid=561209)[0m loading data
[36m(ClientAppActor pid=561209)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=561211)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f54881c0470>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 17 ACC is =  0.557
round 17 loss is =  1.2504104614257812
Current best ACC is =  0.557
Saving round 17 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 18: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561209)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 0 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 7 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561209)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x725c633899a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561206)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m training started
[36m(ClientAppActor pid=561209)[0m number of epochs in this 2
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef79292690>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561211)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_18.pth
[36m(ClientAppActor pid=561206)[0m Client 5 / 10
[36m(ClientAppActor pid=561206)[0m client calling
[36m(ClientAppActor pid=561201)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m client loading model
[36m(ClientAppActor pid=561208)[0m loading data
[36m(ClientAppActor pid=561208)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561203)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f53df8d92e0>, len val=500, len test=500
[36m(ClientAppActor pid=561203)[0m gpu in client
[36m(ClientAppActor pid=561203)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561203)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 18 ACC is =  0.5692
round 18 loss is =  1.2170000791549682
Current best ACC is =  0.5692
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 19: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561202)[0m Client 5 / 10
[36m(ClientAppActor pid=561202)[0m client calling
[36m(ClientAppActor pid=561201)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74ef78d06f60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561202)[0m client loading model
[36m(ClientAppActor pid=561202)[0m loading data
[36m(ClientAppActor pid=561202)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7988c0>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561203)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561203)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561203)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561203)[0m Available devices  1
[36m(ClientAppActor pid=561203)[0m Current cuda device  0
[36m(ClientAppActor pid=561203)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561203)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=561204)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7797397d8d10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561208)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 19 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_19.pth
[36m(ClientAppActor pid=561211)[0m Client 6 / 10
[36m(ClientAppActor pid=561211)[0m client calling
[36m(ClientAppActor pid=561208)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m client loading model
[36m(ClientAppActor pid=561913)[0m loading data
[36m(ClientAppActor pid=561913)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=561203)[0m partition loaded
[36m(ClientAppActor pid=561203)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x779687fc38f0>, len val=500, len test=500
[36m(ClientAppActor pid=561204)[0m gpu in client
[36m(ClientAppActor pid=561204)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561204)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561204)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561204)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561204)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561204)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561204)[0m Available devices  1
[36m(ClientAppActor pid=561204)[0m Current cuda device  0
[36m(ClientAppActor pid=561204)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=561204)[0m before loading model statdict
[36m(ClientAppActor pid=561204)[0m after loading model statdict
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 19 ACC is =  0.573
round 19 loss is =  1.21866295337677
Current best ACC is =  0.573
Saving round 19 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 20: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561210)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561209)[0m Client 3 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561203)[0m Client 6 / 10
[36m(ClientAppActor pid=561203)[0m client calling
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769368109850>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561201)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m training started
[36m(ClientAppActor pid=561203)[0m number of epochs in this 2
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=561913)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de2ac0797f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561913)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=561202)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561913)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 20 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_round_20.pth
[36m(ClientAppActor pid=561209)[0m Client 1 / 10
[36m(ClientAppActor pid=561209)[0m client calling
[36m(ClientAppActor pid=561202)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m client loading model
[36m(ClientAppActor pid=561210)[0m loading data
[36m(ClientAppActor pid=561210)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=561209)[0m partition loaded
[36m(ClientAppActor pid=561209)[0m len partition= 5000
[36m(ClientAppActor pid=561201)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561210)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561210)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7692bb7efcb0>, len val=500, len test=500
[36m(ClientAppActor pid=561210)[0m gpu in client
[36m(ClientAppActor pid=561210)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=561210)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=561210)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet18', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '500', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=561210)[0m cuda:0
[36m(ClientAppActor pid=561210)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=561210)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=561210)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 32654 MiB, 48396 MiB
[36m(ClientAppActor pid=561210)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=561210)[0m Available devices  1
[36m(ClientAppActor pid=561210)[0m Current cuda device  0
[36m(ClientAppActor pid=561201)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561201)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=561203)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561203)[0m cuda:0
[36m(ClientAppActor pid=561203)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=561203)[0m before loading model statdict
[36m(ClientAppActor pid=561203)[0m after loading model statdict
[36m(ClientAppActor pid=561204)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561204)[0m cuda:0
[36m(ClientAppActor pid=561211)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561211)[0m cuda:0
[36m(ClientAppActor pid=561208)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561208)[0m cuda:0
[36m(ClientAppActor pid=561206)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561206)[0m cuda:0
[36m(ClientAppActor pid=561913)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561913)[0m cuda:0
[36m(ClientAppActor pid=561202)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561202)[0m cuda:0
[36m(ClientAppActor pid=561209)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561209)[0m cuda:0
[36m(ClientAppActor pid=561201)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=561201)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 20 ACC is =  0.5746
round 20 loss is =  1.1929526686668397
Current best ACC is =  0.5746
Saving round 20 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet18/cifar10/2_17/models_chkpts/model_best.pth
Round 21: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=561201)[0m partition loaded[32m [repeated 9x across cluster][0m
