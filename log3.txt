model initiated
Using freshly initialized model (no checkpoint loaded)
{'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'SAVING_DIR': './checkpoints/1/nf_resnet34/cifar10/2_17', 'LOADED_MODEL': NFResNet(
  (conv1): ScaledStdConv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (2): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (2): BasicBlock(
      (conv1): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (3): BasicBlock(
      (conv1): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (2): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (3): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (4): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (5): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (2): BasicBlock(
      (conv1): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)}
server configured
Round 1: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762649)[0m Client 4 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 8 / 10[32m [repeated 9x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551540b6f30>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m gpu in client
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 15033 MiB, 66017 MiB
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762657)[0m Available devices  1
[36m(ClientAppActor pid=762657)[0m Current cuda device  0
[36m(ClientAppActor pid=762657)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762657)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762657)[0m before loading model statdict
[36m(ClientAppActor pid=762657)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m training started
[36m(ClientAppActor pid=762657)[0m number of epochs in this 2
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61471385f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 21638 MiB, 59412 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 8] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_1.pth
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe53fe1730>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 1 ACC is =  0.1528
round 1 loss is =  5.984732437133789
Current best ACC is =  0.1528
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 2: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Client 3 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc08bfb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Client 2 / 10
[36m(ClientAppActor pid=762607)[0m client calling
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model
[36m(ClientAppActor pid=762654)[0m loading data
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m partition loaded
[36m(ClientAppActor pid=762657)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x755131b6ea80>, len val=500, len test=500
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m gpu in client
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762654)[0m Available devices  1
[36m(ClientAppActor pid=762654)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762654)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m before loading model statdict
[36m(ClientAppActor pid=762657)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m training started
[36m(ClientAppActor pid=762657)[0m number of epochs in this 2
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc19fb60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 2 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_2.pth
[36m(ClientAppActor pid=762653)[0m Client 2 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762655)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe5cb3ab40>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 2 ACC is =  0.1528
round 2 loss is =  2.3342443704605103
Round 3: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Client 1 / 10
[36m(ClientAppActor pid=762658)[0m client calling
[36m(ClientAppActor pid=762650)[0m Client 2 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d614534f230>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762658)[0m training started
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551339acc80>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 3 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_3.pth
[36m(ClientAppActor pid=762650)[0m Client 6 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe53999460>, len val=500, len test=500
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 3 ACC is =  0.1922
round 3 loss is =  2.250222015380859
Current best ACC is =  0.1922
Saving round 3 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 4: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 0 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3da2113a10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 5 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9cc173590>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m 
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe538f0bc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_4.pth
[36m(ClientAppActor pid=762658)[0m Client 4 / 10
[36m(ClientAppActor pid=762658)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe4677e270>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762658)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 4 ACC is =  0.238
round 4 loss is =  2.088356947898865
Current best ACC is =  0.238
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 5: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762650)[0m Client 0 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5696960>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 8 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9cc173620>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61451e9370>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_5.pth
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762654)[0m partition loaded
[36m(ClientAppActor pid=762654)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61451e8110>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m gpu in client
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762657)[0m Available devices  1
[36m(ClientAppActor pid=762657)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762654)[0m before loading model statdict
[36m(ClientAppActor pid=762654)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 5 ACC is =  0.2744
round 5 loss is =  2.016718053817749
Current best ACC is =  0.2744
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 6: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 5 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa74bb2d20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762652)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925d82330>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762658)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3da01ac0e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 2] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_6.pth
[36m(ClientAppActor pid=762649)[0m Client 3 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe53d84cb0>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 6 ACC is =  0.2852
round 6 loss is =  1.976487672328949
Current best ACC is =  0.2852
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 7: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abe200d86e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Client 6 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762652)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925b20fe0>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6145290e00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_7.pth
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762654)[0m partition loaded
[36m(ClientAppActor pid=762654)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9bf7650>, len val=500, len test=500
[36m(ClientAppActor pid=762653)[0m gpu in client
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762654)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m after loading model statdict
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 7 ACC is =  0.3058
round 7 loss is =  1.929596471786499
Current best ACC is =  0.3058
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 8: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 1 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925d83a40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Client 8 / 10
[36m(ClientAppActor pid=762607)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762650)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7438941a4f50>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc18be90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_8.pth
[36m(ClientAppActor pid=762650)[0m Client 2 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762648)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model
[36m(ClientAppActor pid=762658)[0m loading data
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fefab742f0>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 8 ACC is =  0.3152
round 8 loss is =  1.9041806221008302
Current best ACC is =  0.3152
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 9: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Client 5 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6145293ce0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Client 2 / 10
[36m(ClientAppActor pid=762658)[0m client calling
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762652)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925c949b0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 8] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762649)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61452f12b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_9.pth
[36m(ClientAppActor pid=762649)[0m Client 9 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model
[36m(ClientAppActor pid=762648)[0m loading data
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe53d11a30>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762648)[0m before loading model statdict
[36m(ClientAppActor pid=762648)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 9 ACC is =  0.3142
round 9 loss is =  1.8919284105300904
Round 10: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762655)[0m Client 6 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762650)[0m Client 7 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa75dba9f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762649)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77ab18d606e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 10 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_10.pth
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe538f3470>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 10 ACC is =  0.3226
round 10 loss is =  1.8578137040138245
Current best ACC is =  0.3226
Saving round 10 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 11: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 9 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5bef5c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 8 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762607)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14effa8e60>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762655)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6145290890>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 6] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_11.pth
[36m(ClientAppActor pid=762650)[0m Client 3 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925c94a10>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762657)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 11 ACC is =  0.3428
round 11 loss is =  1.8160989999771118
Current best ACC is =  0.3428
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 12: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Client 7 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762607)[0m Client 3 / 10
[36m(ClientAppActor pid=762607)[0m client calling
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5ba7f80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model
[36m(ClientAppActor pid=762648)[0m loading data
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m partition loaded
[36m(ClientAppActor pid=762607)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fefab74920>, len val=500, len test=500
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762648)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762648)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762648)[0m before loading model statdict
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m training started
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9c9ce60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_12.pth
[36m(ClientAppActor pid=762649)[0m Client 8 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762652)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a1596183050>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 12 ACC is =  0.3564
round 12 loss is =  1.7774423718452455
Current best ACC is =  0.3564
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 13: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Client 0 / 10
[36m(ClientAppActor pid=762658)[0m client calling
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa74bb0410>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 2 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model
[36m(ClientAppActor pid=762658)[0m loading data
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9278e15e0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762658)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762658)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75513164ef30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 13 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_13.pth
[36m(ClientAppActor pid=762650)[0m Client 6 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762657)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc7ed280>, len val=500, len test=500
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 13 ACC is =  0.3732
round 13 loss is =  1.7521006226539613
Current best ACC is =  0.3732
Saving round 13 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 14: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 6 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d614519dc40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 1 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925c97bc0>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa6bf9f7d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 14 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_14.pth
[36m(ClientAppActor pid=762655)[0m Client 3 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925d82330>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 14 ACC is =  0.3814
round 14 loss is =  1.7159148931503296
Current best ACC is =  0.3814
Saving round 14 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 15: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762649)[0m Client 3 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9cc8770>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a15961422d0>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762655)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61452f2990>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 15 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_15.pth
[36m(ClientAppActor pid=762649)[0m Client 0 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762607)[0m partition loaded
[36m(ClientAppActor pid=762607)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14f81eeb40>, len val=500, len test=500
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762607)[0m Available devices  1
[36m(ClientAppActor pid=762607)[0m Current cuda device  0
[36m(ClientAppActor pid=762607)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 15 ACC is =  0.3904
round 15 loss is =  1.6932781219482422
Current best ACC is =  0.3904
Saving round 15 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 16: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 7 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9bf5cd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 3 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bc0290>, len val=500, len test=500
[36m(ClientAppActor pid=762657)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d614534fa40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 16 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_16.pth
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9cc173080>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 16 ACC is =  0.396
round 16 loss is =  1.668896698951721
Current best ACC is =  0.396
Saving round 16 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 17: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762648)[0m Client 3 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551d81fb530>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Client 7 / 10
[36m(ClientAppActor pid=762658)[0m client calling
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model
[36m(ClientAppActor pid=762648)[0m loading data
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa74bb01a0>, len val=500, len test=500
[36m(ClientAppActor pid=762658)[0m gpu in client
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762658)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762658)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762658)[0m training started
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6145290b30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 17 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_17.pth
[36m(ClientAppActor pid=762650)[0m Client 1 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe5388ee40>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m after loading model statdict
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 17 ACC is =  0.4028
round 17 loss is =  1.6509153008461
Current best ACC is =  0.4028
Saving round 17 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 18: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 0 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74388bfe6000>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Client 5 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc2e4c80>, len val=500, len test=500
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 8] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762648)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762648)[0m before loading model statdict
[36m(ClientAppActor pid=762648)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m training started
[36m(ClientAppActor pid=762648)[0m number of epochs in this 2
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75514b567560>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 2] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_18.pth
[36m(ClientAppActor pid=762607)[0m Client 4 / 10
[36m(ClientAppActor pid=762607)[0m client calling
[36m(ClientAppActor pid=762652)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5db7ad0>, len val=500, len test=500
[36m(ClientAppActor pid=762607)[0m gpu in client
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762607)[0m Available devices  1
[36m(ClientAppActor pid=762607)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m after loading model statdict
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 18 ACC is =  0.402
round 18 loss is =  1.6392516136169433
Round 19: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m Client 6 / 10
[36m(ClientAppActor pid=762658)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743894090a70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925c949b0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde57fb3b0>, len val=500, len test=500
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m gpu in client
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=762653)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9c9cd10>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 2] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 19 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_19.pth
[36m(ClientAppActor pid=762650)[0m Client 8 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762654)[0m partition loaded
[36m(ClientAppActor pid=762654)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc03a1b0>, len val=500, len test=500
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m gpu in client
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m before loading model statdict
[36m(ClientAppActor pid=762648)[0m after loading model statdict
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 19 ACC is =  0.4116
round 19 loss is =  1.6181214213371278
Current best ACC is =  0.4116
Saving round 19 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 20: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa8c0a0f50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 4 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7438881afb90>, len val=500, len test=500
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 5] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m training started
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa74b04d70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 20 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_20.pth
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bf0230>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 20 ACC is =  0.421
round 20 loss is =  1.600414514541626
Current best ACC is =  0.421
Saving round 20 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 21: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 7 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6145258b30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Client 0 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m partition loaded
[36m(ClientAppActor pid=762654)[0m len partition= 5000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7438945e90a0>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762654)[0m Available devices  1
[36m(ClientAppActor pid=762654)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b924b6d6d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 8] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 21 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_21.pth
[36m(ClientAppActor pid=762650)[0m Client 2 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762657)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925d98fe0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 21 ACC is =  0.4294
round 21 loss is =  1.5758350849151612
Current best ACC is =  0.4294
Saving round 21 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 22: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa74bbc380>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 0 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9d8939460>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762655)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762655)[0m training started
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61453a4ec0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 22 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_22.pth
[36m(ClientAppActor pid=762654)[0m Client 1 / 10
[36m(ClientAppActor pid=762654)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model
[36m(ClientAppActor pid=762654)[0m loading data
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762654)[0m partition loaded
[36m(ClientAppActor pid=762654)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d614519df40>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m gpu in client
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762654)[0m Available devices  1
[36m(ClientAppActor pid=762654)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m before loading model statdict
[36m(ClientAppActor pid=762654)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 22 ACC is =  0.427
round 22 loss is =  1.5697222471237182
Round 23: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762648)[0m Client 4 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762650)[0m Client 1 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde57ad940>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9cc173500>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc299190>, len val=500, len test=500
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a15961830b0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 23 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_23.pth
[36m(ClientAppActor pid=762658)[0m Client 5 / 10
[36m(ClientAppActor pid=762658)[0m client calling
[36m(ClientAppActor pid=762607)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model
[36m(ClientAppActor pid=762658)[0m loading data
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa74b9fb90>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 23 ACC is =  0.4292
round 23 loss is =  1.5614437341690064
Round 24: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 7 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762652)[0m Client 2 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9b2caa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 2] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc7eff80>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 24 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_24.pth
[36m(ClientAppActor pid=762650)[0m Client 6 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa6bf51970>, len val=500, len test=500
[36m(ClientAppActor pid=762658)[0m gpu in client
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762658)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 24 ACC is =  0.4368
round 24 loss is =  1.5440038442611694
Current best ACC is =  0.4368
Saving round 24 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 25: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Client 4 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9c355e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 3 / 10
[36m(ClientAppActor pid=762654)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9243de630>, len val=500, len test=500
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762655)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762655)[0m training started
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61451e8470>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 2] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 25 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_25.pth
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b924b6e9c0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 25 ACC is =  0.4468
round 25 loss is =  1.526805818080902
Current best ACC is =  0.4468
Saving round 25 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 26: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Client 8 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa75cf55b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Client 6 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bc0050>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe539497f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 5] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 26 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_26.pth
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m  5000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe5388cf50>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762648)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 26 ACC is =  0.4504
round 26 loss is =  1.517884659767151
Current best ACC is =  0.4504
Saving round 26 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 27: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762652)[0m Client 7 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14ec15e870>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14ec15ddf0>, len val=500, len test=500
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762655)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762655)[0m training started
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=762652)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74388bf8de80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 27 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_27.pth
[36m(ClientAppActor pid=762652)[0m Client 2 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762607)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743888183a10>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 27 ACC is =  0.4486
round 27 loss is =  1.5137385725975037
Round 28: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 0 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762650)[0m Client 6 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe5388e660>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m [Client 6] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551317fe600>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 28 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_28.pth
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14ec192ed0>, len val=500, len test=500
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 28 ACC is =  0.46
round 28 loss is =  1.5011523008346557
Current best ACC is =  0.46
Saving round 28 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 29: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Client 8 / 10
[36m(ClientAppActor pid=762658)[0m client calling
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x755131bad130>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa6bf011f0>, len val=500, len test=500
[36m(ClientAppActor pid=762658)[0m gpu in client
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 5] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762658)[0m training started
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde78aea50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 6] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 29 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_29.pth
[36m(ClientAppActor pid=762650)[0m Client 8 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762652)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762648)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bc2ff0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 29 ACC is =  0.4536
round 29 loss is =  1.495234215259552
Round 30: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762652)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 4 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 6 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7438940569f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762653)[0m training started
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a1510195ee0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 30 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_30.pth
[36m(ClientAppActor pid=762650)[0m Client 2 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762607)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bc3ec0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 30 ACC is =  0.4624
round 30 loss is =  1.485250461101532
Current best ACC is =  0.4624
Saving round 30 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 31: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Client 7 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe4677d790>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 3 / 10
[36m(ClientAppActor pid=762654)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74388bfa7a10>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 5] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde56969f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 8] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 31 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_31.pth
[36m(ClientAppActor pid=762649)[0m Client 2 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e8982bb14f0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 31 ACC is =  0.4602
round 31 loss is =  1.480818474292755
Round 32: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 5 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762655)[0m Client 9 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5bef140>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m [Client 5] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9cf1010>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 6] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762653)[0m Available devices  1
[36m(ClientAppActor pid=762653)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762653)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 32 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_32.pth
[36m(ClientAppActor pid=762650)[0m Client 0 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762607)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe53dad0d0>, len val=500, len test=500
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 32 ACC is =  0.4606
round 32 loss is =  1.4841875076293944
Round 33: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762650)[0m Client 0 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 8 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9d88fb890>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61451e8b60>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 33 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_33.pth
[36m(ClientAppActor pid=762655)[0m Client 0 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762655)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client loading model
[36m(ClientAppActor pid=762655)[0m loading data
[36m(ClientAppActor pid=762655)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14effb9190>, len val=500, len test=500
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 33 ACC is =  0.4706
round 33 loss is =  1.4596883177757263
Current best ACC is =  0.4706
Saving round 33 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 34: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762650)[0m Client 1 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x755131db76b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Client 3 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762648)[0m client loading model
[36m(ClientAppActor pid=762648)[0m loading data
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b930107350>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa74b05760>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 2] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 34 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_34.pth
[36m(ClientAppActor pid=762649)[0m Client 0 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762607)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe539ec950>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 34 ACC is =  0.4768
round 34 loss is =  1.4419319868087768
Current best ACC is =  0.4768
Saving round 34 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 35: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762648)[0m Client 7 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551317fe810>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model
[36m(ClientAppActor pid=762648)[0m loading data
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc18a930>, len val=500, len test=500
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762648)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m training started
[36m(ClientAppActor pid=762648)[0m number of epochs in this 2
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa6bf535c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 6] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 35 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_35.pth
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9bf5550>, len val=500, len test=500
[36m(ClientAppActor pid=762653)[0m gpu in client
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762653)[0m Available devices  1
[36m(ClientAppActor pid=762653)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762657)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 35 ACC is =  0.4808
round 35 loss is =  1.4396645903587342
Current best ACC is =  0.4808
Saving round 35 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 36: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 2 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61e0177fb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Client 9 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa75672870>, len val=500, len test=500
[36m(ClientAppActor pid=762658)[0m gpu in client
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762658)[0m [Client 5] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762658)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762658)[0m training started
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde56790a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 36 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_36.pth
[36m(ClientAppActor pid=762657)[0m Client 2 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762652)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client loading model
[36m(ClientAppActor pid=762657)[0m loading data
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa756a8d10>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 36 ACC is =  0.483
round 36 loss is =  1.42553790807724
Current best ACC is =  0.483
Saving round 36 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 37: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762652)[0m Client 1 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe5388ff20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model
[36m(ClientAppActor pid=762658)[0m loading data
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925de8110>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762648)[0m [Client 6] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762648)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3da017b110>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 37 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_37.pth
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14f80a0830>, len val=500, len test=500
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762648)[0m before loading model statdict
[36m(ClientAppActor pid=762648)[0m after loading model statdict
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 37 ACC is =  0.4894
round 37 loss is =  1.4272441506385802
Current best ACC is =  0.4894
Saving round 37 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 38: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Client 1 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762648)[0m Client 8 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551e483c6b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client loading model
[36m(ClientAppActor pid=762657)[0m loading data
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762657)[0m partition loaded
[36m(ClientAppActor pid=762657)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75514814c890>, len val=500, len test=500
[36m(ClientAppActor pid=762657)[0m gpu in client
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762657)[0m Available devices  1
[36m(ClientAppActor pid=762657)[0m Current cuda device  0
[36m(ClientAppActor pid=762657)[0m [Client 1] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762657)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762657)[0m before loading model statdict
[36m(ClientAppActor pid=762657)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m training started
[36m(ClientAppActor pid=762657)[0m number of epochs in this 2
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5679a90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 2] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 38 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_38.pth
[36m(ClientAppActor pid=762652)[0m Client 3 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client loading model
[36m(ClientAppActor pid=762655)[0m loading data
[36m(ClientAppActor pid=762655)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a15a21ae570>, len val=500, len test=500
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 38 ACC is =  0.4888
round 38 loss is =  1.4177359700202943
Round 39: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 8 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762652)[0m Client 6 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77ab13f86ea0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 8] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14f80a1880>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 5] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 39 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_39.pth
[36m(ClientAppActor pid=762649)[0m Client 7 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762655)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model
[36m(ClientAppActor pid=762658)[0m loading data
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf8b45280>, len val=500, len test=500
[36m(ClientAppActor pid=762653)[0m gpu in client
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762653)[0m Available devices  1
[36m(ClientAppActor pid=762653)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762653)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 39 ACC is =  0.492
round 39 loss is =  1.4113639712333679
Current best ACC is =  0.492
Saving round 39 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 40: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 1 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61e0177260>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Client 5 / 10
[36m(ClientAppActor pid=762607)[0m client calling
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bf05c0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m [Client 5] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762607)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a1596182e70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 40 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_40.pth
[36m(ClientAppActor pid=762649)[0m Client 4 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762655)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe4679b4d0>, len val=500, len test=500
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 40 ACC is =  0.4902
round 40 loss is =  1.4123934864997865
Round 41: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m Client 1 / 10
[36m(ClientAppActor pid=762658)[0m client calling
[36m(ClientAppActor pid=762650)[0m Client 6 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa6bfbf890>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 6] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m training started
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x755131bac740>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 3] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762654)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6144b933b0>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m gpu in client
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762654)[0m Available devices  1
[36m(ClientAppActor pid=762654)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m [Client 7] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 41 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_41.pth
[36m(ClientAppActor pid=762648)[0m Client 7 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762653)[0m partition loaded
[36m(ClientAppActor pid=762653)[0m len partition= 5000
[36m(ClientAppActor pid=762652)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e896f57b200>, len val=500, len test=500
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762648)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762648)[0m before loading model statdict
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m after loading model statdict
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 41 ACC is =  0.4882
round 41 loss is =  1.4097390055656434
Round 42: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 6 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa75773e60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743888131a00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762652)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 2] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 42 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_42.pth
[36m(ClientAppActor pid=762649)[0m Client 5 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe4677d790>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 42 ACC is =  0.502
round 42 loss is =  1.380628776550293
Current best ACC is =  0.502
Saving round 42 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 43: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 1 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6145258b30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925cf6810>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762655)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe538f1130>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 43 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_43.pth
[36m(ClientAppActor pid=762650)[0m Client 8 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model
[36m(ClientAppActor pid=762648)[0m loading data
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762657)[0m partition loaded
[36m(ClientAppActor pid=762657)[0m len partition= 5000
[36m(ClientAppActor pid=762652)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551317fc650>, len val=500, len test=500
[36m(ClientAppActor pid=762653)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m gpu in client
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762658)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 43 ACC is =  0.505
round 43 loss is =  1.3704201698303222
Current best ACC is =  0.505
Saving round 43 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 44: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 3 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a1596182e40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Client 2 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762655)[0m client loading model
[36m(ClientAppActor pid=762655)[0m loading data
[36m(ClientAppActor pid=762655)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925cf6810>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6145290ce0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 6] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 44 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_44.pth
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bc2ed0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 44 ACC is =  0.5072
round 44 loss is =  1.3679669976234436
Current best ACC is =  0.5072
Saving round 44 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 45: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Client 3 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6144b93c20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Client 5 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model
[36m(ClientAppActor pid=762648)[0m loading data
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925c94ad0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762655)[0m training started
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cfb7f95e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 45 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_45.pth
[36m(ClientAppActor pid=762649)[0m Client 3 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925c94e00>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 45 ACC is =  0.5126
round 45 loss is =  1.3554614782333374
Current best ACC is =  0.5126
Saving round 45 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 46: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762649)[0m Client 3 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc299a90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7438881ad460>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762658)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc08a750>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 0] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 46 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_46.pth
[36m(ClientAppActor pid=762655)[0m Client 0 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762657)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client loading model
[36m(ClientAppActor pid=762655)[0m loading data
[36m(ClientAppActor pid=762655)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925ba4da0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 46 ACC is =  0.5084
round 46 loss is =  1.364134430885315
Round 47: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 3 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762650)[0m Client 7 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61452f12b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14efff5910>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 47 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_47.pth
[36m(ClientAppActor pid=762650)[0m Client 7 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762657)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model
[36m(ClientAppActor pid=762658)[0m loading data
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14f8185010>, len val=500, len test=500
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m gpu in client
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 47 ACC is =  0.5088
round 47 loss is =  1.347287392616272
Round 48: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 3 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762648)[0m Client 4 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6144b47440>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762649)[0m loading data[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 6[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9cc173590>, len val=500, len test=500
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 9[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e89797ca600>, len val=500, len test=500
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 3] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa756a88c0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 9] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 48 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_48.pth
[36m(ClientAppActor pid=762657)[0m Client 2 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client loading model
[36m(ClientAppActor pid=762657)[0m loading data
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x755133994560>, len val=500, len test=500
[36m(ClientAppActor pid=762657)[0m gpu in client
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762657)[0m Available devices  1
[36m(ClientAppActor pid=762657)[0m Current cuda device  0
[36m(ClientAppActor pid=762657)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m before loading model statdict
[36m(ClientAppActor pid=762657)[0m after loading model statdict
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 48 ACC is =  0.5164
round 48 loss is =  1.3365296363830566
Current best ACC is =  0.5164
Saving round 48 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 49: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743936172fc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 8 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925c94980>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 4] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77ab13f86f60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 7] fit, config: {'lr': 0.01, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 49 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_49.pth
[36m(ClientAppActor pid=762657)[0m Client 4 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc089fd0>, len val=500, len test=500
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 49 ACC is =  0.5174
round 49 loss is =  1.3396949410438537
Current best ACC is =  0.5174
Saving round 49 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 50: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.001
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa6bf02c60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 6 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9cff06e10>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14ef957770>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=762655)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762655)[0m [Client 8] set_parameters
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 50 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_50.pth
[36m(ClientAppActor pid=762652)[0m Client 2 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762655)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762649)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743888132060>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 50 ACC is =  0.5268
round 50 loss is =  1.3199633598327636
Current best ACC is =  0.5268
Saving round 50 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 51: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762649)[0m Client 2 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61451aaed0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b924b8e060>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762649)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m training started
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf8b46570>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 51 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_51.pth
[36m(ClientAppActor pid=762650)[0m Client 7 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762653)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74388b9570e0>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 51 ACC is =  0.5228
round 51 loss is =  1.3201085448265075
Round 52: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 6 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762653)[0m Client 0 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75513164d0d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762653)[0m training started
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a15a99987d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 52 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_52.pth
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762657)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe5383f380>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 52 ACC is =  0.5238
round 52 loss is =  1.3176316976547242
Round 53: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Client 5 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762607)[0m Client 3 / 10
[36m(ClientAppActor pid=762607)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61453978c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m partition loaded
[36m(ClientAppActor pid=762653)[0m len partition= 5000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m training started
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe5388e2d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=762649)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 53 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_53.pth
[36m(ClientAppActor pid=762657)[0m Client 2 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model
[36m(ClientAppActor pid=762648)[0m loading data
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b924b8e780>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 53 ACC is =  0.5238
round 53 loss is =  1.3172390580177307
Round 54: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 6 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762653)[0m Client 1 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cfb7f9130>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m training started
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6145208890>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 54 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_54.pth
[36m(ClientAppActor pid=762655)[0m Client 7 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client loading model
[36m(ClientAppActor pid=762655)[0m loading data
[36m(ClientAppActor pid=762655)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743894091cd0>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 54 ACC is =  0.525
round 54 loss is =  1.3154002547264099
Round 55: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 1 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 0 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551337ed790>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fef8d7b170>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 55 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_55.pth
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc06e2d0>, len val=500, len test=500
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762648)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 55 ACC is =  0.5254
round 55 loss is =  1.315307605266571
Round 56: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 7 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762652)[0m Client 5 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77ab13f87470>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m partition loaded
[36m(ClientAppActor pid=762607)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m training started
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc1b2d50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 8] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=762648)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762648)[0m [Client 9] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 56 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_56.pth
[36m(ClientAppActor pid=762652)[0m Client 0 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762648)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762607)[0m partition loaded
[36m(ClientAppActor pid=762607)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743949696d50>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m gpu in client
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762607)[0m Available devices  1
[36m(ClientAppActor pid=762607)[0m Current cuda device  0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 56 ACC is =  0.5266
round 56 loss is =  1.3139870166778564
Round 57: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 5 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762655)[0m Client 9 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551337ed790>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m training started
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b924b8f7d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=762650)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 57 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_57.pth
[36m(ClientAppActor pid=762652)[0m Client 3 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762648)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925d0f350>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 57 ACC is =  0.5266
round 57 loss is =  1.3133835911750793
Round 58: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762607)[0m client loading model
[36m(ClientAppActor pid=762607)[0m loading data
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x755131bfd580>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925ba45f0>, len val=500, len test=500
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3d7c2981d0>, len val=500, len test=500
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m training started
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde57ad070>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 58 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_58.pth
[36m(ClientAppActor pid=762657)[0m Client 4 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762649)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client loading model
[36m(ClientAppActor pid=762657)[0m loading data
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762657)[0m partition loaded
[36m(ClientAppActor pid=762657)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x755131cbc950>, len val=500, len test=500
[36m(ClientAppActor pid=762657)[0m gpu in client
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762657)[0m Available devices  1
[36m(ClientAppActor pid=762657)[0m Current cuda device  0
[36m(ClientAppActor pid=762657)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m before loading model statdict
[36m(ClientAppActor pid=762657)[0m after loading model statdict
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 58 ACC is =  0.5274
round 58 loss is =  1.312287485599518
Current best ACC is =  0.5274
Saving round 58 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 59: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762649)[0m Client 0 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe539ec950>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743894090d70>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe469ae840>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 59 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_59.pth
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bf06b0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 59 ACC is =  0.5254
round 59 loss is =  1.3114280700683594
Round 60: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 7 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762653)[0m Client 3 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61452f2600>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m partition loaded
[36m(ClientAppActor pid=762653)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762648)[0m training started
[36m(ClientAppActor pid=762648)[0m number of epochs in this 2
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75513164f2c0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 60 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_60.pth
[36m(ClientAppActor pid=762650)[0m Client 1 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762653)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9278c48f0>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 60 ACC is =  0.5262
round 60 loss is =  1.31104736328125
Round 61: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762649)[0m Client 1 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5cf1c40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762607)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe538f1970>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m training started
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc1b0fe0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 61 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_61.pth
[36m(ClientAppActor pid=762654)[0m Client 5 / 10
[36m(ClientAppActor pid=762654)[0m client calling
[36m(ClientAppActor pid=762648)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model
[36m(ClientAppActor pid=762654)[0m loading data
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762654)[0m partition loaded
[36m(ClientAppActor pid=762654)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61451e9280>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m gpu in client
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762654)[0m Available devices  1
[36m(ClientAppActor pid=762654)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762654)[0m before loading model statdict
[36m(ClientAppActor pid=762654)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 61 ACC is =  0.5272
round 61 loss is =  1.3100759267807007
Round 62: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 2 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 8 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde57a3f20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa757f98b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 62 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_62.pth
[36m(ClientAppActor pid=762650)[0m Client 7 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe5383ca70>, len val=500, len test=500
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m gpu in client
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762653)[0m Available devices  1
[36m(ClientAppActor pid=762653)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 62 ACC is =  0.5268
round 62 loss is =  1.308955192565918
Round 63: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762648)[0m Client 0 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762655)[0m Client 6 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762648)[0m client loading model
[36m(ClientAppActor pid=762648)[0m loading data
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e896f57b3e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88f6ba9850>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7438940eb050>, len val=500, len test=500
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762648)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762648)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762648)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3da017b530>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 63 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_63.pth
[36m(ClientAppActor pid=762653)[0m Client 0 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bbcb90>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 63 ACC is =  0.528
round 63 loss is =  1.3081248164176942
Current best ACC is =  0.528
Saving round 63 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 64: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc3ae2d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762653)[0m partition loaded
[36m(ClientAppActor pid=762653)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743894091cd0>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762653)[0m Available devices  1
[36m(ClientAppActor pid=762653)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762653)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762653)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m training started
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc2e6270>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 64 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_64.pth
[36m(ClientAppActor pid=762650)[0m Client 3 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b927778e60>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 64 ACC is =  0.5276
round 64 loss is =  1.3072731852531434
Round 65: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 2 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5739a30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925b94530>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 7] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x755131d860f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 4] set_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 3x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 65 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_65.pth
[36m(ClientAppActor pid=762650)[0m Client 8 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762657)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925d0f350>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 65 ACC is =  0.5276
round 65 loss is =  1.3066290616989136
Round 66: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 8 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 2 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9b9d3d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m training started
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3da017b170>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762653)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762653)[0m Available devices  1
[36m(ClientAppActor pid=762653)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762653)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 66 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_66.pth
[36m(ClientAppActor pid=762652)[0m Client 0 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762652)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 5000
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b924b8e6c0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 66 ACC is =  0.5276
round 66 loss is =  1.305849289894104
Round 67: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3da017b4a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b924b3fa10>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abe91770410>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 67 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_67.pth
[36m(ClientAppActor pid=762650)[0m Client 8 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762607)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b924b8ec30>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 67 ACC is =  0.5284
round 67 loss is =  1.3052963256835937
Current best ACC is =  0.5284
Saving round 67 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 68: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551317fe5d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 7 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe53ea8ec0>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762653)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762653)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m training started
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762652)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74388bfb3bc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 68 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_68.pth
[36m(ClientAppActor pid=762650)[0m Client 0 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762655)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925cf6810>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 68 ACC is =  0.528
round 68 loss is =  1.3042594075202942
Round 69: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Client 4 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762658)[0m Client 0 / 10
[36m(ClientAppActor pid=762658)[0m client calling
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa756a8530>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m partition loaded
[36m(ClientAppActor pid=762657)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762655)[0m training started
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9c9cef0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=762653)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762653)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 69 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_69.pth
[36m(ClientAppActor pid=762650)[0m Client 1 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762653)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bbed80>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 69 ACC is =  0.5298
round 69 loss is =  1.3030876398086548
Current best ACC is =  0.5298
Saving round 69 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 70: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 4 / 10
[36m(ClientAppActor pid=762654)[0m client calling
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa74bcb2f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762654)[0m partition loaded
[36m(ClientAppActor pid=762654)[0m len partition= 5000
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7438940911f0>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925b96e40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 70 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_70.pth
[36m(ClientAppActor pid=762649)[0m Client 2 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762607)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925d9b8c0>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 70 ACC is =  0.5308
round 70 loss is =  1.3025121092796326
Current best ACC is =  0.5308
Saving round 70 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 71: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 7 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abe901ff050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Client 1 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743894957fe0>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9ba8c80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 71 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_71.pth
[36m(ClientAppActor pid=762650)[0m Client 6 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762653)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa75794b00>, len val=500, len test=500
[36m(ClientAppActor pid=762658)[0m gpu in client
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 71 ACC is =  0.529
round 71 loss is =  1.3016466736793517
Round 72: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Client 3 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 1 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743936173f80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m training started
[36m(ClientAppActor pid=762648)[0m number of epochs in this 2
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61451e8ce0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 72 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_72.pth
[36m(ClientAppActor pid=762653)[0m Client 6 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762653)[0m partition loaded
[36m(ClientAppActor pid=762653)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9b9f350>, len val=500, len test=500
[36m(ClientAppActor pid=762653)[0m gpu in client
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762653)[0m Available devices  1
[36m(ClientAppActor pid=762653)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762653)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 72 ACC is =  0.5318
round 72 loss is =  1.3012717723846436
Current best ACC is =  0.5318
Saving round 72 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 73: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762652)[0m Client 1 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14ec1418e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 3 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925b21cd0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6144b46510>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 73 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_73.pth
[36m(ClientAppActor pid=762650)[0m Client 7 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762607)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client loading model
[36m(ClientAppActor pid=762655)[0m loading data
[36m(ClientAppActor pid=762655)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fef8d7bf20>, len val=500, len test=500
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 73 ACC is =  0.53
round 73 loss is =  1.3002485990524293
Round 74: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762653)[0m Client 0 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9d1b170>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m training started
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6144b93c20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 74 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_74.pth
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bc14f0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 74 ACC is =  0.5316
round 74 loss is =  1.2995047211647033
Round 75: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 5 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d614519cdd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b92436b230>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fefab505f0>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762649)[0m training started
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743894091cd0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 75 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_75.pth
[36m(ClientAppActor pid=762657)[0m Client 0 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client loading model
[36m(ClientAppActor pid=762657)[0m loading data
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762657)[0m partition loaded
[36m(ClientAppActor pid=762657)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9243a2540>, len val=500, len test=500
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m gpu in client
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762653)[0m Available devices  1
[36m(ClientAppActor pid=762653)[0m Current cuda device  0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762657)[0m before loading model statdict
[36m(ClientAppActor pid=762657)[0m after loading model statdict
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe4679b710>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 75 ACC is =  0.5318
round 75 loss is =  1.2985090017318726
Round 76: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762655)[0m Client 5 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762655)[0m client loading model
[36m(ClientAppActor pid=762655)[0m loading data
[36m(ClientAppActor pid=762655)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762649)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762654)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14ec142150>, len val=500, len test=500
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762655)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762655)[0m training started
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde57f8860>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 76 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_76.pth
[36m(ClientAppActor pid=762652)[0m Client 7 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74389417a120>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 76 ACC is =  0.532
round 76 loss is =  1.2976735472679137
Current best ACC is =  0.532
Saving round 76 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 77: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762655)[0m Client 0 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14effbe480>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b924b3c980>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762657)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762657)[0m before loading model statdict
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762658)[0m training started
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc3ae2d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 77 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_77.pth
[36m(ClientAppActor pid=762653)[0m Client 3 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762655)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743894090aa0>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 77 ACC is =  0.533
round 77 loss is =  1.2968296527862548
Current best ACC is =  0.533
Saving round 77 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 78: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 2 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61451921e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 0 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m partition loaded
[36m(ClientAppActor pid=762653)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m 
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7438941a4b60>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6145290950>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 78 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_78.pth
[36m(ClientAppActor pid=762650)[0m Client 2 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc18b560>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762653)[0m before loading model statdict
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m after loading model statdict
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 78 ACC is =  0.533
round 78 loss is =  1.296161985397339
Round 79: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 3 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762650)[0m Client 1 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551d81fb590>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde57b5910>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 79 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_79.pth
[36m(ClientAppActor pid=762653)[0m Client 0 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762653)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762653)[0m partition loaded
[36m(ClientAppActor pid=762653)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9b9d370>, len val=500, len test=500
[36m(ClientAppActor pid=762653)[0m gpu in client
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762653)[0m Available devices  1
[36m(ClientAppActor pid=762653)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762653)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m after loading model statdict
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 79 ACC is =  0.5332
round 79 loss is =  1.2949791431427002
Current best ACC is =  0.5332
Saving round 79 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 80: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762648)[0m Client 6 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5cb9130>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model
[36m(ClientAppActor pid=762648)[0m loading data
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762657)[0m partition loaded
[36m(ClientAppActor pid=762657)[0m len partition= 5000
[36m(ClientAppActor pid=762649)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74388bfe4050>, len val=500, len test=500
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m gpu in client
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762657)[0m Available devices  1
[36m(ClientAppActor pid=762657)[0m Current cuda device  0
[36m(ClientAppActor pid=762657)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762657)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61451eb260>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 80 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_80.pth
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bc13d0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 80 ACC is =  0.5332
round 80 loss is =  1.2948994755744934
Round 81: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762650)[0m Client 8 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743949694740>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61eb7a1b20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 81 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_81.pth
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925b225d0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 81 ACC is =  0.5332
round 81 loss is =  1.2937167048454286
Round 82: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762649)[0m Client 7 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14f80ed010>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m training started
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61447a5550>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 82 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_82.pth
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925b97cb0>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m gpu in client
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 82 ACC is =  0.5336
round 82 loss is =  1.293093740940094
Current best ACC is =  0.5336
Saving round 82 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 83: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Client 4 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61eb7a1b20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 8 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762648)[0m client loading model
[36m(ClientAppActor pid=762648)[0m loading data
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc30b050>, len val=500, len test=500
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762648)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762648)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762648)[0m before loading model statdict
[36m(ClientAppActor pid=762648)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m training started
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551d81fb200>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 83 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_83.pth
[36m(ClientAppActor pid=762654)[0m Client 7 / 10
[36m(ClientAppActor pid=762654)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=762653)[0m partition loaded
[36m(ClientAppActor pid=762653)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf9db1f70>, len val=500, len test=500
[36m(ClientAppActor pid=762657)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 83 ACC is =  0.5334
round 83 loss is =  1.2924589395523072
Round 84: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 7 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 8 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5df9940>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m training started
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa756a92b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 3] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 84 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_84.pth
[36m(ClientAppActor pid=762650)[0m Client 0 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925d806e0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa756a9250>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 84 ACC is =  0.5344
round 84 loss is =  1.2920081615447998
Current best ACC is =  0.5344
Saving round 84 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 85: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762652)[0m Client 5 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925c602c0>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m training started
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe53d9f830>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 85 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_85.pth
[36m(ClientAppActor pid=762654)[0m Client 1 / 10
[36m(ClientAppActor pid=762654)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9cc1733e0>, len val=500, len test=500
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 85 ACC is =  0.533
round 85 loss is =  1.2914963245391846
Round 86: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 7 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa756a86b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m training started
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5696e40>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 86 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_86.pth
[36m(ClientAppActor pid=762650)[0m Client 1 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762648)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b924b3cb90>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 86 ACC is =  0.5356
round 86 loss is =  1.2902012705802917
Current best ACC is =  0.5356
Saving round 86 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 87: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Client 5 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77ab24810980>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Client 4 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762652)[0m client loading model
[36m(ClientAppActor pid=762652)[0m loading data
[36m(ClientAppActor pid=762652)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x755131698e00>, len val=500, len test=500
[36m(ClientAppActor pid=762657)[0m gpu in client
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762657)[0m Available devices  1
[36m(ClientAppActor pid=762657)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762648)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762648)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m training started
[36m(ClientAppActor pid=762657)[0m number of epochs in this 2
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d614478f260>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 87 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_87.pth
[36m(ClientAppActor pid=762650)[0m Client 2 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client loading model
[36m(ClientAppActor pid=762607)[0m loading data
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc25cc20>, len val=500, len test=500
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762648)[0m before loading model statdict
[36m(ClientAppActor pid=762648)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 87 ACC is =  0.5328
round 87 loss is =  1.2894269108772278
Round 88: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 1 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 3 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d614478db20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61eae3c920>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 88 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_88.pth
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925c943e0>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 88 ACC is =  0.536
round 88 loss is =  1.2884070158004761
Current best ACC is =  0.536
Saving round 88 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 89: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762648)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Client 6 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88d09b19a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Client 3 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743936173230>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa6bf501d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 89 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_89.pth
[36m(ClientAppActor pid=762657)[0m Client 0 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762657)[0m partition loaded
[36m(ClientAppActor pid=762657)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74388bfb2780>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m gpu in client
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762657)[0m Available devices  1
[36m(ClientAppActor pid=762657)[0m Current cuda device  0
[36m(ClientAppActor pid=762657)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=762657)[0m before loading model statdict
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 89 ACC is =  0.5368
round 89 loss is =  1.2877041220664978
Current best ACC is =  0.5368
Saving round 89 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 90: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 2 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cfb7f95e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 3 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b927779910>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61eae3da30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 90 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_90.pth
[36m(ClientAppActor pid=762648)[0m Client 8 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m client loading model
[36m(ClientAppActor pid=762648)[0m loading data
[36m(ClientAppActor pid=762648)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9cc173530>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762648)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762648)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762648)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762648)[0m Available devices  1
[36m(ClientAppActor pid=762648)[0m Current cuda device  0
[36m(ClientAppActor pid=762648)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762648)[0m before loading model statdict
[36m(ClientAppActor pid=762648)[0m after loading model statdict
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 90 ACC is =  0.5362
round 90 loss is =  1.287186086177826
Round 91: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762652)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 0 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762648)[0m Client 9 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61e0177140>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762649)[0m training started
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde7722b40>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=762607)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 91 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_91.pth
[36m(ClientAppActor pid=762655)[0m Client 2 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762607)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client loading model
[36m(ClientAppActor pid=762655)[0m loading data
[36m(ClientAppActor pid=762655)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762655)[0m partition loaded
[36m(ClientAppActor pid=762655)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14f897d250>, len val=500, len test=500
[36m(ClientAppActor pid=762655)[0m gpu in client
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762655)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762655)[0m Available devices  1
[36m(ClientAppActor pid=762655)[0m Current cuda device  0
[36m(ClientAppActor pid=762655)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 91 ACC is =  0.5368
round 91 loss is =  1.2863686680793762
Round 92: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762649)[0m Client 4 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762652)[0m Client 6 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7438881b3560>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9243dcf20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=762650)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 92 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_92.pth
[36m(ClientAppActor pid=762652)[0m Client 9 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762649)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x74388bfb0260>, len val=500, len test=500
[36m(ClientAppActor pid=762652)[0m gpu in client
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762652)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762652)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762652)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762652)[0m Available devices  1
[36m(ClientAppActor pid=762652)[0m Current cuda device  0
[36m(ClientAppActor pid=762652)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=762652)[0m before loading model statdict
[36m(ClientAppActor pid=762652)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 92 ACC is =  0.5364
round 92 loss is =  1.2857589364051818
Round 93: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762650)[0m Client 2 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe5388ee40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762657)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 2] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x755131bad0a0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 93 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_93.pth
[36m(ClientAppActor pid=762650)[0m Client 9 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client loading model
[36m(ClientAppActor pid=762607)[0m loading data
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa74b05a00>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762658)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 93 ACC is =  0.5372
round 93 loss is =  1.2850988745689391
Current best ACC is =  0.5372
Saving round 93 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 94: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762650)[0m Client 8 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61eae3ca70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe469b1e50>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762649)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m training started
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde41485f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 94 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_94.pth
[36m(ClientAppActor pid=762658)[0m Client 5 / 10
[36m(ClientAppActor pid=762658)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model
[36m(ClientAppActor pid=762658)[0m loading data
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa6bf01f10>, len val=500, len test=500
[36m(ClientAppActor pid=762658)[0m gpu in client
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 94 ACC is =  0.5362
round 94 loss is =  1.2847039937973022
Round 95: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 3 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762650)[0m Client 6 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cf83a9f10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m partition loaded
[36m(ClientAppActor pid=762653)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 4] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa74bb2930>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 95 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_95.pth
[36m(ClientAppActor pid=762649)[0m Client 2 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762658)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m client loading model
[36m(ClientAppActor pid=762649)[0m loading data
[36m(ClientAppActor pid=762649)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76fe538f3d10>, len val=500, len test=500
[36m(ClientAppActor pid=762649)[0m gpu in client
[36m(ClientAppActor pid=762649)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762649)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762649)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762649)[0m Available devices  1
[36m(ClientAppActor pid=762649)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=762649)[0m before loading model statdict
[36m(ClientAppActor pid=762649)[0m after loading model statdict
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 95 ACC is =  0.5362
round 95 loss is =  1.2836589455604552
Round 96: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762653)[0m Client 1 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762653)[0m client loading model
[36m(ClientAppActor pid=762653)[0m loading data
[36m(ClientAppActor pid=762653)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925bf2d50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m partition loaded
[36m(ClientAppActor pid=762653)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b9ce14b0b0>, len val=500, len test=500
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m gpu in client
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762653)[0m Available devices  1
[36m(ClientAppActor pid=762653)[0m Current cuda device  0
[36m(ClientAppActor pid=762653)[0m [Client 1] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762653)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762653)[0m before loading model statdict
[36m(ClientAppActor pid=762653)[0m after loading model statdict
[36m(ClientAppActor pid=762653)[0m training started
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5c1a690>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 9] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=762607)[0m partition loaded
[36m(ClientAppActor pid=762607)[0m len partition= 5000
[36m(ClientAppActor pid=762607)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762607)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762607)[0m before loading model statdict
[36m(ClientAppActor pid=762607)[0m after loading model statdict
[36m(ClientAppActor pid=762607)[0m training started
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 96 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_96.pth
[36m(ClientAppActor pid=762607)[0m Client 0 / 10
[36m(ClientAppActor pid=762607)[0m client calling
[36m(ClientAppActor pid=762607)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client loading model
[36m(ClientAppActor pid=762607)[0m loading data
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=762607)[0m partition loaded
[36m(ClientAppActor pid=762607)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925cf7230>, len val=500, len test=500
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m gpu in client
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m 
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 96 ACC is =  0.5364
round 96 loss is =  1.283057165145874
Round 97: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m Client 6 / 10
[36m(ClientAppActor pid=762648)[0m client calling
[36m(ClientAppActor pid=762654)[0m Client 4 / 10
[36m(ClientAppActor pid=762654)[0m client calling
[36m(ClientAppActor pid=762652)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x743888183f50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762652)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded
[36m(ClientAppActor pid=762649)[0m len partition= 5000
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762650)[0m training started
[36m(ClientAppActor pid=762650)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5ba5070>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762607)[0m [Client 8] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 97 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_97.pth
[36m(ClientAppActor pid=762650)[0m Client 5 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=762657)[0m partition loaded
[36m(ClientAppActor pid=762657)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x755131bacce0>, len val=500, len test=500
[36m(ClientAppActor pid=762657)[0m gpu in client
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762657)[0m Available devices  1
[36m(ClientAppActor pid=762657)[0m Current cuda device  0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m before loading model statdict
[36m(ClientAppActor pid=762655)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 97 ACC is =  0.537
round 97 loss is =  1.2824071764945983
Round 98: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 4 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762649)[0m Client 2 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61453a4e60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 7] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m training started
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=762607)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7abde5bef5c0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762607)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762607)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 0] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762607)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 98 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_98.pth
[36m(ClientAppActor pid=762657)[0m Client 9 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762607)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client loading model
[36m(ClientAppActor pid=762657)[0m loading data
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b924b3cb90>, len val=500, len test=500
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m gpu in client
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762650)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 98 ACC is =  0.5382
round 98 loss is =  1.2815867900848388
Current best ACC is =  0.5382
Saving round 98 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 99: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762658)[0m Client 6 / 10
[36m(ClientAppActor pid=762658)[0m client calling
[36m(ClientAppActor pid=762653)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b3cfb7f95e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client loading model
[36m(ClientAppActor pid=762658)[0m loading data
[36m(ClientAppActor pid=762658)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762658)[0m partition loaded
[36m(ClientAppActor pid=762658)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7e88dc3ad100>, len val=500, len test=500
[36m(ClientAppActor pid=762648)[0m gpu in client
[36m(ClientAppActor pid=762648)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762648)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762648)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762658)[0m [Client 6] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762658)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762658)[0m before loading model statdict
[36m(ClientAppActor pid=762658)[0m after loading model statdict
[36m(ClientAppActor pid=762658)[0m training started
[36m(ClientAppActor pid=762658)[0m number of epochs in this 2
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14ef8b95e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 5] fit, config: {'lr': 0.001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 99 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_99.pth
[36m(ClientAppActor pid=762650)[0m Client 1 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762652)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client loading model
[36m(ClientAppActor pid=762657)[0m loading data
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762653)[0m partition loaded
[36m(ClientAppActor pid=762653)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551602cd790>, len val=500, len test=500
[36m(ClientAppActor pid=762657)[0m gpu in client
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=762657)[0m before loading model statdict
[36m(ClientAppActor pid=762657)[0m after loading model statdict
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 99 ACC is =  0.5368
round 99 loss is =  1.2809558749198913
Round 100: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.0001
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m Client 7 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762653)[0m Client 2 / 10
[36m(ClientAppActor pid=762653)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61e01771d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m partition loaded
[36m(ClientAppActor pid=762652)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762648)[0m partition loaded
[36m(ClientAppActor pid=762648)[0m len partition= 5000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 4] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d61452f12b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 0] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 100 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_100.pth
[36m(ClientAppActor pid=762650)[0m Client 2 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b93e1820f0>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762658)[0m Available devices  1
[36m(ClientAppActor pid=762658)[0m Current cuda device  0
[36m(ClientAppActor pid=762658)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 100 ACC is =  0.537
round 100 loss is =  1.280339527130127
Round 101: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762654)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m Client 3 / 10
[36m(ClientAppActor pid=762649)[0m client calling
[36m(ClientAppActor pid=762652)[0m Client 6 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762654)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7d6145258b30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762649)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762649)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=762654)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 6] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=762655)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7a14ec1ab110>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762654)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762655)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762655)[0m [Client 7] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 101 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_101.pth
[36m(ClientAppActor pid=762650)[0m Client 7 / 10
[36m(ClientAppActor pid=762650)[0m client calling
[36m(ClientAppActor pid=762654)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=762650)[0m partition loaded
[36m(ClientAppActor pid=762650)[0m len partition= 5000
[36m(ClientAppActor pid=762658)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x79b925c94590>, len val=500, len test=500
[36m(ClientAppActor pid=762650)[0m gpu in client
[36m(ClientAppActor pid=762650)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762650)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=762650)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=762650)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=762650)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=762650)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=762650)[0m Available devices  1
[36m(ClientAppActor pid=762650)[0m Current cuda device  0
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=762650)[0m before loading model statdict
[36m(ClientAppActor pid=762650)[0m after loading model statdict
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 101 ACC is =  0.5372
round 101 loss is =  1.2802359461784363
Round 102: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=762657)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762652)[0m Client 2 / 10
[36m(ClientAppActor pid=762652)[0m client calling
[36m(ClientAppActor pid=762655)[0m Client 6 / 10
[36m(ClientAppActor pid=762655)[0m client calling
[36m(ClientAppActor pid=762650)[0m client loading model
[36m(ClientAppActor pid=762650)[0m loading data
[36m(ClientAppActor pid=762650)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551317a6180>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762650)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762650)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762658)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=762652)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762654)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762652)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m [Client 2] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=762648)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762655)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762654)[0m cuda:0
[36m(ClientAppActor pid=762650)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762650)[0m cuda:0
[36m(ClientAppActor pid=762649)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762649)[0m cuda:0
[36m(ClientAppActor pid=762652)[0m training started
[36m(ClientAppActor pid=762652)[0m number of epochs in this 2
[36m(ClientAppActor pid=762653)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762648)[0m cuda:0
[36m(ClientAppActor pid=762657)[0m cuda:0
[36m(ClientAppActor pid=762607)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762607)[0m cuda:0
[36m(ClientAppActor pid=762658)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762658)[0m cuda:0
[36m(ClientAppActor pid=762653)[0m cuda:0
[36m(ClientAppActor pid=762655)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=762658)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x77aa75be1b80>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.01', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762653)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=762658)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762658)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=762658)[0m [Client 7] fit, config: {'lr': 0.0001, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762653)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 102 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_102.pth
[36m(ClientAppActor pid=762657)[0m Client 6 / 10
[36m(ClientAppActor pid=762657)[0m client calling
[36m(ClientAppActor pid=762653)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m client loading model
[36m(ClientAppActor pid=762657)[0m loading data
[36m(ClientAppActor pid=762657)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=762657)[0m partition loaded
[36m(ClientAppActor pid=762657)[0m len partition= 5000
[36m(ClientAppActor pid=762655)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762655)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=762657)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=762657)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7551337ed790>, len val=500, len test=500
[36m(ClientAppActor pid=762657)[0m gpu in client
[36m(ClientAppActor pid=762657)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=762657)[0m __Number CUDA Devices: 1
